Se truncaron las últimas líneas 5000 del resultado de transmisión.
[LAYER_NORM] Row 0: mean=0.020038, variance=1.253154, stddev=1.119448
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.642764 -1.684540 -1.048741 -0.266645 -1.720484 
[DECODER] Layer 1 output: 1024/1024 non-zero, sum=0.000003
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 8x128
[DEBUG] Decoder sample values: -0.643 -1.685 -1.049 -0.267 -1.720 
[LINEAR] Forward 8x128 -> 8x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.642764 -1.684540 -1.048741 -0.266645 -1.720484 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005375 -0.006868 -0.008289 0.006999 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000586 0.051488 0.072174 0.072225 0.053631 
[LINEAR] Output: 100/100 non-zero, first 5: -0.028041 -0.017679 0.075308 0.110177 0.061559 
[DEBUG] Output projection - shape: 8x1000
[DEBUG] Output range: [-0.218, 0.209]
[DEBUG] Output sample values: -0.028 -0.018 0.075 0.110 0.062 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-0.218, 0.209] Var:0.003
[LOSS] Calculated loss: 6.867
 Loss: 6.867 (LR: 0.0050)[LOSS] Gradient sum: 1.9979
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0114, bias: 0.2490
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[EMBEDDING] Updating weights for 8 tokens with lr=0.0050
[EMBEDDING] Gradient stats: 1024/1024 non-zero, sum=-0.1220, range=[-0.1249, 0.0001]
[EMBEDDING] Sample weights after update: 0.06800678 0.09276325 -0.12134621 -0.13560908 0.11153405 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 8 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.00500000
[UPDATE] Gradientes aplicados con lr=0.00500000 [Updated]
    Muestra 2/4: [DEBUG] Forward - source: 8 tokens, target: 7 tokens
[ENCODER] Starting encode with 8 tokens
[EMBEDDING] Forward pass - seq_len=8, d_model=128
[EMBEDDING] Input tokens: 2 5 93 6 1 
[EMBEDDING] Stats: 1024/1024 non-zero values, sum=-4.44744110, range=[-0.14561814, 0.14582290]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1024/1024 non-zero, sum=-4.447441
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 960/1024 non-zero, sum=51.368427
[ENCODER] SCALED EMBEDS before add: 1024/1024 non-zero, sum=-50.317062
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1024/1024 non-zero, sum=1.051356
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1024/1024 non-zero
[ENCODER_LAYER] After self-attention: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.952232 -0.194011 -0.297753 0.835911 -0.399948 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.926705 -1.333889 -0.372682 2.033350 -1.276305 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.926705 -1.333889 -0.372682 2.033350 -1.276305 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.144489, variance=2.349257, stddev=1.532732
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.351309 -0.964538 -0.337418 1.232350 -0.926968 
[ENCODER_LAYER] After norm1: 1024/1024 non-zero
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1028/2048 range: [0.000000, 1.431099]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.925184, 0.751281]
[FEEDFORWARD] Sample values: 0.227804 -0.228924 -0.001013 -0.424615 -0.288890 
[ENCODER_LAYER] After feedforward: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.351309 -0.964538 -0.337418 1.232350 -0.926968 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.227804 -0.228924 -0.001013 -0.424615 -0.288890 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.123505 -1.193462 -0.338430 0.807735 -1.215859 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.123505 -1.193462 -0.338430 0.807735 -1.215859 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018237, variance=1.043905, stddev=1.021722
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.117469 -1.185939 -0.349085 0.772713 -1.207859 
[ENCODER_LAYER] Final output: 1024/1024 non-zero
[ENCODER] Layer 0 output: 1024/1024 non-zero, sum=-0.000003
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1024/1024 non-zero
[ENCODER_LAYER] After self-attention: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.117469 -1.185939 -0.349085 0.772713 -1.207859 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -1.071272 -0.059861 -0.479278 0.716300 -0.593330 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.188742 -1.245801 -0.828363 1.489014 -1.801189 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.188742 -1.245801 -0.828363 1.489014 -1.801189 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.769611, stddev=1.664218
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.315177 -0.748580 -0.497749 0.894723 -1.082304 
[ENCODER_LAYER] After norm1: 1024/1024 non-zero
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1012/2048 range: [0.000000, 1.436527]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.805443, 0.649040]
[FEEDFORWARD] Sample values: 0.269027 -0.257301 0.033125 -0.433566 -0.189886 
[ENCODER_LAYER] After feedforward: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.315177 -0.748580 -0.497749 0.894723 -1.082304 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.269027 -0.257301 0.033125 -0.433566 -0.189886 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.046151 -1.005881 -0.464624 0.461157 -1.272190 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.046151 -1.005881 -0.464624 0.461157 -1.272190 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.016982, variance=1.154449, stddev=1.074457
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.989460 -0.951981 -0.448231 0.413395 -1.199835 
[ENCODER_LAYER] Final output: 1024/1024 non-zero
[ENCODER] Layer 1 output: 1024/1024 non-zero, sum=-0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 8x128
[DEBUG] Encoder sample values: -0.989 -0.952 -0.448 0.413 -1.200 
[DECODER] Starting decode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 192 1 4 15 
[EMBEDDING] Stats: 896/896 non-zero values, sum=-3.290, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086202 -0.109662 0.066741 0.096924 -0.077536 0.000983 0.129723 0.093549 0.021420 -0.067163 
[EMBEDDING] Token 2 embedding values: -0.086202 -0.109662 0.066741 0.096924 -0.077536 0.000983 0.129723 0.093549 
[EMBEDDING] GPU verification - first 10 values: -0.086202 -0.109662 0.066741 0.096924 -0.077536 0.000983 0.129723 0.093549 0.021420 -0.067163 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 896/896 non-zero, sum=-3.289972
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[DECODER] SCALED EMBEDS before add: 896/896 non-zero, sum=-37.221741
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975263 -1.240688 0.755091 1.096571 -0.877220 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975263 -1.140688 0.755091 1.196571 -0.877220 
[DECODER] After pos encoding: 896/896 non-zero, sum=7.704566
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975263 -1.140688 0.755091 1.196571 -0.877220 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975263 -1.140688 0.755091 1.196571 -0.877220 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950526 -2.281376 1.510182 2.393142 -1.754441 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950526 -2.281376 1.510182 2.393142 -1.754441 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.195676, variance=3.646626, stddev=1.909617
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123892 -1.297146 0.688361 1.150737 -1.021208 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123892 -1.297146 0.688361 1.150737 -1.021208 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.954713 0.189275 -0.547801 0.608349 -0.509037 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.078605 -1.107871 0.140560 1.759085 -1.530245 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.078605 -1.107871 0.140560 1.759085 -1.530245 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=2.607854, stddev=1.614888
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.287151 -0.686036 0.087040 1.089292 -0.947586 
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 908/1792 range: [0.000000, 1.577668]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.755400, 0.702160]
[FEEDFORWARD] Sample values: 0.266209 -0.262911 0.004078 -0.384154 -0.215762 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.287151 -0.686036 0.087040 1.089292 -0.947586 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.266209 -0.262911 0.004078 -0.384154 -0.215762 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.020942 -0.948947 0.091118 0.705138 -1.163348 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.020942 -0.948947 0.091118 0.705138 -1.163348 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018231, variance=1.136126, stddev=1.065897
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.974928 -0.907384 0.068381 0.644440 -1.108531 
[DECODER] Layer 0 output: 896/896 non-zero, sum=-0.000006
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974928 -0.907384 0.068381 0.644440 -1.108531 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.974928 -0.907384 0.068381 0.644440 -1.108531 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.949856 -1.814768 0.136762 1.288881 -2.217062 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.949856 -1.814768 0.136762 1.288881 -2.217062 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999964, stddev=1.999993
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.974931 -0.907387 0.068381 0.644442 -1.108534 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974931 -0.907387 0.068381 0.644442 -1.108534 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.941682 0.323430 -0.532540 0.679188 -0.459005 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.916614 -0.583957 -0.464158 1.323630 -1.567540 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.916614 -0.583957 -0.464158 1.323630 -1.567540 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=2.915346, stddev=1.707441
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.122506 -0.342007 -0.271844 0.775213 -0.918064 
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 861/1792 range: [0.000000, 1.419612]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.753161, 0.641622]
[FEEDFORWARD] Sample values: 0.291837 -0.215428 0.037016 -0.316799 -0.150691 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.122506 -0.342007 -0.271844 0.775213 -0.918064 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.291837 -0.215428 0.037016 -0.316799 -0.150691 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.830669 -0.557435 -0.234828 0.458413 -1.068754 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.830669 -0.557435 -0.234828 0.458413 -1.068754 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.013572, variance=1.240101, stddev=1.113603
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.758117 -0.512757 -0.223060 0.399461 -0.971914 
[DECODER] Layer 1 output: 896/896 non-zero, sum=0.000005
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 7x128
[DEBUG] Decoder sample values: -0.758 -0.513 -0.223 0.399 -0.972 
[LINEAR] Forward 7x128 -> 7x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.758117 -0.512757 -0.223060 0.399461 -0.971914 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005379 -0.006882 -0.008263 0.006999 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000591 0.052733 0.072794 0.072844 0.053626 
[LINEAR] Output: 100/100 non-zero, first 5: -0.052802 0.009886 0.118679 0.075482 0.093008 
[DEBUG] Output projection - shape: 7x1000
[DEBUG] Output range: [-0.171, 0.221]
[DEBUG] Output sample values: -0.053 0.010 0.119 0.075 0.093 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-0.171, 0.221] Var:0.003
[LOSS] Calculated loss: 6.875
[TRAINER] Loss stagnant (improvement: 0.002), boosting LR to 0.015
 Loss: 6.875 (LR: 0.0150)[LOSS] Gradient sum: 1.9979
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0071, bias: 0.1419
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[EMBEDDING] Updating weights for 7 tokens with lr=0.0150
[EMBEDDING] Gradient stats: 896/896 non-zero, sum=-0.0148, range=[-0.1427, 0.0002]
[EMBEDDING] Sample weights after update: 0.06800678 0.09276325 -0.12134621 -0.13560908 0.11153405 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 7 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.01500000
[UPDATE] Gradientes aplicados con lr=0.01500000 [Updated]
    Muestra 3/4: [DEBUG] Forward - source: 10 tokens, target: 10 tokens
[ENCODER] Starting encode with 10 tokens
[EMBEDDING] Forward pass - seq_len=10, d_model=128
[EMBEDDING] Input tokens: 2 5 19 90 8 
[EMBEDDING] Stats: 1280/1280 non-zero values, sum=2.19915819, range=[-0.14581499, 0.14582290]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1280/1280 non-zero, sum=2.199158
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1216/1280 non-zero, sum=64.270538
[ENCODER] SCALED EMBEDS before add: 1280/1280 non-zero, sum=24.880644
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1280/1280 non-zero, sum=89.151054
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1280/1280 non-zero
[ENCODER_LAYER] After self-attention: 1280/1280 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.409769 -0.215730 -0.209672 0.920038 -0.247640 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.384242 -1.355608 -0.284602 2.117478 -1.123996 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.384242 -1.355608 -0.284602 2.117478 -1.123996 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.170477, variance=2.235070, stddev=1.495018
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.039933 -1.020781 -0.304397 1.302325 -0.865858 
[ENCODER_LAYER] After norm1: 1280/1280 non-zero
[FEEDFORWARD] Forward pass: 10x128 -> 10x256 -> 10x128
[FEEDFORWARD] Input non-zero: 1280/1280
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1248/2560 range: [0.000000, 1.743284]
[FEEDFORWARD] Output non-zero: 1280/1280 range: [-0.756100, 0.779365]
[FEEDFORWARD] Sample values: 0.235702 -0.239360 -0.066388 -0.411951 -0.311839 
[ENCODER_LAYER] After feedforward: 1280/1280 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.039933 -1.020781 -0.304397 1.302325 -0.865858 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.235702 -0.239360 -0.066388 -0.411951 -0.311839 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.804231 -1.260141 -0.370785 0.890375 -1.177697 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.804231 -1.260141 -0.370785 0.890375 -1.177697 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017118, variance=1.049635, stddev=1.024522
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.801690 -1.246688 -0.378619 0.852355 -1.166217 
[ENCODER_LAYER] Final output: 1280/1280 non-zero
[ENCODER] Layer 0 output: 1280/1280 non-zero, sum=0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1280/1280 non-zero
[ENCODER_LAYER] After self-attention: 1280/1280 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.801690 -1.246688 -0.378619 0.852355 -1.166217 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.291631 -0.388302 -0.483917 0.777496 -0.551483 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.093321 -1.634990 -0.862536 1.629851 -1.717700 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.093321 -1.634990 -0.862536 1.629851 -1.717700 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.674052, stddev=1.635256
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.668593 -0.999837 -0.527462 0.996695 -1.050417 
[ENCODER_LAYER] After norm1: 1280/1280 non-zero
[FEEDFORWARD] Forward pass: 10x128 -> 10x256 -> 10x128
[FEEDFORWARD] Input non-zero: 1280/1280
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1262/2560 range: [0.000000, 1.791178]
[FEEDFORWARD] Output non-zero: 1280/1280 range: [-0.720662, 0.763534]
[FEEDFORWARD] Sample values: 0.281346 -0.310697 -0.092564 -0.396840 -0.258629 
[ENCODER_LAYER] After feedforward: 1280/1280 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.668593 -0.999837 -0.527462 0.996695 -1.050417 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.281346 -0.310697 -0.092564 -0.396840 -0.258629 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.387248 -1.310534 -0.620026 0.599855 -1.309045 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.387248 -1.310534 -0.620026 0.599855 -1.309045 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017541, variance=1.183199, stddev=1.087754
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.372132 -1.220933 -0.586132 0.535336 -1.219564 
[ENCODER_LAYER] Final output: 1280/1280 non-zero
[ENCODER] Layer 1 output: 1280/1280 non-zero, sum=0.000003
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 10x128
[DEBUG] Encoder sample values: -0.372 -1.221 -0.586 0.535 -1.220 
[DECODER] Starting decode with 10 tokens
[EMBEDDING] Forward pass - seq_len=10, d_model=128
[EMBEDDING] Input tokens: 2 78 93 15 65 
[EMBEDDING] Stats: 1280/1280 non-zero values, sum=-1.397, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086204 -0.109665 0.068882 0.096922 -0.077538 0.000980 0.129720 0.093547 0.021417 -0.067165 
[EMBEDDING] Token 2 embedding values: -0.086204 -0.109665 0.068882 0.096922 -0.077538 0.000980 0.129720 0.093547 
[EMBEDDING] GPU verification - first 10 values: -0.086204 -0.109665 0.068882 0.096922 -0.077538 0.000980 0.129720 0.093547 0.021417 -0.067165 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 1280/1280 non-zero, sum=-1.397447
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 1216/1280 non-zero, sum=64.270538
[DECODER] SCALED EMBEDS before add: 1280/1280 non-zero, sum=-15.810308
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975286 -1.240712 0.779308 1.096545 -0.877247 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975286 -1.140712 0.779308 1.196545 -0.877247 
[DECODER] After pos encoding: 1280/1280 non-zero, sum=48.460129
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975286 -1.140712 0.779308 1.196545 -0.877247 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975286 -1.140712 0.779308 1.196545 -0.877247 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950572 -2.281425 1.558615 2.393090 -1.754494 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950572 -2.281425 1.558615 2.393090 -1.754494 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196006, variance=3.647637, stddev=1.909881
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123933 -1.297165 0.713452 1.150377 -1.021267 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123933 -1.297165 0.713452 1.150377 -1.021267 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.061629 -0.254011 -0.608080 0.591258 -0.683053 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.062304 -1.551176 0.105372 1.741635 -1.704320 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.062304 -1.551176 0.105372 1.741635 -1.704320 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.409598, stddev=1.552291
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.684346 -0.999282 0.067881 1.121977 -1.097939 
[FEEDFORWARD] Forward pass: 10x128 -> 10x256 -> 10x128
[FEEDFORWARD] Input non-zero: 1280/1280
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1275/2560 range: [0.000000, 1.899883]
[FEEDFORWARD] Output non-zero: 1280/1280 range: [-0.638110, 0.714273]
[FEEDFORWARD] Sample values: 0.255033 -0.272171 -0.090516 -0.372370 -0.282948 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.684346 -0.999282 0.067881 1.121977 -1.097939 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.255033 -0.272171 -0.090516 -0.372370 -0.282948 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.429313 -1.271452 -0.022635 0.749607 -1.380887 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.429313 -1.271452 -0.022635 0.749607 -1.380887 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019095, variance=1.159715, stddev=1.076905
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.416386 -1.198385 -0.038750 0.678344 -1.300004 
[DECODER] Layer 0 output: 1280/1280 non-zero, sum=-0.000005
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.416386 -1.198385 -0.038750 0.678344 -1.300004 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.416386 -1.198385 -0.038750 0.678344 -1.300004 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.832771 -2.396770 -0.077499 1.356688 -2.600009 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.832771 -2.396770 -0.077499 1.356688 -2.600009 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.416387 -1.198389 -0.038750 0.678346 -1.300008 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.416387 -1.198389 -0.038750 0.678346 -1.300008 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.113152 -0.334993 -0.572310 0.629002 -0.685268 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.303235 -1.533381 -0.611060 1.307348 -1.985276 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.303235 -1.533381 -0.611060 1.307348 -1.985276 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.729751, stddev=1.652199
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.183534 -0.928085 -0.369846 0.791277 -1.201596 
[FEEDFORWARD] Forward pass: 10x128 -> 10x256 -> 10x128
[FEEDFORWARD] Input non-zero: 1280/1280
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 1250/2560 range: [0.000000, 1.729387]
[FEEDFORWARD] Output non-zero: 1280/1280 range: [-0.642036, 0.759090]
[FEEDFORWARD] Sample values: 0.240422 -0.282757 -0.100498 -0.284653 -0.253027 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.183534 -0.928085 -0.369846 0.791277 -1.201596 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.240422 -0.282757 -0.100498 -0.284653 -0.253027 
[MATRIX_ADD_DEBUG] Result first 5 values: 0.056888 -1.210842 -0.470344 0.506625 -1.454624 
[LAYER_NORM] Input: 100/100 non-zero, first 5: 0.056888 -1.210842 -0.470344 0.506625 -1.454624 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017942, variance=1.289750, stddev=1.135676
[LAYER_NORM] Output: 100/100 non-zero, first 5: 0.034293 -1.081985 -0.429951 0.430301 -1.296642 
[DECODER] Layer 1 output: 1280/1280 non-zero, sum=0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 10x128
[DEBUG] Decoder sample values: 0.034 -1.082 -0.430 0.430 -1.297 
[LINEAR] Forward 10x128 -> 10x1000
[LINEAR] Input: 100/100 non-zero, first 5: 0.034293 -1.081985 -0.429951 0.430301 -1.296642 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.006983 -0.008281 0.007075 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000605 0.054861 0.074920 0.074973 0.055751 
[LINEAR] Output: 100/100 non-zero, first 5: -0.053864 0.000173 0.105246 0.095841 0.073519 
[DEBUG] Output projection - shape: 10x1000
[DEBUG] Output range: [-0.210, 0.209]
[DEBUG] Output sample values: -0.054 0.000 0.105 0.096 0.074 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-0.210, 0.209] Var:0.003
[LOSS] Calculated loss: 6.901
 Loss: 6.901 (LR: 0.0050)[LOSS] Gradient sum: 1.9980
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0050, bias: 0.0991
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[EMBEDDING] Updating weights for 10 tokens with lr=0.0050
[EMBEDDING] Gradient stats: 1280/1280 non-zero, sum=-0.0720, range=[-0.0999, 0.0001]
[EMBEDDING] Sample weights after update: 0.06800678 0.09276325 -0.12134621 -0.13560908 0.11153405 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 10 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.00500000
[UPDATE] Gradientes aplicados con lr=0.00500000 [Updated]
    Muestra 4/4: [DEBUG] Forward - source: 10 tokens, target: 10 tokens
[ENCODER] Starting encode with 10 tokens
[EMBEDDING] Forward pass - seq_len=10, d_model=128
[EMBEDDING] Input tokens: 2 14 16 482 17 
[EMBEDDING] Stats: 1280/1280 non-zero values, sum=-0.56613600, range=[-0.14530712, 0.14582290]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1280/1280 non-zero, sum=-0.566136
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1216/1280 non-zero, sum=64.270538
[ENCODER] SCALED EMBEDS before add: 1280/1280 non-zero, sum=-6.405084
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1280/1280 non-zero, sum=57.865425
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1280/1280 non-zero
[ENCODER_LAYER] After self-attention: 1280/1280 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.666179 -0.549664 0.106346 0.573821 -0.712870 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.640652 -1.689542 0.031416 1.771261 -1.589227 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.640652 -1.689542 0.031416 1.771261 -1.589227 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.163813, variance=2.293204, stddev=1.514336
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.191588 -1.223873 -0.087429 1.061487 -1.157629 
[ENCODER_LAYER] After norm1: 1280/1280 non-zero
[FEEDFORWARD] Forward pass: 10x128 -> 10x256 -> 10x128
[FEEDFORWARD] Input non-zero: 1280/1280
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1297/2560 range: [0.000000, 1.486397]
[FEEDFORWARD] Output non-zero: 1280/1280 range: [-0.910112, 0.841787]
[FEEDFORWARD] Sample values: 0.193911 -0.211507 -0.058727 -0.407002 -0.327398 
[ENCODER_LAYER] After feedforward: 1280/1280 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.191588 -1.223873 -0.087429 1.061487 -1.157629 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.193911 -0.211507 -0.058727 -0.407002 -0.327398 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.997677 -1.435380 -0.146156 0.654485 -1.485027 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.997677 -1.435380 -0.146156 0.654485 -1.485027 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019500, variance=1.048150, stddev=1.023797
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.993535 -1.421064 -0.161806 0.620226 -1.469557 
[ENCODER_LAYER] Final output: 1280/1280 non-zero
[ENCODER] Layer 0 output: 1280/1280 non-zero, sum=0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1280/1280 non-zero
[ENCODER_LAYER] After self-attention: 1280/1280 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.993535 -1.421064 -0.161806 0.620226 -1.469557 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.750775 -0.769623 0.017163 0.197550 -1.230975 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.744310 -2.190686 -0.144643 0.817776 -2.700532 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.744310 -2.190686 -0.144643 0.817776 -2.700532 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.760316, stddev=1.661423
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.049889 -1.318561 -0.087060 0.492214 -1.625434 
[ENCODER_LAYER] After norm1: 1280/1280 non-zero
[FEEDFORWARD] Forward pass: 10x128 -> 10x256 -> 10x128
[FEEDFORWARD] Input non-zero: 1280/1280
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1307/2560 range: [0.000000, 1.624752]
[FEEDFORWARD] Output non-zero: 1280/1280 range: [-0.789406, 0.853685]
[FEEDFORWARD] Sample values: 0.215975 -0.273829 -0.098119 -0.421044 -0.257431 
[ENCODER_LAYER] After feedforward: 1280/1280 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.049889 -1.318561 -0.087060 0.492214 -1.625434 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.215975 -0.273829 -0.098119 -0.421044 -0.257431 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.833914 -1.592390 -0.185179 0.071170 -1.882865 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.833914 -1.592390 -0.185179 0.071170 -1.882865 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.021764, variance=1.168988, stddev=1.081202
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.791414 -1.492925 -0.191400 0.045696 -1.761585 
[ENCODER_LAYER] Final output: 1280/1280 non-zero
[ENCODER] Layer 1 output: 1280/1280 non-zero, sum=0.000006
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 10x128
[DEBUG] Encoder sample values: -0.791 -1.493 -0.191 0.046 -1.762 
[DECODER] Starting decode with 10 tokens
[EMBEDDING] Forward pass - seq_len=10, d_model=128
[EMBEDDING] Input tokens: 2 11 9 435 68 
[EMBEDDING] Stats: 1280/1280 non-zero values, sum=-3.064, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086204 -0.109665 0.069381 0.096921 -0.077539 0.000980 0.129720 0.093547 0.021417 -0.067166 
[EMBEDDING] Token 2 embedding values: -0.086204 -0.109665 0.069381 0.096921 -0.077539 0.000980 0.129720 0.093547 
[EMBEDDING] GPU verification - first 10 values: -0.086204 -0.109665 0.069381 0.096921 -0.077539 0.000980 0.129720 0.093547 0.021417 -0.067166 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 1280/1280 non-zero, sum=-3.064452
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 1216/1280 non-zero, sum=64.270538
[DECODER] SCALED EMBEDS before add: 1280/1280 non-zero, sum=-34.670315
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975291 -1.240718 0.784958 1.096539 -0.877253 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975291 -1.140718 0.784958 1.196539 -0.877253 
[DECODER] After pos encoding: 1280/1280 non-zero, sum=29.600140
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975291 -1.140718 0.784958 1.196539 -0.877253 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975291 -1.140718 0.784958 1.196539 -0.877253 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950583 -2.281436 1.569916 2.393077 -1.754506 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950583 -2.281436 1.569916 2.393077 -1.754506 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196083, variance=3.647880, stddev=1.909945
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123941 -1.297168 0.719305 1.150292 -1.021280 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123941 -1.297168 0.719305 1.150292 -1.021280 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.634825 -0.799285 -0.030723 -0.212957 -1.490825 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.758766 -2.096453 0.688582 0.937335 -2.512105 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.758766 -2.096453 0.688582 0.937335 -2.512105 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.527658, stddev=1.589864
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.106237 -1.318637 0.433108 0.589569 -1.580075 
[FEEDFORWARD] Forward pass: 10x128 -> 10x256 -> 10x128
[FEEDFORWARD] Input non-zero: 1280/1280
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1296/2560 range: [0.000000, 1.928093]
[FEEDFORWARD] Output non-zero: 1280/1280 range: [-0.728502, 0.680114]
[FEEDFORWARD] Sample values: 0.213037 -0.254332 -0.125178 -0.397176 -0.288083 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.106237 -1.318637 0.433108 0.589569 -1.580075 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.213037 -0.254332 -0.125178 -0.397176 -0.288083 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.893199 -1.572968 0.307930 0.192394 -1.868158 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.893199 -1.572968 0.307930 0.192394 -1.868158 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.021990, variance=1.152243, stddev=1.073431
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.852584 -1.485851 0.266379 0.158747 -1.760848 
[DECODER] Layer 0 output: 1280/1280 non-zero, sum=-0.000007
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.852584 -1.485851 0.266379 0.158747 -1.760848 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.852584 -1.485851 0.266379 0.158747 -1.760848 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.705167 -2.971703 0.532759 0.317494 -3.521695 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.705167 -2.971703 0.532759 0.317494 -3.521695 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.852586 -1.485856 0.266380 0.158747 -1.760853 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.852586 -1.485856 0.266380 0.158747 -1.760853 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.578366 -0.761069 0.035243 -0.247050 -1.497151 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.430952 -2.246925 0.301624 -0.088302 -3.258005 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.430952 -2.246925 0.301624 -0.088302 -3.258005 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.757039, stddev=1.660436
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.861793 -1.353213 0.181653 -0.053180 -1.962138 
[FEEDFORWARD] Forward pass: 10x128 -> 10x256 -> 10x128
[FEEDFORWARD] Input non-zero: 1280/1280
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1330/2560 range: [0.000000, 1.673771]
[FEEDFORWARD] Output non-zero: 1280/1280 range: [-0.680985, 0.686193]
[FEEDFORWARD] Sample values: 0.218805 -0.269382 -0.184917 -0.388247 -0.195711 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.861793 -1.353213 0.181653 -0.053180 -1.962138 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.218805 -0.269382 -0.184917 -0.388247 -0.195711 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.642988 -1.622596 -0.003264 -0.441427 -2.157848 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.642988 -1.622596 -0.003264 -0.441427 -2.157848 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.022244, variance=1.270897, stddev=1.127345
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.590087 -1.459038 -0.022626 -0.411295 -1.933828 
[DECODER] Layer 1 output: 1280/1280 non-zero, sum=0.000010
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 10x128
[DEBUG] Decoder sample values: -0.590 -1.459 -0.023 -0.411 -1.934 
[LINEAR] Forward 10x128 -> 10x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.590087 -1.459038 -0.022626 -0.411295 -1.933828 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.006993 -0.008281 0.007075 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000610 0.054856 0.075414 0.075468 0.055745 
[LINEAR] Output: 100/100 non-zero, first 5: -0.042325 0.012341 0.072276 0.086742 0.035859 
[DEBUG] Output projection - shape: 10x1000
[DEBUG] Output range: [-0.227, 0.197]
[DEBUG] Output sample values: -0.042 0.012 0.072 0.087 0.036 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-0.227, 0.197] Var:0.003
[LOSS] Calculated loss: 6.873
[TRAINER] Loss stagnant (improvement: 0.002), boosting LR to 0.015
 Loss: 6.873 (LR: 0.0150)[LOSS] Gradient sum: 1.9979
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0050, bias: 0.0990
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[EMBEDDING] Updating weights for 10 tokens with lr=0.0150
[EMBEDDING] Gradient stats: 1280/1280 non-zero, sum=-0.0720, range=[-0.0999, 0.0001]
[EMBEDDING] Sample weights after update: 0.06800678 0.09276325 -0.12134621 -0.13560908 0.11153405 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 10 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.01500000
[UPDATE] Gradientes aplicados con lr=0.01500000 [Updated]
  Promedio de loss: 6.879
  === Progreso en época 20 ===
[DEBUG] Forward - source: 9 tokens, target: 1 tokens
[ENCODER] Starting encode with 9 tokens
[EMBEDDING] Forward pass - seq_len=9, d_model=128
[EMBEDDING] Input tokens: 2 111 7 102 21 
[EMBEDDING] Stats: 1152/1152 non-zero values, sum=2.857, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1152/1152 non-zero, sum=2.856805
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1088/1152 non-zero, sum=57.816551
[ENCODER] SCALED EMBEDS before add: 1152/1152 non-zero, sum=32.321060
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1152/1152 non-zero, sum=90.137558
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.717929 -0.681396 -0.331211 0.705429 -0.496722 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.178968, variance=2.407937, stddev=1.551756
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1165/2304 range: [0.000000, 1.767863]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.641850, 0.761991]
[FEEDFORWARD] Sample values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017618, variance=1.037082, stddev=1.018377
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 0 output: 1152/1152 non-zero, sum=0.000007
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.831851 -0.957004 -0.803740 0.332163 -0.977816 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.830177, stddev=1.682316
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1147/2304 range: [0.000000, 1.690563]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.613341, 0.729018]
[FEEDFORWARD] Sample values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018144, variance=1.154901, stddev=1.074668
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 1 output: 1152/1152 non-zero, sum=0.000006
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 9x128
[DEBUG] Encoder sample values: -0.779 -1.641 -0.853 0.151 -1.615 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=0.545, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=0.544836
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=6.164124
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 128/128 non-zero, sum=12.564120
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.902503 -2.937727 -0.116204 1.300599 -2.635968 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.902503 -2.937727 -0.116204 1.300599 -2.635968 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.708597, stddev=1.925774
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.987916 -1.525478 -0.060341 0.675364 -1.368783 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 134/256 range: [0.000000, 1.663532]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.563946, 0.641586]
[FEEDFORWARD] Sample values: 0.243447 -0.253328 -0.109722 -0.418546 -0.293698 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.987916 -1.525478 -0.060341 0.675364 -1.368783 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.243447 -0.253328 -0.109722 -0.418546 -0.293698 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.744468 -1.778806 -0.170063 0.256818 -1.662481 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.744468 -1.778806 -0.170063 0.256818 -1.662481 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019584, variance=1.152883, stddev=1.073728
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.711588 -1.674902 -0.176625 0.220944 -1.566565 
[DECODER] Layer 0 output: 128/128 non-zero, sum=-0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.711588 -1.674902 -0.176625 0.220944 -1.566565 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.711588 -1.674902 -0.176625 0.220944 -1.566565 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.423176 -3.349804 -0.353250 0.441887 -3.133130 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.423176 -3.349804 -0.353250 0.441887 -3.133130 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999964, stddev=1.999993
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.711590 -1.674908 -0.176626 0.220944 -1.566570 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.711590 -1.674908 -0.176626 0.220944 -1.566570 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.490127 -3.315459 -1.029691 0.371508 -3.181221 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.490127 -3.315459 -1.029691 0.371508 -3.181221 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.984896, stddev=1.996223
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.746473 -1.660866 -0.515820 0.186106 -1.593620 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 131/256 range: [0.000000, 1.737336]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.631688, 0.655325]
[FEEDFORWARD] Sample values: 0.248774 -0.280281 -0.131356 -0.399910 -0.221582 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.746473 -1.660866 -0.515820 0.186106 -1.593620 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.248774 -0.280281 -0.131356 -0.399910 -0.221582 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.497699 -1.941146 -0.647175 -0.213805 -1.815202 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.497699 -1.941146 -0.647175 -0.213805 -1.815202 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019409, variance=1.253420, stddev=1.119567
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.461883 -1.751174 -0.595395 -0.208307 -1.638680 
[DECODER] Layer 1 output: 128/128 non-zero, sum=-0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.462 -1.751 -0.595 -0.208 -1.639 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.461883 -1.751174 -0.595395 -0.208307 -1.638680 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.031148 -0.001521 0.096774 0.120615 0.063772 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-0.172, 0.180]
[DEBUG] Output sample values: -0.031 -0.002 0.097 0.121 0.064 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 293 (score: 0.2, target_len: 8) [Top scores: 293:0.2 213:0.2 900:0.2 148:0.2 663:0.2 ]
[DEBUG] Forward - source: 9 tokens, target: 2 tokens
[ENCODER] Starting encode with 9 tokens
[EMBEDDING] Forward pass - seq_len=9, d_model=128
[EMBEDDING] Input tokens: 2 111 7 102 21 
[EMBEDDING] Stats: 1152/1152 non-zero values, sum=2.9, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1152/1152 non-zero, sum=2.856805
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1088/1152 non-zero, sum=57.816551
[ENCODER] SCALED EMBEDS before add: 1152/1152 non-zero, sum=32.321060
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1152/1152 non-zero, sum=90.137558
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.717929 -0.681396 -0.331211 0.705429 -0.496722 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.178968, variance=2.407937, stddev=1.551756
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1165/2304 range: [0.000000, 1.767863]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.641850, 0.761991]
[FEEDFORWARD] Sample values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017618, variance=1.037082, stddev=1.018377
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 0 output: 1152/1152 non-zero, sum=0.000007
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.831851 -0.957004 -0.803740 0.332163 -0.977816 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.830177, stddev=1.682316
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1147/2304 range: [0.000000, 1.690563]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.613341, 0.729018]
[FEEDFORWARD] Sample values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018144, variance=1.154901, stddev=1.074668
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 1 output: 1152/1152 non-zero, sum=0.000006
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 9x128
[DEBUG] Encoder sample values: -0.779 -1.641 -0.853 0.151 -1.615 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 293 
[EMBEDDING] Stats: 256/256 non-zero values, sum=0.923, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=0.923086
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=10.443524
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 256/256 non-zero, sum=23.249554
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.734900 -1.539022 -0.898161 0.116946 -1.551017 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.858866 -2.836198 -0.161300 1.266981 -2.572333 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.858866 -2.836198 -0.161300 1.266981 -2.572333 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.582294, stddev=1.892698
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.982125 -1.498495 -0.085222 0.669405 -1.359083 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 272/512 range: [0.000000, 1.672104]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.563830, 0.648796]
[FEEDFORWARD] Sample values: 0.247098 -0.247031 -0.110218 -0.414032 -0.297946 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.982125 -1.498495 -0.085222 0.669405 -1.359083 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.247098 -0.247031 -0.110218 -0.414032 -0.297946 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.735027 -1.745525 -0.195440 0.255373 -1.657029 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.735027 -1.745525 -0.195440 0.255373 -1.657029 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019819, variance=1.152152, stddev=1.073388
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.703237 -1.644647 -0.200542 0.219449 -1.562201 
[DECODER] Layer 0 output: 256/256 non-zero, sum=0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.703237 -1.644647 -0.200542 0.219449 -1.562201 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.703237 -1.644647 -0.200542 0.219449 -1.562201 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.406474 -3.289294 -0.401085 0.438897 -3.124403 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.406474 -3.289294 -0.401085 0.438897 -3.124403 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999967, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.703239 -1.644652 -0.200543 0.219449 -1.562206 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.703239 -1.644652 -0.200543 0.219449 -1.562206 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.729095 -1.525516 -0.904160 0.112473 -1.542552 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.432334 -3.170168 -1.104704 0.331923 -3.104758 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.432334 -3.170168 -1.104704 0.331923 -3.104758 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.842007, stddev=1.960106
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.730743 -1.617345 -0.563594 0.169339 -1.583974 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 262/512 range: [0.000000, 1.750272]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.635262, 0.650415]
[FEEDFORWARD] Sample values: 0.255442 -0.273321 -0.130581 -0.390877 -0.227614 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.730743 -1.617345 -0.563594 0.169339 -1.583974 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.255442 -0.273321 -0.130581 -0.390877 -0.227614 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.475301 -1.890666 -0.694175 -0.221538 -1.811588 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.475301 -1.890666 -0.694175 -0.221538 -1.811588 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019875, variance=1.254284, stddev=1.119953
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.442140 -1.705913 -0.637572 -0.215556 -1.635304 
[DECODER] Layer 1 output: 256/256 non-zero, sum=0.000005
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.442 -1.706 -0.638 -0.216 -1.635 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.442140 -1.705913 -0.637572 -0.215556 -1.635304 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.033153 -0.000426 0.097555 0.119263 0.064113 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-0.215, 0.183]
[DEBUG] Output sample values: -0.033 -0.000 0.098 0.119 0.064 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 444 (score: 0.2, target_len: 8) [Top scores: 444:0.2 531:0.2 15:0.2 712:0.2 403:0.1 ]
[DEBUG] Forward - source: 9 tokens, target: 3 tokens
[ENCODER] Starting encode with 9 tokens
[EMBEDDING] Forward pass - seq_len=9, d_model=128
[EMBEDDING] Input tokens: 2 111 7 102 21 
[EMBEDDING] Stats: 1152/1152 non-zero values, sum=2.9, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1152/1152 non-zero, sum=2.856805
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1088/1152 non-zero, sum=57.816551
[ENCODER] SCALED EMBEDS before add: 1152/1152 non-zero, sum=32.321060
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1152/1152 non-zero, sum=90.137558
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.717929 -0.681396 -0.331211 0.705429 -0.496722 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.178968, variance=2.407937, stddev=1.551756
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1165/2304 range: [0.000000, 1.767863]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.641850, 0.761991]
[FEEDFORWARD] Sample values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017618, variance=1.037082, stddev=1.018377
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 0 output: 1152/1152 non-zero, sum=0.000007
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.831851 -0.957004 -0.803740 0.332163 -0.977816 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.830177, stddev=1.682316
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1147/2304 range: [0.000000, 1.690563]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.613341, 0.729018]
[FEEDFORWARD] Sample values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018144, variance=1.154901, stddev=1.074668
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 1 output: 1152/1152 non-zero, sum=0.000006
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 9x128
[DEBUG] Encoder sample values: -0.779 -1.641 -0.853 0.151 -1.615 
[DECODER] Starting decode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 293 444 
[EMBEDDING] Stats: 384/384 non-zero values, sum=2.114, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 384/384 non-zero, sum=2.114351
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[DECODER] SCALED EMBEDS before add: 384/384 non-zero, sum=23.921150
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 384/384 non-zero, sum=43.139221
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.724121 -1.451642 -0.947521 0.067042 -1.562317 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.848087 -2.748818 -0.210659 1.217077 -2.583633 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.848087 -2.748818 -0.210659 1.217077 -2.583633 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.402766, stddev=1.844662
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.001857 -1.490148 -0.114200 0.659783 -1.400600 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 390/768 range: [0.000000, 1.680461]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.691593, 0.649903]
[FEEDFORWARD] Sample values: 0.235151 -0.239982 -0.104089 -0.405722 -0.309925 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.001857 -1.490148 -0.114200 0.659783 -1.400600 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.235151 -0.239982 -0.104089 -0.405722 -0.309925 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.766706 -1.730129 -0.218288 0.254061 -1.710525 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.766706 -1.730129 -0.218288 0.254061 -1.710525 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019150, variance=1.147173, stddev=1.071066
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.733714 -1.633213 -0.221684 0.219325 -1.614910 
[DECODER] Layer 0 output: 384/384 non-zero, sum=-0.000000
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.733714 -1.633213 -0.221684 0.219325 -1.614910 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.733714 -1.633213 -0.221684 0.219325 -1.614910 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.467428 -3.266425 -0.443368 0.438650 -3.229819 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.467428 -3.266425 -0.443368 0.438650 -3.229819 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.733716 -1.633217 -0.221685 0.219326 -1.614914 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.733716 -1.633217 -0.221685 0.219326 -1.614914 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.713857 -1.402261 -0.973771 0.042108 -1.558407 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.447572 -3.035479 -1.195456 0.261434 -3.173321 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.447572 -3.035479 -1.195456 0.261434 -3.173321 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.583137, stddev=1.892920
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.764730 -1.603596 -0.631541 0.138111 -1.676416 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 393/768 range: [0.000000, 1.769481]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.714319, 0.635645]
[FEEDFORWARD] Sample values: 0.238598 -0.271321 -0.114590 -0.374927 -0.238562 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.764730 -1.603596 -0.631541 0.138111 -1.676416 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.238598 -0.271321 -0.114590 -0.374927 -0.238562 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.526132 -1.874916 -0.746130 -0.236816 -1.914977 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.526132 -1.874916 -0.746130 -0.236816 -1.914977 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018691, variance=1.248544, stddev=1.117387
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.487586 -1.694674 -0.684472 -0.228664 -1.730526 
[DECODER] Layer 1 output: 384/384 non-zero, sum=-0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 3x128
[DEBUG] Decoder sample values: -0.488 -1.695 -0.684 -0.229 -1.731 
[LINEAR] Forward 3x128 -> 3x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.487586 -1.694674 -0.684472 -0.228664 -1.730526 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.036320 -0.000669 0.098373 0.116988 0.067075 
[DEBUG] Output projection - shape: 3x1000
[DEBUG] Output range: [-0.174, 0.185]
[DEBUG] Output sample values: -0.036 -0.001 0.098 0.117 0.067 
[DEBUG] Forward completed!
[GEN] Step 2 - Best token: 213 (score: 0.2, target_len: 8) [Top scores: 213:0.2 844:0.2 161:0.1 900:0.1 148:0.1 ]
[DEBUG] Forward - source: 9 tokens, target: 4 tokens
[ENCODER] Starting encode with 9 tokens
[EMBEDDING] Forward pass - seq_len=9, d_model=128
[EMBEDDING] Input tokens: 2 111 7 102 21 
[EMBEDDING] Stats: 1152/1152 non-zero values, sum=2.9, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1152/1152 non-zero, sum=2.856805
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1088/1152 non-zero, sum=57.816551
[ENCODER] SCALED EMBEDS before add: 1152/1152 non-zero, sum=32.321060
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1152/1152 non-zero, sum=90.137558
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.717929 -0.681396 -0.331211 0.705429 -0.496722 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.178968, variance=2.407937, stddev=1.551756
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1165/2304 range: [0.000000, 1.767863]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.641850, 0.761991]
[FEEDFORWARD] Sample values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017618, variance=1.037082, stddev=1.018377
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 0 output: 1152/1152 non-zero, sum=0.000007
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.831851 -0.957004 -0.803740 0.332163 -0.977816 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.830177, stddev=1.682316
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1147/2304 range: [0.000000, 1.690563]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.613341, 0.729018]
[FEEDFORWARD] Sample values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018144, variance=1.154901, stddev=1.074668
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 1 output: 1152/1152 non-zero, sum=0.000006
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 9x128
[DEBUG] Encoder sample values: -0.779 -1.641 -0.853 0.151 -1.615 
[DECODER] Starting decode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 293 444 213 
[EMBEDDING] Stats: 512/512 non-zero values, sum=3.270, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 512/512 non-zero, sum=3.270211
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[DECODER] SCALED EMBEDS before add: 512/512 non-zero, sum=36.998203
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 512/512 non-zero, sum=62.634338
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.641276 -1.302117 -0.904370 0.013692 -1.539591 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.765242 -2.599292 -0.167509 1.163727 -2.560908 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.765242 -2.599292 -0.167509 1.163727 -2.560908 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.260978, stddev=1.805821
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.977529 -1.439397 -0.092760 0.644431 -1.418141 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 522/1024 range: [0.000000, 1.687113]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.665875, 0.745614]
[FEEDFORWARD] Sample values: 0.240625 -0.241449 -0.103278 -0.408249 -0.315609 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.977529 -1.439397 -0.092760 0.644431 -1.418141 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.240625 -0.241449 -0.103278 -0.408249 -0.315609 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.736904 -1.680845 -0.196039 0.236182 -1.733750 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.736904 -1.680845 -0.196039 0.236182 -1.733750 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018533, variance=1.145236, stddev=1.070161
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.705909 -1.587964 -0.200504 0.203380 -1.637400 
[DECODER] Layer 0 output: 512/512 non-zero, sum=-0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.705909 -1.587964 -0.200504 0.203380 -1.637400 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.705909 -1.587964 -0.200504 0.203380 -1.637400 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.411818 -3.175928 -0.401007 0.406759 -3.274800 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.411818 -3.175928 -0.401007 0.406759 -3.274800 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999964, stddev=1.999993
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.705911 -1.587969 -0.200504 0.203380 -1.637405 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.705911 -1.587969 -0.200504 0.203380 -1.637405 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.599419 -1.194486 -0.914299 -0.032519 -1.528256 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.305331 -2.782456 -1.114803 0.170862 -3.165661 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.305331 -2.782456 -1.114803 0.170862 -3.165661 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.392815, stddev=1.841962
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.708663 -1.510593 -0.605226 0.092761 -1.718635 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 505/1024 range: [0.000000, 1.782227]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.681596, 0.633918]
[FEEDFORWARD] Sample values: 0.252647 -0.271561 -0.106275 -0.376907 -0.236981 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.708663 -1.510593 -0.605226 0.092761 -1.718635 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.252647 -0.271561 -0.106275 -0.376907 -0.236981 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.456017 -1.782155 -0.711500 -0.284146 -1.955616 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.456017 -1.782155 -0.711500 -0.284146 -1.955616 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018205, variance=1.249342, stddev=1.117744
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.424267 -1.610708 -0.652837 -0.270501 -1.765897 
[DECODER] Layer 1 output: 512/512 non-zero, sum=-0.000000
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 4x128
[DEBUG] Decoder sample values: -0.424 -1.611 -0.653 -0.271 -1.766 
[LINEAR] Forward 4x128 -> 4x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.424267 -1.610708 -0.652837 -0.270501 -1.765897 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.037878 -0.000109 0.091670 0.113146 0.068586 
[DEBUG] Output projection - shape: 4x1000
[DEBUG] Output range: [-0.176, 0.182]
[DEBUG] Output sample values: -0.038 -0.000 0.092 0.113 0.069 
[DEBUG] Forward completed!
[DEBUG] Forward - source: 9 tokens, target: 5 tokens
[ENCODER] Starting encode with 9 tokens
[EMBEDDING] Forward pass - seq_len=9, d_model=128
[EMBEDDING] Input tokens: 2 111 7 102 21 
[EMBEDDING] Stats: 1152/1152 non-zero values, sum=2.857, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1152/1152 non-zero, sum=2.856805
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1088/1152 non-zero, sum=57.816551
[ENCODER] SCALED EMBEDS before add: 1152/1152 non-zero, sum=32.321060
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1152/1152 non-zero, sum=90.137558
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.717929 -0.681396 -0.331211 0.705429 -0.496722 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.178968, variance=2.407937, stddev=1.551756
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1165/2304 range: [0.000000, 1.767863]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.641850, 0.761991]
[FEEDFORWARD] Sample values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017618, variance=1.037082, stddev=1.018377
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 0 output: 1152/1152 non-zero, sum=0.000007
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.831851 -0.957004 -0.803740 0.332163 -0.977816 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.830177, stddev=1.682316
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1147/2304 range: [0.000000, 1.690563]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.613341, 0.729018]
[FEEDFORWARD] Sample values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018144, variance=1.154901, stddev=1.074668
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 1 output: 1152/1152 non-zero, sum=0.000006
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 9x128
[DEBUG] Encoder sample values: -0.779 -1.641 -0.853 0.151 -1.615 
[DECODER] Starting decode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 293 444 213 161 
[EMBEDDING] Stats: 640/640 non-zero values, sum=4.558, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 640/640 non-zero, sum=4.557775
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[DECODER] SCALED EMBEDS before add: 640/640 non-zero, sum=51.565346
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 640/640 non-zero, sum=83.625572
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.722572 -1.232702 -1.124611 0.006207 -1.300295 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.846538 -2.529878 -0.387750 1.156242 -2.321611 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.846538 -2.529878 -0.387750 1.156242 -2.321611 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.986544, stddev=1.728165
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.068496 -1.463910 -0.224371 0.669058 -1.343397 
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 665/1280 range: [0.000000, 1.665619]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.763407, 0.707163]
[FEEDFORWARD] Sample values: 0.239221 -0.248016 -0.134398 -0.386843 -0.335188 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.068496 -1.463910 -0.224371 0.669058 -1.343397 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.239221 -0.248016 -0.134398 -0.386843 -0.335188 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.829276 -1.711927 -0.358769 0.282215 -1.678585 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.829276 -1.711927 -0.358769 0.282215 -1.678585 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019068, variance=1.140205, stddev=1.067809
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.794471 -1.621072 -0.353843 0.246437 -1.589848 
[DECODER] Layer 0 output: 640/640 non-zero, sum=0.000003
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.794471 -1.621072 -0.353843 0.246437 -1.589848 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.794471 -1.621072 -0.353843 0.246437 -1.589848 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.588942 -3.242143 -0.707686 0.492874 -3.179695 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.588942 -3.242143 -0.707686 0.492874 -3.179695 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.794474 -1.621077 -0.353844 0.246438 -1.589852 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.794474 -1.621077 -0.353844 0.246438 -1.589852 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.713543 -1.137393 -1.188751 -0.029115 -1.230914 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.508017 -2.758469 -1.542595 0.217323 -2.820767 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.508017 -2.758469 -1.542595 0.217323 -2.820767 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.148043, stddev=1.774275
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.849934 -1.554702 -0.869422 0.122486 -1.589813 
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 640/1280 range: [0.000000, 1.730176]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.673268, 0.682611]
[FEEDFORWARD] Sample values: 0.236118 -0.264019 -0.155450 -0.361469 -0.252817 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.849934 -1.554702 -0.869422 0.122486 -1.589813 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.236118 -0.264019 -0.155450 -0.361469 -0.252817 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.613816 -1.818721 -1.024872 -0.238984 -1.842631 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.613816 -1.818721 -1.024872 -0.238984 -1.842631 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.020090, variance=1.247503, stddev=1.116921
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.567548 -1.646321 -0.935574 -0.231954 -1.667728 
[DECODER] Layer 1 output: 640/640 non-zero, sum=-0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 5x128
[DEBUG] Decoder sample values: -0.568 -1.646 -0.936 -0.232 -1.668 
[LINEAR] Forward 5x128 -> 5x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.567548 -1.646321 -0.935574 -0.231954 -1.667728 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.031136 -0.008795 0.084295 0.111109 0.061142 
[DEBUG] Output projection - shape: 5x1000
[DEBUG] Output range: [-0.195, 0.184]
[DEBUG] Output sample values: -0.031 -0.009 0.084 0.111 0.061 
[DEBUG] Forward completed!
[DEBUG] Forward - source: 9 tokens, target: 6 tokens
[ENCODER] Starting encode with 9 tokens
[EMBEDDING] Forward pass - seq_len=9, d_model=128
[EMBEDDING] Input tokens: 2 111 7 102 21 
[EMBEDDING] Stats: 1152/1152 non-zero values, sum=2.857, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1152/1152 non-zero, sum=2.856805
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1088/1152 non-zero, sum=57.816551
[ENCODER] SCALED EMBEDS before add: 1152/1152 non-zero, sum=32.321060
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1152/1152 non-zero, sum=90.137558
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.717929 -0.681396 -0.331211 0.705429 -0.496722 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.178968, variance=2.407937, stddev=1.551756
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1165/2304 range: [0.000000, 1.767863]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.641850, 0.761991]
[FEEDFORWARD] Sample values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017618, variance=1.037082, stddev=1.018377
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 0 output: 1152/1152 non-zero, sum=0.000007
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.831851 -0.957004 -0.803740 0.332163 -0.977816 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.830177, stddev=1.682316
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1147/2304 range: [0.000000, 1.690563]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.613341, 0.729018]
[FEEDFORWARD] Sample values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018144, variance=1.154901, stddev=1.074668
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 1 output: 1152/1152 non-zero, sum=0.000006
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 9x128
[DEBUG] Encoder sample values: -0.779 -1.641 -0.853 0.151 -1.615 
[DECODER] Starting decode with 6 tokens
[EMBEDDING] Forward pass - seq_len=6, d_model=128
[EMBEDDING] Input tokens: 2 293 444 213 161 
[EMBEDDING] Stats: 768/768 non-zero values, sum=5.776, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 768/768 non-zero, sum=5.776455
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 704/768 non-zero, sum=38.490261
[DECODER] SCALED EMBEDS before add: 768/768 non-zero, sum=65.353165
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 768/768 non-zero, sum=103.843430
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.777065 -1.148239 -1.158717 -0.083616 -1.299581 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.901031 -2.445415 -0.421856 1.066419 -2.320897 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.901031 -2.445415 -0.421856 1.066419 -2.320897 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.875364, stddev=1.695693
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.121094 -1.442133 -0.248781 0.628899 -1.368702 
[FEEDFORWARD] Forward pass: 6x128 -> 6x256 -> 6x128
[FEEDFORWARD] Input non-zero: 768/768
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 804/1536 range: [0.000000, 1.668698]
[FEEDFORWARD] Output non-zero: 768/768 range: [-0.731031, 0.682509]
[FEEDFORWARD] Sample values: 0.239738 -0.257939 -0.132769 -0.389176 -0.343033 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.121094 -1.442133 -0.248781 0.628899 -1.368702 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.239738 -0.257939 -0.132769 -0.389176 -0.343033 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.881356 -1.700072 -0.381550 0.239722 -1.711735 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.881356 -1.700072 -0.381550 0.239722 -1.711735 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018508, variance=1.140897, stddev=1.068132
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.842465 -1.608958 -0.374540 0.207104 -1.619877 
[DECODER] Layer 0 output: 768/768 non-zero, sum=0.000004
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.842465 -1.608958 -0.374540 0.207104 -1.619877 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.842465 -1.608958 -0.374540 0.207104 -1.619877 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.684929 -3.217916 -0.749080 0.414208 -3.239753 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.684929 -3.217916 -0.749080 0.414208 -3.239753 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999964, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.842467 -1.608963 -0.374541 0.207105 -1.619882 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.842467 -1.608963 -0.374541 0.207105 -1.619882 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.784529 -1.018069 -1.234401 -0.152572 -1.230320 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.626997 -2.627032 -1.608942 0.054532 -2.850202 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.626997 -2.627032 -1.608942 0.054532 -2.850202 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.019569, stddev=1.737694
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.936297 -1.511793 -0.925907 0.031382 -1.640221 
[FEEDFORWARD] Forward pass: 6x128 -> 6x256 -> 6x128
[FEEDFORWARD] Input non-zero: 768/768
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 768/1536 range: [0.000000, 1.729484]
[FEEDFORWARD] Output non-zero: 768/768 range: [-0.616515, 0.675671]
[FEEDFORWARD] Sample values: 0.231279 -0.281090 -0.145032 -0.362473 -0.254716 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.936297 -1.511793 -0.925907 0.031382 -1.640221 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.231279 -0.281090 -0.145032 -0.362473 -0.254716 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.705018 -1.792883 -1.070938 -0.331091 -1.894937 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.705018 -1.792883 -1.070938 -0.331091 -1.894937 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019277, variance=1.250182, stddev=1.118120
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.647780 -1.620721 -0.975044 -0.313355 -1.711994 
[DECODER] Layer 1 output: 768/768 non-zero, sum=-0.000005
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 6x128
[DEBUG] Decoder sample values: -0.648 -1.621 -0.975 -0.313 -1.712 
[LINEAR] Forward 6x128 -> 6x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.647780 -1.620721 -0.975044 -0.313355 -1.711994 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.030272 -0.011352 0.080071 0.108497 0.060915 
[DEBUG] Output projection - shape: 6x1000
[DEBUG] Output range: [-0.216, 0.181]
[DEBUG] Output sample values: -0.030 -0.011 0.080 0.108 0.061 
[DEBUG] Forward completed!
[DEBUG] Forward - source: 9 tokens, target: 7 tokens
[ENCODER] Starting encode with 9 tokens
[EMBEDDING] Forward pass - seq_len=9, d_model=128
[EMBEDDING] Input tokens: 2 111 7 102 21 
[EMBEDDING] Stats: 1152/1152 non-zero values, sum=2.857, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1152/1152 non-zero, sum=2.856805
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1088/1152 non-zero, sum=57.816551
[ENCODER] SCALED EMBEDS before add: 1152/1152 non-zero, sum=32.321060
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1152/1152 non-zero, sum=90.137558
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.717929 -0.681396 -0.331211 0.705429 -0.496722 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.178968, variance=2.407937, stddev=1.551756
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1165/2304 range: [0.000000, 1.767863]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.641850, 0.761991]
[FEEDFORWARD] Sample values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017618, variance=1.037082, stddev=1.018377
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 0 output: 1152/1152 non-zero, sum=0.000007
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.831851 -0.957004 -0.803740 0.332163 -0.977816 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.830177, stddev=1.682316
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1147/2304 range: [0.000000, 1.690563]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.613341, 0.729018]
[FEEDFORWARD] Sample values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018144, variance=1.154901, stddev=1.074668
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 1 output: 1152/1152 non-zero, sum=0.000006
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 9x128
[DEBUG] Encoder sample values: -0.779 -1.641 -0.853 0.151 -1.615 
[DECODER] Starting decode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 293 444 213 161 
[EMBEDDING] Stats: 896/896 non-zero values, sum=6.968, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 896/896 non-zero, sum=6.967720
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[DECODER] SCALED EMBEDS before add: 896/896 non-zero, sum=78.830826
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 896/896 non-zero, sum=123.757149
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.808862 -1.091598 -1.100541 -0.064055 -1.260628 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.932828 -2.388774 -0.363680 1.085981 -2.281944 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.932828 -2.388774 -0.363680 1.085981 -2.281944 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.790577, stddev=1.670505
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.157032 -1.429971 -0.217707 0.650091 -1.366020 
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 925/1792 range: [0.000000, 1.678857]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.717275, 0.723742]
[FEEDFORWARD] Sample values: 0.240764 -0.265760 -0.128263 -0.395770 -0.334048 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.157032 -1.429971 -0.217707 0.650091 -1.366020 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.240764 -0.265760 -0.128263 -0.395770 -0.334048 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.916268 -1.695731 -0.345969 0.254321 -1.700068 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.916268 -1.695731 -0.345969 0.254321 -1.700068 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018335, variance=1.138389, stddev=1.066958
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.875952 -1.606499 -0.341442 0.221176 -1.610564 
[DECODER] Layer 0 output: 896/896 non-zero, sum=0.000007
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.875952 -1.606499 -0.341442 0.221176 -1.610564 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.875952 -1.606499 -0.341442 0.221176 -1.610564 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.751903 -3.212997 -0.682885 0.442353 -3.221127 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.751903 -3.212997 -0.682885 0.442353 -3.221127 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999963, stddev=1.999993
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.875955 -1.606504 -0.341444 0.221177 -1.610569 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.875955 -1.606504 -0.341444 0.221177 -1.610569 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.804669 -0.975522 -1.190586 -0.140204 -1.205576 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.680623 -2.582026 -1.532029 0.080973 -2.816145 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.680623 -2.582026 -1.532029 0.080973 -2.816145 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.953289, stddev=1.718516
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.977950 -1.502474 -0.891484 0.047118 -1.638707 
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 897/1792 range: [0.000000, 1.745651]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.621604, 0.667490]
[FEEDFORWARD] Sample values: 0.232447 -0.292831 -0.137613 -0.368035 -0.245676 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.977950 -1.502474 -0.891484 0.047118 -1.638707 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.232447 -0.292831 -0.137613 -0.368035 -0.245676 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.745503 -1.795304 -1.029097 -0.320917 -1.884383 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.745503 -1.795304 -1.029097 -0.320917 -1.884383 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018911, variance=1.247252, stddev=1.116809
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.684463 -1.624464 -0.938395 -0.304286 -1.704226 
[DECODER] Layer 1 output: 896/896 non-zero, sum=0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 7x128
[DEBUG] Decoder sample values: -0.684 -1.624 -0.938 -0.304 -1.704 
[LINEAR] Forward 7x128 -> 7x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.684463 -1.624464 -0.938395 -0.304286 -1.704226 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.028347 -0.010614 0.077180 0.110373 0.061928 
[DEBUG] Output projection - shape: 7x1000
[DEBUG] Output range: [-0.226, 0.191]
[DEBUG] Output sample values: -0.028 -0.011 0.077 0.110 0.062 
[DEBUG] Forward completed!
[DEBUG] Forward - source: 9 tokens, target: 8 tokens
[ENCODER] Starting encode with 9 tokens
[EMBEDDING] Forward pass - seq_len=9, d_model=128
[EMBEDDING] Input tokens: 2 111 7 102 21 
[EMBEDDING] Stats: 1152/1152 non-zero values, sum=2.857, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1152/1152 non-zero, sum=2.856805
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 1088/1152 non-zero, sum=57.816551
[ENCODER] SCALED EMBEDS before add: 1152/1152 non-zero, sum=32.321060
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 1152/1152 non-zero, sum=90.137558
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.717929 -0.681396 -0.331211 0.705429 -0.496722 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.692403 -1.821274 -0.406141 1.902869 -1.373079 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.178968, variance=2.407937, stddev=1.551756
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1165/2304 range: [0.000000, 1.767863]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.641850, 0.761991]
[FEEDFORWARD] Sample values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.205969 -1.289018 -0.377062 1.110935 -1.000187 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.222216 -0.214220 -0.090413 -0.413139 -0.368320 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.983753 -1.503238 -0.467476 0.697797 -1.368508 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017618, variance=1.037082, stddev=1.018377
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 0 output: 1152/1152 non-zero, sum=0.000007
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1152/1152 non-zero
[ENCODER_LAYER] After self-attention: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.983301 -1.493411 -0.476340 0.667905 -1.361112 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.831851 -0.957004 -0.803740 0.332163 -0.977816 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.815151 -2.450416 -1.280080 1.000067 -2.338928 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.830177, stddev=1.682316
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[ENCODER_LAYER] After norm1: 1152/1152 non-zero
[FEEDFORWARD] Forward pass: 9x128 -> 9x256 -> 9x128
[FEEDFORWARD] Input non-zero: 1152/1152
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1147/2304 range: [0.000000, 1.690563]
[FEEDFORWARD] Output non-zero: 1152/1152 range: [-0.613341, 0.729018]
[FEEDFORWARD] Sample values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[ENCODER_LAYER] After feedforward: 1152/1152 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.078960 -1.456573 -0.760903 0.594459 -1.390303 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.260436 -0.288330 -0.137714 -0.414508 -0.326767 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.818524 -1.744903 -0.898617 0.179950 -1.717070 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018144, variance=1.154901, stddev=1.074668
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.778537 -1.640551 -0.853065 0.150564 -1.614652 
[ENCODER_LAYER] Final output: 1152/1152 non-zero
[ENCODER] Layer 1 output: 1152/1152 non-zero, sum=0.000006
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 9x128
[DEBUG] Encoder sample values: -0.779 -1.641 -0.853 0.151 -1.615 
[DECODER] Starting decode with 8 tokens
[EMBEDDING] Forward pass - seq_len=8, d_model=128
[EMBEDDING] Input tokens: 2 293 444 213 161 
[EMBEDDING] Stats: 1024/1024 non-zero values, sum=8.124, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 1024/1024 non-zero, sum=8.123581
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 960/1024 non-zero, sum=51.368427
[DECODER] SCALED EMBEDS before add: 1024/1024 non-zero, sum=91.907898
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 1024/1024 non-zero, sum=143.276245
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.761234 -1.094131 -1.155533 -0.029096 -1.247580 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.885200 -2.391307 -0.418672 1.120939 -2.268897 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.885200 -2.391307 -0.418672 1.120939 -2.268897 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.703716, stddev=1.644301
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.146505 -1.454300 -0.254620 0.681712 -1.379855 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1050/2048 range: [0.000000, 1.656203]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.704079, 0.725296]
[FEEDFORWARD] Sample values: 0.248046 -0.272082 -0.138637 -0.397917 -0.333490 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.146505 -1.454300 -0.254620 0.681712 -1.379855 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.248046 -0.272082 -0.138637 -0.397917 -0.333490 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.898459 -1.726382 -0.393257 0.283794 -1.713345 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.898459 -1.726382 -0.393257 0.283794 -1.713345 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019090, variance=1.139743, stddev=1.067592
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.859457 -1.634961 -0.386240 0.247945 -1.622749 
[DECODER] Layer 0 output: 1024/1024 non-zero, sum=-0.000005
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.859457 -1.634961 -0.386240 0.247945 -1.622749 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.859457 -1.634961 -0.386240 0.247945 -1.622749 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.718913 -3.269922 -0.772479 0.495891 -3.245499 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.718913 -3.269922 -0.772479 0.495891 -3.245499 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999964, stddev=1.999993
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.859459 -1.634967 -0.386241 0.247946 -1.622755 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.859459 -1.634967 -0.386241 0.247946 -1.622755 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.741248 -0.982335 -1.267414 -0.089952 -1.186526 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.600708 -2.617302 -1.653655 0.157995 -2.809281 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.600708 -2.617302 -1.653655 0.157995 -2.809281 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=2.845915, stddev=1.686987
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.948856 -1.551466 -0.980242 0.093655 -1.665265 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1005/2048 range: [0.000000, 1.701940]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.615954, 0.670288]
[FEEDFORWARD] Sample values: 0.248566 -0.314081 -0.153444 -0.371682 -0.241665 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.948856 -1.551466 -0.980242 0.093655 -1.665265 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.248566 -0.314081 -0.153444 -0.371682 -0.241665 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.700290 -1.865547 -1.133686 -0.278027 -1.906930 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.700290 -1.865547 -1.133686 -0.278027 -1.906930 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.020029, variance=1.253072, stddev=1.119411
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.643479 -1.684435 -1.030644 -0.266261 -1.721404 
[DECODER] Layer 1 output: 1024/1024 non-zero, sum=-0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 8x128
[DEBUG] Decoder sample values: -0.643 -1.684 -1.031 -0.266 -1.721 
[LINEAR] Forward 8x128 -> 8x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.643479 -1.684435 -1.030644 -0.266261 -1.721404 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.028072 -0.013164 0.078734 0.113373 0.066532 
[DEBUG] Output projection - shape: 8x1000
[DEBUG] Output range: [-0.183, 0.189]
[DEBUG] Output sample values: -0.028 -0.013 0.079 0.113 0.067 
[DEBUG] Forward completed!
  ENG: <sos> could you tell me your present address <eos>
  ESP: <sos> diez cuatro fuera nuevo gente cuatro fuera <eos>
  ================================

¡Entrenamiento completado!

=== Pruebas de Traducción ===
[DEBUG] Forward - source: 3 tokens, target: 1 tokens
[ENCODER] Starting encode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 1 3 
[EMBEDDING] Stats: 384/384 non-zero values, sum=-1.485, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 384/384 non-zero, sum=-1.484507
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[ENCODER] SCALED EMBEDS before add: 384/384 non-zero, sum=-16.795279
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 384/384 non-zero, sum=2.422785
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 384/384 non-zero
[ENCODER_LAYER] After self-attention: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.852136 -0.977525 -0.114151 1.176879 -0.879076 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.826610 -2.117403 -0.189081 2.374319 -1.755432 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.826610 -2.117403 -0.189081 2.374319 -1.755432 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.173162, variance=3.337495, stddev=1.826884
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.094635 -1.253810 -0.198285 1.204869 -1.055674 
[ENCODER_LAYER] After norm1: 384/384 non-zero
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 395/768 range: [0.000000, 1.460086]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.569441, 0.757645]
[FEEDFORWARD] Sample values: 0.210131 -0.200294 -0.051183 -0.402038 -0.314685 
[ENCODER_LAYER] After feedforward: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.094635 -1.253810 -0.198285 1.204869 -1.055674 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.210131 -0.200294 -0.051183 -0.402038 -0.314685 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.884505 -1.454104 -0.249468 0.802831 -1.370359 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.884505 -1.454104 -0.249468 0.802831 -1.370359 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017895, variance=1.042015, stddev=1.020796
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.884015 -1.442011 -0.261916 0.768945 -1.359972 
[ENCODER_LAYER] Final output: 384/384 non-zero
[ENCODER] Layer 0 output: 384/384 non-zero, sum=-0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 384/384 non-zero
[ENCODER_LAYER] After self-attention: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.884015 -1.442011 -0.261916 0.768945 -1.359972 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.737734 -1.231904 -0.295259 0.809260 -1.316001 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.621750 -2.673915 -0.557175 1.578205 -2.675973 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.621750 -2.673915 -0.557175 1.578205 -2.675973 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.666241, stddev=1.914746
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.846979 -1.396486 -0.290992 0.824237 -1.397561 
[ENCODER_LAYER] After norm1: 384/384 non-zero
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 390/768 range: [0.000000, 1.701158]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.634511, 0.645483]
[FEEDFORWARD] Sample values: 0.255573 -0.251727 -0.061883 -0.421232 -0.234211 
[ENCODER_LAYER] After feedforward: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.846979 -1.396486 -0.290992 0.824237 -1.397561 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.255573 -0.251727 -0.061883 -0.421232 -0.234211 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.591406 -1.648213 -0.352875 0.403005 -1.631772 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.591406 -1.648213 -0.352875 0.403005 -1.631772 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019065, variance=1.157021, stddev=1.075654
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.567535 -1.550013 -0.345780 0.356937 -1.534729 
[ENCODER_LAYER] Final output: 384/384 non-zero
[ENCODER] Layer 1 output: 384/384 non-zero, sum=-0.000003
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 3x128
[DEBUG] Encoder sample values: -0.568 -1.550 -0.346 0.357 -1.535 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=0.545, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=0.544836
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=6.164124
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 128/128 non-zero, sum=12.564120
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.567535 -1.550013 -0.345780 0.356937 -1.534729 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.691501 -2.847189 0.391081 1.506972 -2.556045 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.691501 -2.847189 0.391081 1.506972 -2.556045 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.767630, stddev=1.941041
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.871440 -1.466836 0.201480 0.776373 -1.316842 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 127/256 range: [0.000000, 1.673562]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.561347, 0.653682]
[FEEDFORWARD] Sample values: 0.232528 -0.235200 -0.077449 -0.419457 -0.255168 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.871440 -1.466836 0.201480 0.776373 -1.316842 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.232528 -0.235200 -0.077449 -0.419457 -0.255168 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.638912 -1.702036 0.124031 0.356916 -1.572010 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.638912 -1.702036 0.124031 0.356916 -1.572010 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019777, variance=1.153656, stddev=1.074089
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.613254 -1.603046 0.097063 0.313884 -1.481989 
[DECODER] Layer 0 output: 128/128 non-zero, sum=-0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.613254 -1.603046 0.097063 0.313884 -1.481989 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.613254 -1.603046 0.097063 0.313884 -1.481989 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.226508 -3.206092 0.194126 0.627767 -2.963978 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.226508 -3.206092 0.194126 0.627767 -2.963978 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.613256 -1.603051 0.097063 0.313885 -1.481993 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.613256 -1.603051 0.097063 0.313885 -1.481993 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.567535 -1.550013 -0.345780 0.356937 -1.534729 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.180791 -3.153064 -0.248717 0.670821 -3.016722 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.180791 -3.153064 -0.248717 0.670821 -3.016722 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.996489, stddev=1.999125
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.590654 -1.577222 -0.124413 0.335558 -1.509021 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 132/256 range: [0.000000, 1.758300]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.640212, 0.643219]
[FEEDFORWARD] Sample values: 0.238371 -0.260567 -0.099170 -0.401266 -0.191697 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.590654 -1.577222 -0.124413 0.335558 -1.509021 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.238371 -0.260567 -0.099170 -0.401266 -0.191697 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.352283 -1.837789 -0.223583 -0.065709 -1.700718 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.352283 -1.837789 -0.223583 -0.065709 -1.700718 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017447, variance=1.253456, stddev=1.119583
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.330240 -1.657079 -0.215286 -0.074274 -1.534648 
[DECODER] Layer 1 output: 128/128 non-zero, sum=-0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.330 -1.657 -0.215 -0.074 -1.535 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.330240 -1.657079 -0.215286 -0.074274 -1.534648 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.035661 0.015129 0.111483 0.116256 0.068171 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-0.167, 0.186]
[DEBUG] Output sample values: -0.036 0.015 0.111 0.116 0.068 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 900 (score: 0.2, target_len: 2) [Top scores: 293:0.2 900:0.2 148:0.2 213:0.2 161:0.2 ]
[DEBUG] Forward - source: 3 tokens, target: 2 tokens
[ENCODER] Starting encode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 1 3 
[EMBEDDING] Stats: 384/384 non-zero values, sum=-1.5, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 384/384 non-zero, sum=-1.484507
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[ENCODER] SCALED EMBEDS before add: 384/384 non-zero, sum=-16.795279
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 384/384 non-zero, sum=2.422785
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 384/384 non-zero
[ENCODER_LAYER] After self-attention: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.852136 -0.977525 -0.114151 1.176879 -0.879076 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.826610 -2.117403 -0.189081 2.374319 -1.755432 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.826610 -2.117403 -0.189081 2.374319 -1.755432 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.173162, variance=3.337495, stddev=1.826884
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.094635 -1.253810 -0.198285 1.204869 -1.055674 
[ENCODER_LAYER] After norm1: 384/384 non-zero
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 395/768 range: [0.000000, 1.460086]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.569441, 0.757645]
[FEEDFORWARD] Sample values: 0.210131 -0.200294 -0.051183 -0.402038 -0.314685 
[ENCODER_LAYER] After feedforward: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.094635 -1.253810 -0.198285 1.204869 -1.055674 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.210131 -0.200294 -0.051183 -0.402038 -0.314685 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.884505 -1.454104 -0.249468 0.802831 -1.370359 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.884505 -1.454104 -0.249468 0.802831 -1.370359 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017895, variance=1.042015, stddev=1.020796
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.884015 -1.442011 -0.261916 0.768945 -1.359972 
[ENCODER_LAYER] Final output: 384/384 non-zero
[ENCODER] Layer 0 output: 384/384 non-zero, sum=-0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 384/384 non-zero
[ENCODER_LAYER] After self-attention: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.884015 -1.442011 -0.261916 0.768945 -1.359972 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.737734 -1.231904 -0.295259 0.809260 -1.316001 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.621750 -2.673915 -0.557175 1.578205 -2.675973 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.621750 -2.673915 -0.557175 1.578205 -2.675973 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.666241, stddev=1.914746
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.846979 -1.396486 -0.290992 0.824237 -1.397561 
[ENCODER_LAYER] After norm1: 384/384 non-zero
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 390/768 range: [0.000000, 1.701158]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.634511, 0.645483]
[FEEDFORWARD] Sample values: 0.255573 -0.251727 -0.061883 -0.421232 -0.234211 
[ENCODER_LAYER] After feedforward: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.846979 -1.396486 -0.290992 0.824237 -1.397561 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.255573 -0.251727 -0.061883 -0.421232 -0.234211 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.591406 -1.648213 -0.352875 0.403005 -1.631772 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.591406 -1.648213 -0.352875 0.403005 -1.631772 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019065, variance=1.157021, stddev=1.075654
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.567535 -1.550013 -0.345780 0.356937 -1.534729 
[ENCODER_LAYER] Final output: 384/384 non-zero
[ENCODER] Layer 1 output: 384/384 non-zero, sum=-0.000003
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 3x128
[DEBUG] Encoder sample values: -0.568 -1.550 -0.346 0.357 -1.535 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 900 
[EMBEDDING] Stats: 256/256 non-zero values, sum=0.282, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=0.282293
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=3.193779
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 256/256 non-zero, sum=15.999798
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.460584 -1.426268 -0.381725 0.454935 -1.451032 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.584549 -2.723444 0.355137 1.604970 -2.472348 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.584549 -2.723444 0.355137 1.604970 -2.472348 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.543641, stddev=1.882459
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.841745 -1.446748 0.188656 0.852592 -1.313361 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 253/512 range: [0.000000, 1.698148]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.559260, 0.659726]
[FEEDFORWARD] Sample values: 0.241773 -0.235105 -0.071727 -0.402911 -0.255194 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.841745 -1.446748 0.188656 0.852592 -1.313361 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.241773 -0.235105 -0.071727 -0.402911 -0.255194 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.599971 -1.681853 0.116929 0.449681 -1.568555 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.599971 -1.681853 0.116929 0.449681 -1.568555 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019631, variance=1.153852, stddev=1.074180
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.576815 -1.583985 0.090578 0.400352 -1.478511 
[DECODER] Layer 0 output: 256/256 non-zero, sum=0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.576815 -1.583985 0.090578 0.400352 -1.478511 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.576815 -1.583985 0.090578 0.400352 -1.478511 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.153629 -3.167970 0.181157 0.800704 -2.957021 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.153629 -3.167970 0.181157 0.800704 -2.957021 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.576816 -1.583990 0.090579 0.400353 -1.478515 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.576816 -1.583990 0.090579 0.400353 -1.478515 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.431111 -1.392167 -0.391630 0.481940 -1.427967 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.007927 -2.976157 -0.301051 0.882293 -2.906482 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.007927 -2.976157 -0.301051 0.882293 -2.906482 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.720540, stddev=1.928873
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.522547 -1.542952 -0.156076 0.457414 -1.506830 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 254/512 range: [0.000000, 1.800626]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.639764, 0.687335]
[FEEDFORWARD] Sample values: 0.255002 -0.262947 -0.087342 -0.368336 -0.194978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.522547 -1.542952 -0.156076 0.457414 -1.506830 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.255002 -0.262947 -0.087342 -0.368336 -0.194978 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.267545 -1.805898 -0.243418 0.089078 -1.701808 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.267545 -1.805898 -0.243418 0.089078 -1.701808 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017257, variance=1.260176, stddev=1.122580
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.253703 -1.624076 -0.232211 0.063978 -1.531352 
[DECODER] Layer 1 output: 256/256 non-zero, sum=0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.254 -1.624 -0.232 0.064 -1.531 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.253703 -1.624076 -0.232211 0.063978 -1.531352 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.036413 0.018281 0.118866 0.104170 0.076163 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-0.170, 0.200]
[DEBUG] Output sample values: -0.036 0.018 0.119 0.104 0.076 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 3 (score: 5.0, target_len: 2) [Top scores: 3:5.0 252:0.2 222:0.2 213:0.1 180:0.1 ]
ENG: <sos> hello <eos>
ESP: <sos> europa <eos>
---
[DEBUG] Forward - source: 5 tokens, target: 1 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 53 25 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=-2.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=-2.069594
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=-23.414770
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 640/640 non-zero, sum=8.645407
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.802538 -0.935007 -0.127742 1.145882 -0.922840 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.777012 -2.074886 -0.202672 2.343322 -1.799197 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.777012 -2.074886 -0.202672 2.343322 -1.799197 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.168196, variance=2.884334, stddev=1.698336
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.145362 -1.320753 -0.218372 1.280740 -1.158424 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 640/1280 range: [0.000000, 1.848407]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.595550, 0.757848]
[FEEDFORWARD] Sample values: 0.210468 -0.191837 -0.057584 -0.416766 -0.350949 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.145362 -1.320753 -0.218372 1.280740 -1.158424 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.210468 -0.191837 -0.057584 -0.416766 -0.350949 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.934894 -1.512590 -0.275956 0.863974 -1.509373 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.934894 -1.512590 -0.275956 0.863974 -1.509373 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017475, variance=1.038242, stddev=1.018947
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.934660 -1.501614 -0.287975 0.830759 -1.498457 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=-0.000000
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.934660 -1.501614 -0.287975 0.830759 -1.498457 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.768945 -1.231721 -0.329441 0.836181 -1.495851 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.703605 -2.733335 -0.617415 1.666940 -2.994308 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.703605 -2.733335 -0.617415 1.666940 -2.994308 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.222709, stddev=1.795193
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.948981 -1.522585 -0.343927 0.928558 -1.667958 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 636/1280 range: [0.000000, 1.780758]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.608652, 0.648909]
[FEEDFORWARD] Sample values: 0.259509 -0.240988 -0.080119 -0.445807 -0.296027 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.948981 -1.522585 -0.343927 0.928558 -1.667958 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.259509 -0.240988 -0.080119 -0.445807 -0.296027 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.689472 -1.763573 -0.424046 0.482751 -1.963986 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.689472 -1.763573 -0.424046 0.482751 -1.963986 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018040, variance=1.148889, stddev=1.071867
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.660074 -1.662159 -0.412445 0.433553 -1.849134 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000002
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.660 -1.662 -0.412 0.434 -1.849 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=0.545, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=0.544836
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=6.164124
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 128/128 non-zero, sum=12.564120
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.660074 -1.662159 -0.412445 0.433553 -1.849134 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.784040 -2.959335 0.324417 1.583588 -2.870450 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.784040 -2.959335 0.324417 1.583588 -2.870450 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.764547, stddev=1.940247
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.919491 -1.525236 0.167204 0.816179 -1.479426 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 124/256 range: [0.000000, 1.662750]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.580156, 0.659894]
[FEEDFORWARD] Sample values: 0.239017 -0.229218 -0.091388 -0.437175 -0.280128 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.919491 -1.525236 0.167204 0.816179 -1.479426 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.239017 -0.229218 -0.091388 -0.437175 -0.280128 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.680474 -1.754455 0.075816 0.379003 -1.759553 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.680474 -1.754455 0.075816 0.379003 -1.759553 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019312, variance=1.149681, stddev=1.072237
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.652642 -1.654269 0.052697 0.335459 -1.659024 
[DECODER] Layer 0 output: 128/128 non-zero, sum=-0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.652642 -1.654269 0.052697 0.335459 -1.659024 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.652642 -1.654269 0.052697 0.335459 -1.659024 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.305284 -3.308537 0.105393 0.670917 -3.318048 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.305284 -3.308537 0.105393 0.670917 -3.318048 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.652644 -1.654274 0.052697 0.335460 -1.659029 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.652644 -1.654274 0.052697 0.335460 -1.659029 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.660074 -1.662159 -0.412445 0.433553 -1.849134 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.312719 -3.316432 -0.359748 0.769012 -3.508163 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.312719 -3.316432 -0.359748 0.769012 -3.508163 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.993451, stddev=1.998364
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.656897 -1.659573 -0.180021 0.384821 -1.755517 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 126/256 range: [0.000000, 1.746014]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.664481, 0.579178]
[FEEDFORWARD] Sample values: 0.244866 -0.248333 -0.121383 -0.421767 -0.227866 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.656897 -1.659573 -0.180021 0.384821 -1.755517 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.244866 -0.248333 -0.121383 -0.421767 -0.227866 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.412031 -1.907907 -0.301405 -0.036947 -1.983383 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.412031 -1.907907 -0.301405 -0.036947 -1.983383 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.016711, variance=1.248171, stddev=1.117220
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.383758 -1.722684 -0.284739 -0.048028 -1.790242 
[DECODER] Layer 1 output: 128/128 non-zero, sum=0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.384 -1.723 -0.285 -0.048 -1.790 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.383758 -1.722684 -0.284739 -0.048028 -1.790242 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.038617 0.017143 0.113404 0.119242 0.067623 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-0.161, 0.182]
[DEBUG] Output sample values: -0.039 0.017 0.113 0.119 0.068 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 293 (score: 0.2, target_len: 4) [Top scores: 900:0.2 148:0.2 293:0.2 161:0.2 213:0.2 ]
[DEBUG] Forward - source: 5 tokens, target: 2 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 53 25 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=-2.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=-2.069594
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=-23.414770
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 640/640 non-zero, sum=8.645407
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.802538 -0.935007 -0.127742 1.145882 -0.922840 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.777012 -2.074886 -0.202672 2.343322 -1.799197 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.777012 -2.074886 -0.202672 2.343322 -1.799197 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.168196, variance=2.884334, stddev=1.698336
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.145362 -1.320753 -0.218372 1.280740 -1.158424 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 640/1280 range: [0.000000, 1.848407]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.595550, 0.757848]
[FEEDFORWARD] Sample values: 0.210468 -0.191837 -0.057584 -0.416766 -0.350949 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.145362 -1.320753 -0.218372 1.280740 -1.158424 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.210468 -0.191837 -0.057584 -0.416766 -0.350949 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.934894 -1.512590 -0.275956 0.863974 -1.509373 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.934894 -1.512590 -0.275956 0.863974 -1.509373 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017475, variance=1.038242, stddev=1.018947
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.934660 -1.501614 -0.287975 0.830759 -1.498457 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=-0.000000
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.934660 -1.501614 -0.287975 0.830759 -1.498457 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.768945 -1.231721 -0.329441 0.836181 -1.495851 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.703605 -2.733335 -0.617415 1.666940 -2.994308 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.703605 -2.733335 -0.617415 1.666940 -2.994308 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.222709, stddev=1.795193
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.948981 -1.522585 -0.343927 0.928558 -1.667958 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 636/1280 range: [0.000000, 1.780758]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.608652, 0.648909]
[FEEDFORWARD] Sample values: 0.259509 -0.240988 -0.080119 -0.445807 -0.296027 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.948981 -1.522585 -0.343927 0.928558 -1.667958 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.259509 -0.240988 -0.080119 -0.445807 -0.296027 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.689472 -1.763573 -0.424046 0.482751 -1.963986 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.689472 -1.763573 -0.424046 0.482751 -1.963986 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018040, variance=1.148889, stddev=1.071867
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.660074 -1.662159 -0.412445 0.433553 -1.849134 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000002
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.660 -1.662 -0.412 0.434 -1.849 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 293 
[EMBEDDING] Stats: 256/256 non-zero values, sum=0.923, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=0.923086
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=10.443524
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 256/256 non-zero, sum=23.249554
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.626383 -1.561750 -0.361353 0.509576 -1.834658 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.750349 -2.858926 0.375508 1.659611 -2.855974 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.750349 -2.858926 0.375508 1.659611 -2.855974 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.409716, stddev=1.846544
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.947905 -1.548257 0.203357 0.898766 -1.546659 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 257/512 range: [0.000000, 1.683553]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.606451, 0.663167]
[FEEDFORWARD] Sample values: 0.258927 -0.232167 -0.092521 -0.440869 -0.293736 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.947905 -1.548257 0.203357 0.898766 -1.546659 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.258927 -0.232167 -0.092521 -0.440869 -0.293736 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.688978 -1.780424 0.110837 0.457897 -1.840395 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.688978 -1.780424 0.110837 0.457897 -1.840395 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019444, variance=1.146238, stddev=1.070630
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.661687 -1.681130 0.085364 0.409529 -1.737145 
[DECODER] Layer 0 output: 256/256 non-zero, sum=-0.000003
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.661687 -1.681130 0.085364 0.409529 -1.737145 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.661687 -1.681130 0.085364 0.409529 -1.737145 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.323374 -3.362261 0.170727 0.819057 -3.474290 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.323374 -3.362261 0.170727 0.819057 -3.474290 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999964, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.661689 -1.681136 0.085364 0.409530 -1.737150 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.661689 -1.681136 0.085364 0.409530 -1.737150 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.625994 -1.560590 -0.360763 0.510455 -1.834491 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.287683 -3.241725 -0.275399 0.919984 -3.571641 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.287683 -3.241725 -0.275399 0.919984 -3.571641 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.641685, stddev=1.908323
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.674772 -1.698730 -0.144315 0.482091 -1.871613 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 252/512 range: [0.000000, 1.952945]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.697108, 0.590960]
[FEEDFORWARD] Sample values: 0.267121 -0.240403 -0.123617 -0.426057 -0.246085 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.674772 -1.698730 -0.144315 0.482091 -1.871613 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.267121 -0.240403 -0.123617 -0.426057 -0.246085 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407651 -1.939133 -0.267932 0.056034 -2.117698 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.407651 -1.939133 -0.267932 0.056034 -2.117698 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017464, variance=1.251102, stddev=1.118531
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.380066 -1.749256 -0.255152 0.034483 -1.908898 
[DECODER] Layer 1 output: 256/256 non-zero, sum=0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.380 -1.749 -0.255 0.034 -1.909 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.380066 -1.749256 -0.255152 0.034483 -1.908898 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.036386 0.022051 0.113978 0.121467 0.064137 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-0.181, 0.216]
[DEBUG] Output sample values: -0.036 0.022 0.114 0.121 0.064 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 203 (score: 0.2, target_len: 4) [Top scores: 148:0.2 161:0.2 203:0.2 239:0.2 531:0.2 ]
[DEBUG] Forward - source: 5 tokens, target: 3 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 53 25 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=-2.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=-2.069594
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=-23.414770
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 640/640 non-zero, sum=8.645407
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.802538 -0.935007 -0.127742 1.145882 -0.922840 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.777012 -2.074886 -0.202672 2.343322 -1.799197 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.777012 -2.074886 -0.202672 2.343322 -1.799197 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.168196, variance=2.884334, stddev=1.698336
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.145362 -1.320753 -0.218372 1.280740 -1.158424 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 640/1280 range: [0.000000, 1.848407]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.595550, 0.757848]
[FEEDFORWARD] Sample values: 0.210468 -0.191837 -0.057584 -0.416766 -0.350949 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.145362 -1.320753 -0.218372 1.280740 -1.158424 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.210468 -0.191837 -0.057584 -0.416766 -0.350949 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.934894 -1.512590 -0.275956 0.863974 -1.509373 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.934894 -1.512590 -0.275956 0.863974 -1.509373 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017475, variance=1.038242, stddev=1.018947
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.934660 -1.501614 -0.287975 0.830759 -1.498457 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=-0.000000
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.934660 -1.501614 -0.287975 0.830759 -1.498457 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.768945 -1.231721 -0.329441 0.836181 -1.495851 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.703605 -2.733335 -0.617415 1.666940 -2.994308 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.703605 -2.733335 -0.617415 1.666940 -2.994308 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.222709, stddev=1.795193
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.948981 -1.522585 -0.343927 0.928558 -1.667958 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 636/1280 range: [0.000000, 1.780758]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.608652, 0.648909]
[FEEDFORWARD] Sample values: 0.259509 -0.240988 -0.080119 -0.445807 -0.296027 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.948981 -1.522585 -0.343927 0.928558 -1.667958 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.259509 -0.240988 -0.080119 -0.445807 -0.296027 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.689472 -1.763573 -0.424046 0.482751 -1.963986 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.689472 -1.763573 -0.424046 0.482751 -1.963986 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018040, variance=1.148889, stddev=1.071867
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.660074 -1.662159 -0.412445 0.433553 -1.849134 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000002
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.660 -1.662 -0.412 0.434 -1.849 
[DECODER] Starting decode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 293 203 
[EMBEDDING] Stats: 384/384 non-zero values, sum=1.669, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 384/384 non-zero, sum=1.668756
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[DECODER] SCALED EMBEDS before add: 384/384 non-zero, sum=18.879816
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 384/384 non-zero, sum=38.097893
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.562315 -1.488652 -0.405833 0.546157 -1.807215 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.686281 -2.785827 0.331028 1.696192 -2.828531 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.686281 -2.785827 0.331028 1.696192 -2.828531 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.210813, stddev=1.791877
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.941070 -1.554698 0.184738 0.946601 -1.578530 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 379/768 range: [0.000000, 1.667959]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.640277, 0.730422]
[FEEDFORWARD] Sample values: 0.262606 -0.224743 -0.107521 -0.440594 -0.301585 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.941070 -1.554698 0.184738 0.946601 -1.578530 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.262606 -0.224743 -0.107521 -0.440594 -0.301585 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.678463 -1.779441 0.077218 0.506007 -1.880115 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.678463 -1.779441 0.077218 0.506007 -1.880115 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019464, variance=1.143032, stddev=1.069131
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.652798 -1.682585 0.054020 0.455083 -1.776749 
[DECODER] Layer 0 output: 384/384 non-zero, sum=-0.000003
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.652798 -1.682585 0.054020 0.455083 -1.776749 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.652798 -1.682585 0.054020 0.455083 -1.776749 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.305596 -3.365170 0.108039 0.910166 -3.553498 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.305596 -3.365170 0.108039 0.910166 -3.553498 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999964, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.652800 -1.682590 0.054020 0.455085 -1.776755 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.652800 -1.682590 0.054020 0.455085 -1.776755 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.550972 -1.474417 -0.412154 0.553818 -1.802356 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.203772 -3.157008 -0.358134 1.008903 -3.579110 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.203772 -3.157008 -0.358134 1.008903 -3.579110 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.412998, stddev=1.847433
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.651592 -1.708862 -0.193855 0.546111 -1.937343 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 368/768 range: [0.000000, 1.757062]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.690503, 0.580440]
[FEEDFORWARD] Sample values: 0.277382 -0.227430 -0.148024 -0.422550 -0.255953 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.651592 -1.708862 -0.193855 0.546111 -1.937343 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.277382 -0.227430 -0.148024 -0.422550 -0.255953 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.374209 -1.936292 -0.341879 0.123561 -2.193296 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.374209 -1.936292 -0.341879 0.123561 -2.193296 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017792, variance=1.250514, stddev=1.118268
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.350543 -1.747419 -0.321632 0.094583 -1.977243 
[DECODER] Layer 1 output: 384/384 non-zero, sum=0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 3x128
[DEBUG] Decoder sample values: -0.351 -1.747 -0.322 0.095 -1.977 
[LINEAR] Forward 3x128 -> 3x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.350543 -1.747419 -0.321632 0.094583 -1.977243 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.038188 0.025796 0.116088 0.117701 0.068037 
[DEBUG] Output projection - shape: 3x1000
[DEBUG] Output range: [-0.236, 0.214]
[DEBUG] Output sample values: -0.038 0.026 0.116 0.118 0.068 
[DEBUG] Forward completed!
[GEN] Step 2 - Best token: 148 (score: 0.2, target_len: 4) [Top scores: 148:0.2 151:0.2 974:0.2 486:0.2 798:0.2 ]
[DEBUG] Forward - source: 5 tokens, target: 4 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 53 25 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=-2.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=-2.069594
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=-23.414770
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 640/640 non-zero, sum=8.645407
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.802538 -0.935007 -0.127742 1.145882 -0.922840 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.777012 -2.074886 -0.202672 2.343322 -1.799197 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.777012 -2.074886 -0.202672 2.343322 -1.799197 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.168196, variance=2.884334, stddev=1.698336
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.145362 -1.320753 -0.218372 1.280740 -1.158424 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 640/1280 range: [0.000000, 1.848407]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.595550, 0.757848]
[FEEDFORWARD] Sample values: 0.210468 -0.191837 -0.057584 -0.416766 -0.350949 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.145362 -1.320753 -0.218372 1.280740 -1.158424 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.210468 -0.191837 -0.057584 -0.416766 -0.350949 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.934894 -1.512590 -0.275956 0.863974 -1.509373 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.934894 -1.512590 -0.275956 0.863974 -1.509373 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017475, variance=1.038242, stddev=1.018947
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.934660 -1.501614 -0.287975 0.830759 -1.498457 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=-0.000000
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.934660 -1.501614 -0.287975 0.830759 -1.498457 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.768945 -1.231721 -0.329441 0.836181 -1.495851 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.703605 -2.733335 -0.617415 1.666940 -2.994308 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.703605 -2.733335 -0.617415 1.666940 -2.994308 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.222709, stddev=1.795193
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.948981 -1.522585 -0.343927 0.928558 -1.667958 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 636/1280 range: [0.000000, 1.780758]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.608652, 0.648909]
[FEEDFORWARD] Sample values: 0.259509 -0.240988 -0.080119 -0.445807 -0.296027 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.948981 -1.522585 -0.343927 0.928558 -1.667958 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.259509 -0.240988 -0.080119 -0.445807 -0.296027 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.689472 -1.763573 -0.424046 0.482751 -1.963986 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.689472 -1.763573 -0.424046 0.482751 -1.963986 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018040, variance=1.148889, stddev=1.071867
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.660074 -1.662159 -0.412445 0.433553 -1.849134 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000002
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.660 -1.662 -0.412 0.434 -1.849 
[DECODER] Starting decode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 293 203 148 
[EMBEDDING] Stats: 512/512 non-zero values, sum=2.887, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 512/512 non-zero, sum=2.887437
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[DECODER] SCALED EMBEDS before add: 512/512 non-zero, sum=32.667606
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 512/512 non-zero, sum=58.303768
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.556962 -1.423730 -0.457859 0.499701 -1.808849 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.680928 -2.720905 0.279002 1.649736 -2.830165 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.680928 -2.720905 0.279002 1.649736 -2.830165 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.078867, stddev=1.754673
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.957972 -1.550662 0.159005 0.940196 -1.612930 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 518/1024 range: [0.000000, 1.675340]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.625237, 0.734647]
[FEEDFORWARD] Sample values: 0.253728 -0.218502 -0.103625 -0.432340 -0.311608 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.957972 -1.550662 0.159005 0.940196 -1.612930 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.253728 -0.218502 -0.103625 -0.432340 -0.311608 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.704244 -1.769164 0.055380 0.507856 -1.924538 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.704244 -1.769164 0.055380 0.507856 -1.924538 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019036, variance=1.138350, stddev=1.066940
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.677902 -1.676008 0.034065 0.458152 -1.821635 
[DECODER] Layer 0 output: 512/512 non-zero, sum=0.000007
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.677902 -1.676008 0.034065 0.458152 -1.821635 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.677902 -1.676008 0.034065 0.458152 -1.821635 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.355803 -3.352017 0.068129 0.916304 -3.643269 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.355803 -3.352017 0.068129 0.916304 -3.643269 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999963, stddev=1.999993
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.677904 -1.676014 0.034065 0.458154 -1.821641 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.677904 -1.676014 0.034065 0.458154 -1.821641 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.545184 -1.392896 -0.476934 0.494728 -1.804852 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.223089 -3.068910 -0.442869 0.952882 -3.626493 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.223089 -3.068910 -0.442869 0.952882 -3.626493 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.240652, stddev=1.800184
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.679424 -1.704776 -0.246013 0.529325 -2.014512 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 504/1024 range: [0.000000, 1.774798]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.688016, 0.784532]
[FEEDFORWARD] Sample values: 0.262612 -0.219508 -0.139698 -0.406370 -0.265497 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.679424 -1.704776 -0.246013 0.529325 -2.014512 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.262612 -0.219508 -0.139698 -0.406370 -0.265497 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.416812 -1.924284 -0.385711 0.122955 -2.280009 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.416812 -1.924284 -0.385711 0.122955 -2.280009 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.016737, variance=1.245262, stddev=1.115918
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.388513 -1.739395 -0.360643 0.095184 -2.058168 
[DECODER] Layer 1 output: 512/512 non-zero, sum=-0.000009
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 4x128
[DEBUG] Decoder sample values: -0.389 -1.739 -0.361 0.095 -2.058 
[LINEAR] Forward 4x128 -> 4x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.388513 -1.739395 -0.360643 0.095184 -2.058168 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.040537 0.026280 0.117889 0.115849 0.070910 
[DEBUG] Output projection - shape: 4x1000
[DEBUG] Output range: [-0.222, 0.218]
[DEBUG] Output sample values: -0.041 0.026 0.118 0.116 0.071 
[DEBUG] Forward completed!
ENG: <sos> how are you <eos>
ESP: <sos> diez todas gente <eos>
---
[DEBUG] Forward - source: 4 tokens, target: 1 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 80 237 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-2.471, range=[-0.145, 0.146]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=-2.471203
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-27.958475
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 512/512 non-zero, sum=-2.322348
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.894943 -0.789042 -0.160341 1.107589 -0.800365 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.869416 -1.928920 -0.235271 2.305029 -1.676721 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.869416 -1.928920 -0.235271 2.305029 -1.676721 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.163051, variance=3.048768, stddev=1.746075
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.164020 -1.198099 -0.228124 1.226739 -1.053662 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 510/1024 range: [0.000000, 1.539822]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.619637, 0.757166]
[FEEDFORWARD] Sample values: 0.205012 -0.179338 -0.058684 -0.400226 -0.312344 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.164020 -1.198099 -0.228124 1.226739 -1.053662 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.205012 -0.179338 -0.058684 -0.400226 -0.312344 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.959008 -1.377437 -0.286808 0.826513 -1.366006 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.959008 -1.377437 -0.286808 0.826513 -1.366006 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019139, variance=1.036567, stddev=1.018124
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.960734 -1.371714 -0.300501 0.793001 -1.360487 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.960734 -1.371714 -0.300501 0.793001 -1.360487 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.892808 -0.963354 -0.343960 0.775086 -1.204647 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.853542 -2.335069 -0.644460 1.568087 -2.565134 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.853542 -2.335069 -0.644460 1.568087 -2.565134 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.413433, stddev=1.847551
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.003243 -1.263873 -0.348819 0.848738 -1.388397 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 508/1024 range: [0.000000, 1.581304]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.702210, 0.658317]
[FEEDFORWARD] Sample values: 0.247225 -0.214170 -0.062721 -0.412455 -0.214778 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.003243 -1.263873 -0.348819 0.848738 -1.388397 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.247225 -0.214170 -0.062721 -0.412455 -0.214778 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.756018 -1.478043 -0.411540 0.436283 -1.603175 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.756018 -1.478043 -0.411540 0.436283 -1.603175 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.021852, variance=1.145343, stddev=1.070212
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.726837 -1.401494 -0.404960 0.387242 -1.518417 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.727 -1.401 -0.405 0.387 -1.518 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=0.545, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=0.544836
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=6.164124
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 128/128 non-zero, sum=12.564120
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.726837 -1.401494 -0.404960 0.387242 -1.518417 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.850803 -2.698669 0.331902 1.537277 -2.539733 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.850803 -2.698669 0.331902 1.537277 -2.539733 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.768698, stddev=1.941316
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.953376 -1.390124 0.170967 0.791874 -1.308253 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 128/256 range: [0.000000, 1.622490]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.586771, 0.667529]
[FEEDFORWARD] Sample values: 0.235958 -0.218073 -0.073002 -0.415367 -0.244241 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.953376 -1.390124 0.170967 0.791874 -1.308253 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.235958 -0.218073 -0.073002 -0.415367 -0.244241 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.717417 -1.608197 0.097966 0.376507 -1.552494 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.717417 -1.608197 0.097966 0.376507 -1.552494 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.021850, variance=1.148045, stddev=1.071473
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.689954 -1.521313 0.071039 0.331000 -1.469326 
[DECODER] Layer 0 output: 128/128 non-zero, sum=-0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.689954 -1.521313 0.071039 0.331000 -1.469326 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.689954 -1.521313 0.071039 0.331000 -1.469326 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.379907 -3.042627 0.142077 0.661999 -2.938652 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.379907 -3.042627 0.142077 0.661999 -2.938652 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.689956 -1.521318 0.071039 0.331001 -1.469331 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.689956 -1.521318 0.071039 0.331001 -1.469331 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.726837 -1.401494 -0.404960 0.387242 -1.518417 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.416793 -2.922812 -0.333921 0.718243 -2.987747 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.416793 -2.922812 -0.333921 0.718243 -2.987747 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.994219, stddev=1.998557
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.708908 -1.462461 -0.167081 0.359381 -1.494952 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 130/256 range: [0.000000, 1.690388]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.621973, 0.649971]
[FEEDFORWARD] Sample values: 0.249021 -0.235190 -0.084175 -0.398100 -0.168077 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.708908 -1.462461 -0.167081 0.359381 -1.494952 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.249021 -0.235190 -0.084175 -0.398100 -0.168077 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.459888 -1.697651 -0.251256 -0.038719 -1.663030 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.459888 -1.697651 -0.251256 -0.038719 -1.663030 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.020302, variance=1.244333, stddev=1.115501
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.430470 -1.540073 -0.243441 -0.052910 -1.509036 
[DECODER] Layer 1 output: 128/128 non-zero, sum=0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.430 -1.540 -0.243 -0.053 -1.509 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.430470 -1.540073 -0.243441 -0.052910 -1.509036 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.035261 0.018339 0.106105 0.111203 0.066965 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-0.176, 0.183]
[DEBUG] Output sample values: -0.035 0.018 0.106 0.111 0.067 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 900 (score: 0.2, target_len: 3) [Top scores: 293:0.2 900:0.2 148:0.2 213:0.2 161:0.2 ]
[DEBUG] Forward - source: 4 tokens, target: 2 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 80 237 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-2.5, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=-2.471203
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-27.958475
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 512/512 non-zero, sum=-2.322348
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.894943 -0.789042 -0.160341 1.107589 -0.800365 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.869416 -1.928920 -0.235271 2.305029 -1.676721 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.869416 -1.928920 -0.235271 2.305029 -1.676721 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.163051, variance=3.048768, stddev=1.746075
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.164020 -1.198099 -0.228124 1.226739 -1.053662 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 510/1024 range: [0.000000, 1.539822]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.619637, 0.757166]
[FEEDFORWARD] Sample values: 0.205012 -0.179338 -0.058684 -0.400226 -0.312344 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.164020 -1.198099 -0.228124 1.226739 -1.053662 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.205012 -0.179338 -0.058684 -0.400226 -0.312344 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.959008 -1.377437 -0.286808 0.826513 -1.366006 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.959008 -1.377437 -0.286808 0.826513 -1.366006 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019139, variance=1.036567, stddev=1.018124
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.960734 -1.371714 -0.300501 0.793001 -1.360487 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.960734 -1.371714 -0.300501 0.793001 -1.360487 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.892808 -0.963354 -0.343960 0.775086 -1.204647 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.853542 -2.335069 -0.644460 1.568087 -2.565134 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.853542 -2.335069 -0.644460 1.568087 -2.565134 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.413433, stddev=1.847551
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.003243 -1.263873 -0.348819 0.848738 -1.388397 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 508/1024 range: [0.000000, 1.581304]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.702210, 0.658317]
[FEEDFORWARD] Sample values: 0.247225 -0.214170 -0.062721 -0.412455 -0.214778 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.003243 -1.263873 -0.348819 0.848738 -1.388397 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.247225 -0.214170 -0.062721 -0.412455 -0.214778 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.756018 -1.478043 -0.411540 0.436283 -1.603175 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.756018 -1.478043 -0.411540 0.436283 -1.603175 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.021852, variance=1.145343, stddev=1.070212
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.726837 -1.401494 -0.404960 0.387242 -1.518417 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.727 -1.401 -0.405 0.387 -1.518 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 900 
[EMBEDDING] Stats: 256/256 non-zero values, sum=0.282, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=0.282293
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=3.193779
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 256/256 non-zero, sum=15.999798
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.742827 -1.276700 -0.388709 0.314682 -1.403495 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.866793 -2.573876 0.348152 1.464717 -2.424812 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.866793 -2.573876 0.348152 1.464717 -2.424812 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.618210, stddev=1.902162
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.981406 -1.353132 0.183030 0.770028 -1.274766 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 246/512 range: [0.000000, 1.614335]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.589118, 0.671829]
[FEEDFORWARD] Sample values: 0.233757 -0.209136 -0.083620 -0.416288 -0.240944 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.981406 -1.353132 0.183030 0.770028 -1.274766 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.233757 -0.209136 -0.083620 -0.416288 -0.240944 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.747649 -1.562268 0.099410 0.353740 -1.515710 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.747649 -1.562268 0.099410 0.353740 -1.515710 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.022553, variance=1.147355, stddev=1.071151
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.719040 -1.479549 0.071752 0.309188 -1.436083 
[DECODER] Layer 0 output: 256/256 non-zero, sum=-0.000005
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.719040 -1.479549 0.071752 0.309188 -1.436083 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.719040 -1.479549 0.071752 0.309188 -1.436083 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.438081 -2.959098 0.143504 0.618376 -2.872166 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.438081 -2.959098 0.143504 0.618376 -2.872166 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999964, stddev=1.999993
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.719043 -1.479554 0.071752 0.309189 -1.436088 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.719043 -1.479554 0.071752 0.309189 -1.436088 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.748540 -1.232117 -0.382903 0.288759 -1.362439 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.467582 -2.711670 -0.311151 0.597948 -2.798526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.467582 -2.711670 -0.311151 0.597948 -2.798526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.790735, stddev=1.946984
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.753772 -1.392755 -0.159812 0.307115 -1.437365 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 249/512 range: [0.000000, 1.676340]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.627077, 0.664323]
[FEEDFORWARD] Sample values: 0.246515 -0.224699 -0.106237 -0.398161 -0.159663 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.753772 -1.392755 -0.159812 0.307115 -1.437365 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.246515 -0.224699 -0.106237 -0.398161 -0.159663 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.507257 -1.617454 -0.266048 -0.091046 -1.597028 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.507257 -1.617454 -0.266048 -0.091046 -1.597028 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.021226, variance=1.246679, stddev=1.116552
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.473317 -1.467625 -0.257287 -0.100553 -1.449331 
[DECODER] Layer 1 output: 256/256 non-zero, sum=-0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.473 -1.468 -0.257 -0.101 -1.449 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.473317 -1.467625 -0.257287 -0.100553 -1.449331 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.036903 0.021060 0.103011 0.110140 0.065576 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-0.178, 0.181]
[DEBUG] Output sample values: -0.037 0.021 0.103 0.110 0.066 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 51 (score: 0.2, target_len: 3) [Top scores: 51:0.2 148:0.2 189:0.2 531:0.1 878:0.1 ]
[DEBUG] Forward - source: 4 tokens, target: 3 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 80 237 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-2.5, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=-2.471203
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-27.958475
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 512/512 non-zero, sum=-2.322348
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.894943 -0.789042 -0.160341 1.107589 -0.800365 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.869416 -1.928920 -0.235271 2.305029 -1.676721 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.869416 -1.928920 -0.235271 2.305029 -1.676721 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.163051, variance=3.048768, stddev=1.746075
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.164020 -1.198099 -0.228124 1.226739 -1.053662 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 510/1024 range: [0.000000, 1.539822]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.619637, 0.757166]
[FEEDFORWARD] Sample values: 0.205012 -0.179338 -0.058684 -0.400226 -0.312344 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.164020 -1.198099 -0.228124 1.226739 -1.053662 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.205012 -0.179338 -0.058684 -0.400226 -0.312344 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.959008 -1.377437 -0.286808 0.826513 -1.366006 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.959008 -1.377437 -0.286808 0.826513 -1.366006 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019139, variance=1.036567, stddev=1.018124
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.960734 -1.371714 -0.300501 0.793001 -1.360487 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.960734 -1.371714 -0.300501 0.793001 -1.360487 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.892808 -0.963354 -0.343960 0.775086 -1.204647 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.853542 -2.335069 -0.644460 1.568087 -2.565134 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.853542 -2.335069 -0.644460 1.568087 -2.565134 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.413433, stddev=1.847551
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.003243 -1.263873 -0.348819 0.848738 -1.388397 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 508/1024 range: [0.000000, 1.581304]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.702210, 0.658317]
[FEEDFORWARD] Sample values: 0.247225 -0.214170 -0.062721 -0.412455 -0.214778 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.003243 -1.263873 -0.348819 0.848738 -1.388397 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.247225 -0.214170 -0.062721 -0.412455 -0.214778 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.756018 -1.478043 -0.411540 0.436283 -1.603175 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.756018 -1.478043 -0.411540 0.436283 -1.603175 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.021852, variance=1.145343, stddev=1.070212
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.726837 -1.401494 -0.404960 0.387242 -1.518417 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.727 -1.401 -0.405 0.387 -1.518 
[DECODER] Starting decode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 900 51 
[EMBEDDING] Stats: 384/384 non-zero values, sum=1.180, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 384/384 non-zero, sum=1.180437
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[DECODER] SCALED EMBEDS before add: 384/384 non-zero, sum=13.355117
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 384/384 non-zero, sum=32.573181
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.727417 -1.040303 -0.440030 0.437078 -1.321829 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.851383 -2.337478 0.296832 1.587113 -2.343145 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.851383 -2.337478 0.296832 1.587113 -2.343145 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.295896, stddev=1.815463
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.019786 -1.287538 0.163502 0.874219 -1.290660 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 363/768 range: [0.000000, 1.649037]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.602946, 0.686825]
[FEEDFORWARD] Sample values: 0.234475 -0.192315 -0.070648 -0.397036 -0.240707 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.019786 -1.287538 0.163502 0.874219 -1.290660 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.234475 -0.192315 -0.070648 -0.397036 -0.240707 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.785311 -1.479853 0.092854 0.477183 -1.531367 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.785311 -1.479853 0.092854 0.477183 -1.531367 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.023054, variance=1.139789, stddev=1.067613
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.757170 -1.407726 0.065379 0.425368 -1.455978 
[DECODER] Layer 0 output: 384/384 non-zero, sum=0.000007
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.757170 -1.407726 0.065379 0.425368 -1.455978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.757170 -1.407726 0.065379 0.425368 -1.455978 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.514341 -2.815453 0.130758 0.850736 -2.911956 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.514341 -2.815453 0.130758 0.850736 -2.911956 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.757173 -1.407731 0.065379 0.425369 -1.455982 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.757173 -1.407731 0.065379 0.425369 -1.455982 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.731326 -0.981320 -0.438904 0.423528 -1.278373 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.488499 -2.389051 -0.373525 0.848898 -2.734355 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.488499 -2.389051 -0.373525 0.848898 -2.734355 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.459994, stddev=1.860109
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.800221 -1.284361 -0.200808 0.456370 -1.469998 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 358/768 range: [0.000000, 1.611296]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.641126, 0.679074]
[FEEDFORWARD] Sample values: 0.262947 -0.196803 -0.074318 -0.369239 -0.156995 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.800221 -1.284361 -0.200808 0.456370 -1.469998 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.262947 -0.196803 -0.074318 -0.369239 -0.156995 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.537274 -1.481164 -0.275126 0.087131 -1.626993 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.537274 -1.481164 -0.275126 0.087131 -1.626993 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.022370, variance=1.239248, stddev=1.113219
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.502726 -1.350617 -0.267239 0.058175 -1.481615 
[DECODER] Layer 1 output: 384/384 non-zero, sum=-0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 3x128
[DEBUG] Decoder sample values: -0.503 -1.351 -0.267 0.058 -1.482 
[LINEAR] Forward 3x128 -> 3x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.502726 -1.350617 -0.267239 0.058175 -1.481615 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.034235 0.026073 0.101355 0.095903 0.070093 
[DEBUG] Output projection - shape: 3x1000
[DEBUG] Output range: [-0.207, 0.179]
[DEBUG] Output sample values: -0.034 0.026 0.101 0.096 0.070 
[DEBUG] Forward completed!
[GEN] Step 2 - Best token: 3 (score: 5.0, target_len: 3) [Top scores: 3:5.0 878:0.2 112:0.2 724:0.2 68:0.2 ]
ENG: <sos> good morning <eos>
ESP: <sos> europa son <eos>
---
[DEBUG] Forward - source: 4 tokens, target: 1 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 446 7 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-1.9, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=-1.862694
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-21.073961
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 512/512 non-zero, sum=4.562180
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.806573 -1.026694 -0.163387 0.960428 -0.847640 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.781046 -2.166572 -0.238316 2.157867 -1.723997 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.781046 -2.166572 -0.238316 2.157867 -1.723997 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.170620, variance=3.167235, stddev=1.779675
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.096642 -1.313269 -0.229781 1.116635 -1.064585 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 536/1024 range: [0.000000, 1.469615]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.710681, 0.753044]
[FEEDFORWARD] Sample values: 0.189144 -0.196103 -0.047647 -0.400843 -0.330460 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.096642 -1.313269 -0.229781 1.116635 -1.064585 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.189144 -0.196103 -0.047647 -0.400843 -0.330460 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.907498 -1.509372 -0.277428 0.715792 -1.395046 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.907498 -1.509372 -0.277428 0.715792 -1.395046 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017309, variance=1.039540, stddev=1.019583
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.907044 -1.497358 -0.289076 0.685067 -1.385228 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=-0.000005
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.907044 -1.497358 -0.289076 0.685067 -1.385228 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.733141 -1.328825 -0.374978 0.477867 -1.310517 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.640185 -2.826183 -0.664054 1.162934 -2.695744 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.640185 -2.826183 -0.664054 1.162934 -2.695744 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.484825, stddev=1.866771
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.878621 -1.513942 -0.355723 0.622965 -1.444068 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 541/1024 range: [0.000000, 1.718097]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.716499, 0.633714]
[FEEDFORWARD] Sample values: 0.211954 -0.250222 -0.049354 -0.428186 -0.248195 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.878621 -1.513942 -0.355723 0.622965 -1.444068 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.211954 -0.250222 -0.049354 -0.428186 -0.248195 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.666667 -1.764164 -0.405078 0.194779 -1.692263 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.666667 -1.764164 -0.405078 0.194779 -1.692263 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017241, variance=1.150755, stddev=1.072737
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.637536 -1.660617 -0.393684 0.165500 -1.593591 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=0.000003
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.638 -1.661 -0.394 0.166 -1.594 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=0.545, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=0.544836
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=6.164124
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 128/128 non-zero, sum=12.564120
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.637536 -1.660617 -0.393684 0.165500 -1.593591 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.761502 -2.957792 0.343177 1.315535 -2.614907 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.761502 -2.957792 0.343177 1.315535 -2.614907 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.770167, stddev=1.941694
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.907198 -1.523305 0.176741 0.677519 -1.346714 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 129/256 range: [0.000000, 1.676973]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.567294, 0.651314]
[FEEDFORWARD] Sample values: 0.208991 -0.231356 -0.068829 -0.425301 -0.263375 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.907198 -1.523305 0.176741 0.677519 -1.346714 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.208991 -0.231356 -0.068829 -0.425301 -0.263375 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.698207 -1.754661 0.107913 0.252218 -1.610089 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.698207 -1.754661 0.107913 0.252218 -1.610089 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018959, variance=1.150753, stddev=1.072736
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.668539 -1.653360 0.082922 0.217443 -1.518591 
[DECODER] Layer 0 output: 128/128 non-zero, sum=0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.668539 -1.653360 0.082922 0.217443 -1.518591 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.668539 -1.653360 0.082922 0.217443 -1.518591 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.337079 -3.306720 0.165844 0.434886 -3.037183 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.337079 -3.306720 0.165844 0.434886 -3.037183 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.668541 -1.653365 0.082922 0.217444 -1.518596 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.668541 -1.653365 0.082922 0.217444 -1.518596 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.637536 -1.660617 -0.393684 0.165500 -1.593591 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.306077 -3.313982 -0.310761 0.382944 -3.112187 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.306077 -3.313982 -0.310761 0.382944 -3.112187 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.995692, stddev=1.998925
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.653390 -1.657882 -0.155464 0.191575 -1.556930 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 132/256 range: [0.000000, 1.763925]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.641804, 0.619877]
[FEEDFORWARD] Sample values: 0.199292 -0.252941 -0.086009 -0.411780 -0.193792 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.653390 -1.657882 -0.155464 0.191575 -1.556930 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.199292 -0.252941 -0.086009 -0.411780 -0.193792 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.454098 -1.910823 -0.241473 -0.220205 -1.750722 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.454098 -1.910823 -0.241473 -0.220205 -1.750722 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.015898, variance=1.247261, stddev=1.116813
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.420837 -1.725196 -0.230452 -0.211409 -1.581841 
[DECODER] Layer 1 output: 128/128 non-zero, sum=0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.421 -1.725 -0.230 -0.211 -1.582 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.420837 -1.725196 -0.230452 -0.211409 -1.581841 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.035691 0.016838 0.109224 0.120767 0.067866 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-0.179, 0.184]
[DEBUG] Output sample values: -0.036 0.017 0.109 0.121 0.068 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 293 (score: 0.2, target_len: 3) [Top scores: 293:0.2 900:0.2 148:0.2 213:0.2 161:0.2 ]
[DEBUG] Forward - source: 4 tokens, target: 2 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 446 7 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-1.9, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=-1.862694
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-21.073961
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 512/512 non-zero, sum=4.562180
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.806573 -1.026694 -0.163387 0.960428 -0.847640 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.781046 -2.166572 -0.238316 2.157867 -1.723997 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.781046 -2.166572 -0.238316 2.157867 -1.723997 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.170620, variance=3.167235, stddev=1.779675
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.096642 -1.313269 -0.229781 1.116635 -1.064585 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 536/1024 range: [0.000000, 1.469615]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.710681, 0.753044]
[FEEDFORWARD] Sample values: 0.189144 -0.196103 -0.047647 -0.400843 -0.330460 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.096642 -1.313269 -0.229781 1.116635 -1.064585 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.189144 -0.196103 -0.047647 -0.400843 -0.330460 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.907498 -1.509372 -0.277428 0.715792 -1.395046 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.907498 -1.509372 -0.277428 0.715792 -1.395046 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017309, variance=1.039540, stddev=1.019583
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.907044 -1.497358 -0.289076 0.685067 -1.385228 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=-0.000005
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.907044 -1.497358 -0.289076 0.685067 -1.385228 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.733141 -1.328825 -0.374978 0.477867 -1.310517 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.640185 -2.826183 -0.664054 1.162934 -2.695744 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.640185 -2.826183 -0.664054 1.162934 -2.695744 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.484825, stddev=1.866771
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.878621 -1.513942 -0.355723 0.622965 -1.444068 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 541/1024 range: [0.000000, 1.718097]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.716499, 0.633714]
[FEEDFORWARD] Sample values: 0.211954 -0.250222 -0.049354 -0.428186 -0.248195 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.878621 -1.513942 -0.355723 0.622965 -1.444068 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.211954 -0.250222 -0.049354 -0.428186 -0.248195 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.666667 -1.764164 -0.405078 0.194779 -1.692263 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.666667 -1.764164 -0.405078 0.194779 -1.692263 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017241, variance=1.150755, stddev=1.072737
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.637536 -1.660617 -0.393684 0.165500 -1.593591 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=0.000003
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.638 -1.661 -0.394 0.166 -1.594 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 293 
[EMBEDDING] Stats: 256/256 non-zero values, sum=0.923, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=0.923086
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=10.443524
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 256/256 non-zero, sum=23.249554
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.545816 -1.646655 -0.414964 0.044873 -1.478261 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.669782 -2.943831 0.321897 1.194908 -2.499578 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.669782 -2.943831 0.321897 1.194908 -2.499578 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.566969, stddev=1.888645
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.884116 -1.558700 0.170438 0.632680 -1.323477 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 271/512 range: [0.000000, 1.698022]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.581734, 0.660437]
[FEEDFORWARD] Sample values: 0.199847 -0.234000 -0.063731 -0.423871 -0.261517 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.884116 -1.558700 0.170438 0.632680 -1.323477 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.199847 -0.234000 -0.063731 -0.423871 -0.261517 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.684269 -1.792700 0.106707 0.208809 -1.584994 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.684269 -1.792700 0.106707 0.208809 -1.584994 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018644, variance=1.151157, stddev=1.072925
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.655137 -1.688230 0.082078 0.177240 -1.494641 
[DECODER] Layer 0 output: 256/256 non-zero, sum=-0.000000
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.655137 -1.688230 0.082078 0.177240 -1.494641 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.655137 -1.688230 0.082078 0.177240 -1.494641 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.310275 -3.376460 0.164155 0.354480 -2.989283 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.310275 -3.376460 0.164155 0.354480 -2.989283 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.655139 -1.688235 0.082078 0.177241 -1.494646 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.655139 -1.688235 0.082078 0.177241 -1.494646 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.518997 -1.642573 -0.421187 0.009601 -1.444539 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.174137 -3.330808 -0.339109 0.186842 -2.939185 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.174137 -3.330808 -0.339109 0.186842 -2.939185 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.745577, stddev=1.935352
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.606679 -1.721035 -0.175218 0.096542 -1.518682 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 273/512 range: [0.000000, 1.815937]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.649838, 0.657579]
[FEEDFORWARD] Sample values: 0.184268 -0.254677 -0.079840 -0.407288 -0.180602 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.606679 -1.721035 -0.175218 0.096542 -1.518682 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.184268 -0.254677 -0.079840 -0.407288 -0.180602 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.422411 -1.975712 -0.255058 -0.310747 -1.699284 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.422411 -1.975712 -0.255058 -0.310747 -1.699284 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.015856, variance=1.250866, stddev=1.118426
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.391861 -1.780689 -0.242229 -0.292021 -1.533531 
[DECODER] Layer 1 output: 256/256 non-zero, sum=-0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.392 -1.781 -0.242 -0.292 -1.534 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.391861 -1.780689 -0.242229 -0.292021 -1.533531 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.031745 0.022356 0.108543 0.117564 0.071553 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-0.280, 0.183]
[DEBUG] Output sample values: -0.032 0.022 0.109 0.118 0.072 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 559 (score: 0.2, target_len: 3) [Top scores: 559:0.2 148:0.2 918:0.1 252:0.1 531:0.1 ]
[DEBUG] Forward - source: 4 tokens, target: 3 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 446 7 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-1.9, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=-1.862694
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-21.073961
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 512/512 non-zero, sum=4.562180
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.806573 -1.026694 -0.163387 0.960428 -0.847640 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.781046 -2.166572 -0.238316 2.157867 -1.723997 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.781046 -2.166572 -0.238316 2.157867 -1.723997 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.170620, variance=3.167235, stddev=1.779675
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.096642 -1.313269 -0.229781 1.116635 -1.064585 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 536/1024 range: [0.000000, 1.469615]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.710681, 0.753044]
[FEEDFORWARD] Sample values: 0.189144 -0.196103 -0.047647 -0.400843 -0.330460 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.096642 -1.313269 -0.229781 1.116635 -1.064585 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.189144 -0.196103 -0.047647 -0.400843 -0.330460 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.907498 -1.509372 -0.277428 0.715792 -1.395046 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.907498 -1.509372 -0.277428 0.715792 -1.395046 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017309, variance=1.039540, stddev=1.019583
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.907044 -1.497358 -0.289076 0.685067 -1.385228 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=-0.000005
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.907044 -1.497358 -0.289076 0.685067 -1.385228 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.733141 -1.328825 -0.374978 0.477867 -1.310517 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.640185 -2.826183 -0.664054 1.162934 -2.695744 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.640185 -2.826183 -0.664054 1.162934 -2.695744 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.484825, stddev=1.866771
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.878621 -1.513942 -0.355723 0.622965 -1.444068 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 541/1024 range: [0.000000, 1.718097]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.716499, 0.633714]
[FEEDFORWARD] Sample values: 0.211954 -0.250222 -0.049354 -0.428186 -0.248195 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.878621 -1.513942 -0.355723 0.622965 -1.444068 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.211954 -0.250222 -0.049354 -0.428186 -0.248195 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.666667 -1.764164 -0.405078 0.194779 -1.692263 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.666667 -1.764164 -0.405078 0.194779 -1.692263 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017241, variance=1.150755, stddev=1.072737
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.637536 -1.660617 -0.393684 0.165500 -1.593591 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=0.000003
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.638 -1.661 -0.394 0.166 -1.594 
[DECODER] Starting decode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 293 559 
[EMBEDDING] Stats: 384/384 non-zero values, sum=0.524, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 384/384 non-zero, sum=0.523820
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[DECODER] SCALED EMBEDS before add: 384/384 non-zero, sum=5.926345
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 384/384 non-zero, sum=25.144405
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.537448 -1.561489 -0.477734 0.004751 -1.487367 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.661414 -2.858664 0.259128 1.154786 -2.508684 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.661414 -2.858664 0.259128 1.154786 -2.508684 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.387603, stddev=1.840547
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.902674 -1.553160 0.140788 0.627415 -1.363010 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 392/768 range: [0.000000, 1.705790]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.853780, 0.808473]
[FEEDFORWARD] Sample values: 0.187172 -0.223647 -0.061226 -0.415020 -0.272755 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.902674 -1.553160 0.140788 0.627415 -1.363010 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.187172 -0.223647 -0.061226 -0.415020 -0.272755 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.715502 -1.776807 0.079562 0.212395 -1.635765 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.715502 -1.776807 0.079562 0.212395 -1.635765 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018121, variance=1.145929, stddev=1.070485
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.685318 -1.676743 0.057395 0.181482 -1.544987 
[DECODER] Layer 0 output: 384/384 non-zero, sum=0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.685318 -1.676743 0.057395 0.181482 -1.544987 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.685318 -1.676743 0.057395 0.181482 -1.544987 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.370636 -3.353485 0.114791 0.362964 -3.089974 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.370636 -3.353485 0.114791 0.362964 -3.089974 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999964, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.685320 -1.676748 0.057396 0.181482 -1.544992 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.685320 -1.676748 0.057396 0.181482 -1.544992 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.509388 -1.530624 -0.503526 -0.041382 -1.458307 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.194708 -3.207372 -0.446131 0.140100 -3.003299 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.194708 -3.207372 -0.446131 0.140100 -3.003299 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.507674, stddev=1.872881
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.637899 -1.712533 -0.238206 0.074805 -1.603571 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 395/768 range: [0.000000, 1.815465]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.839507, 0.789569]
[FEEDFORWARD] Sample values: 0.165105 -0.246092 -0.066546 -0.389057 -0.193402 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.637899 -1.712533 -0.238206 0.074805 -1.603571 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.165105 -0.246092 -0.066546 -0.389057 -0.193402 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.472794 -1.958625 -0.304751 -0.314252 -1.796974 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.472794 -1.958625 -0.304751 -0.314252 -1.796974 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.014623, variance=1.245538, stddev=1.116041
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.436737 -1.768078 -0.286167 -0.294680 -1.623235 
[DECODER] Layer 1 output: 384/384 non-zero, sum=-0.000004
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 3x128
[DEBUG] Decoder sample values: -0.437 -1.768 -0.286 -0.295 -1.623 
[LINEAR] Forward 3x128 -> 3x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.436737 -1.768078 -0.286167 -0.294680 -1.623235 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.034811 0.022564 0.110236 0.115131 0.075070 
[DEBUG] Output projection - shape: 3x1000
[DEBUG] Output range: [-0.246, 0.192]
[DEBUG] Output sample values: -0.035 0.023 0.110 0.115 0.075 
[DEBUG] Forward completed!
[GEN] Step 2 - Best token: 3 (score: 5.1, target_len: 3) [Top scores: 3:5.1 148:0.2 189:0.2 161:0.2 712:0.2 ]
ENG: <sos> thank you <eos>
ESP: <sos> diez calor <eos>
---
[DEBUG] Forward - source: 5 tokens, target: 1 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 5 107 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=-2.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=-2.056851
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=-23.270590
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 640/640 non-zero, sum=8.789579
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.944240 -0.556404 -0.190013 0.789609 -0.796906 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.918714 -1.696282 -0.264943 1.987049 -1.673263 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.918714 -1.696282 -0.264943 1.987049 -1.673263 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.165234, variance=2.797215, stddev=1.672491
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.246014 -1.113020 -0.257207 1.089282 -1.099257 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 641/1280 range: [0.000000, 1.451810]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.625124, 0.748166]
[FEEDFORWARD] Sample values: 0.181962 -0.218421 -0.059040 -0.411015 -0.318923 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.246014 -1.113020 -0.257207 1.089282 -1.099257 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.181962 -0.218421 -0.059040 -0.411015 -0.318923 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.064053 -1.331441 -0.316247 0.678268 -1.418180 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.064053 -1.331441 -0.316247 0.678268 -1.418180 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017554, variance=1.037647, stddev=1.018655
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.061799 -1.324291 -0.327688 0.648615 -1.409440 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.061799 -1.324291 -0.327688 0.648615 -1.409440 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -1.044159 -0.744668 -0.425512 0.387091 -1.265814 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.105958 -2.068958 -0.753200 1.035705 -2.675254 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.105958 -2.068958 -0.753200 1.035705 -2.675254 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.201019, stddev=1.789142
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.177077 -1.156397 -0.420984 0.578884 -1.495272 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 641/1280 range: [0.000000, 1.558598]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.607596, 0.665292]
[FEEDFORWARD] Sample values: 0.201681 -0.291269 -0.064185 -0.427419 -0.241699 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.177077 -1.156397 -0.420984 0.578884 -1.495272 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.201681 -0.291269 -0.064185 -0.427419 -0.241699 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975396 -1.447666 -0.485169 0.151464 -1.736971 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.975396 -1.447666 -0.485169 0.151464 -1.736971 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018561, variance=1.142411, stddev=1.068841
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.929939 -1.371791 -0.471286 0.124344 -1.642463 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.930 -1.372 -0.471 0.124 -1.642 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=0.545, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=0.544836
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=6.164124
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 128/128 non-zero, sum=12.564120
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.929939 -1.371791 -0.471286 0.124344 -1.642463 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.053905 -2.668967 0.265575 1.274379 -2.663780 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.053905 -2.668967 0.265575 1.274379 -2.663780 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.772403, stddev=1.942270
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.057476 -1.374148 0.136734 0.656129 -1.371477 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 128/256 range: [0.000000, 1.608066]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.576159, 0.652907]
[FEEDFORWARD] Sample values: 0.203790 -0.253090 -0.076627 -0.424420 -0.255598 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.057476 -1.374148 0.136734 0.656129 -1.371477 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.203790 -0.253090 -0.076627 -0.424420 -0.255598 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.853687 -1.627238 0.060108 0.231709 -1.627075 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.853687 -1.627238 0.060108 0.231709 -1.627075 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019453, variance=1.145784, stddev=1.070418
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.815700 -1.538363 0.037980 0.198293 -1.538211 
[DECODER] Layer 0 output: 128/128 non-zero, sum=-0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.815700 -1.538363 0.037980 0.198293 -1.538211 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.815700 -1.538363 0.037980 0.198293 -1.538211 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.631400 -3.076726 0.075960 0.396586 -3.076422 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.631400 -3.076726 0.075960 0.396586 -3.076422 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.815702 -1.538368 0.037980 0.198293 -1.538216 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.815702 -1.538368 0.037980 0.198293 -1.538216 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.929939 -1.371791 -0.471286 0.124344 -1.642463 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.745641 -2.910160 -0.433306 0.322637 -3.180679 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.745641 -2.910160 -0.433306 0.322637 -3.180679 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.991554, stddev=1.997890
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.873742 -1.456617 -0.216882 0.161489 -1.592019 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 129/256 range: [0.000000, 1.668514]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.653008, 0.619182]
[FEEDFORWARD] Sample values: 0.188622 -0.276137 -0.088450 -0.417787 -0.192517 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.873742 -1.456617 -0.216882 0.161489 -1.592019 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.188622 -0.276137 -0.088450 -0.417787 -0.192517 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.685121 -1.732754 -0.305332 -0.256298 -1.784536 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.685121 -1.732754 -0.305332 -0.256298 -1.784536 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.016615, variance=1.240475, stddev=1.113771
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.630054 -1.570672 -0.289060 -0.245035 -1.617165 
[DECODER] Layer 1 output: 128/128 non-zero, sum=-0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.630 -1.571 -0.289 -0.245 -1.617 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.630054 -1.570672 -0.289060 -0.245035 -1.617165 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.048948 0.012203 0.102194 0.113856 0.057577 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-0.166, 0.188]
[DEBUG] Output sample values: -0.049 0.012 0.102 0.114 0.058 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 293 (score: 0.2, target_len: 4) [Top scores: 293:0.2 900:0.2 148:0.2 213:0.2 161:0.2 ]
[DEBUG] Forward - source: 5 tokens, target: 2 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 5 107 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=-2.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=-2.056851
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=-23.270590
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 640/640 non-zero, sum=8.789579
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.944240 -0.556404 -0.190013 0.789609 -0.796906 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.918714 -1.696282 -0.264943 1.987049 -1.673263 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.918714 -1.696282 -0.264943 1.987049 -1.673263 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.165234, variance=2.797215, stddev=1.672491
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.246014 -1.113020 -0.257207 1.089282 -1.099257 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 641/1280 range: [0.000000, 1.451810]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.625124, 0.748166]
[FEEDFORWARD] Sample values: 0.181962 -0.218421 -0.059040 -0.411015 -0.318923 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.246014 -1.113020 -0.257207 1.089282 -1.099257 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.181962 -0.218421 -0.059040 -0.411015 -0.318923 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.064053 -1.331441 -0.316247 0.678268 -1.418180 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.064053 -1.331441 -0.316247 0.678268 -1.418180 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017554, variance=1.037647, stddev=1.018655
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.061799 -1.324291 -0.327688 0.648615 -1.409440 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.061799 -1.324291 -0.327688 0.648615 -1.409440 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -1.044159 -0.744668 -0.425512 0.387091 -1.265814 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.105958 -2.068958 -0.753200 1.035705 -2.675254 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.105958 -2.068958 -0.753200 1.035705 -2.675254 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.201019, stddev=1.789142
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.177077 -1.156397 -0.420984 0.578884 -1.495272 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 641/1280 range: [0.000000, 1.558598]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.607596, 0.665292]
[FEEDFORWARD] Sample values: 0.201681 -0.291269 -0.064185 -0.427419 -0.241699 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.177077 -1.156397 -0.420984 0.578884 -1.495272 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.201681 -0.291269 -0.064185 -0.427419 -0.241699 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975396 -1.447666 -0.485169 0.151464 -1.736971 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.975396 -1.447666 -0.485169 0.151464 -1.736971 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018561, variance=1.142411, stddev=1.068841
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.929939 -1.371791 -0.471286 0.124344 -1.642463 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.930 -1.372 -0.471 0.124 -1.642 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 293 
[EMBEDDING] Stats: 256/256 non-zero values, sum=0.923, range=[-0.144, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=0.923086
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=10.443524
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 256/256 non-zero, sum=23.249554
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.979128 -1.040175 -0.573045 0.016745 -1.445499 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.103094 -2.337350 0.163816 1.166780 -2.466815 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.103094 -2.337350 0.163816 1.166780 -2.466815 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.406013, stddev=1.845541
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.139554 -1.266485 0.088763 0.632216 -1.336635 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 258/512 range: [0.000000, 1.551915]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.569389, 0.684637]
[FEEDFORWARD] Sample values: 0.201990 -0.265140 -0.090925 -0.424573 -0.246412 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.139554 -1.266485 0.088763 0.632216 -1.336635 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.201990 -0.265140 -0.090925 -0.424573 -0.246412 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.937564 -1.531625 -0.002162 0.207642 -1.583047 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.937564 -1.531625 -0.002162 0.207642 -1.583047 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.020265, variance=1.138186, stddev=1.066863
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.897799 -1.454630 -0.021022 0.175634 -1.502829 
[DECODER] Layer 0 output: 256/256 non-zero, sum=-0.000003
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.897799 -1.454630 -0.021022 0.175634 -1.502829 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.897799 -1.454630 -0.021022 0.175634 -1.502829 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.795598 -2.909259 -0.042043 0.351268 -3.005657 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.795598 -2.909259 -0.042043 0.351268 -3.005657 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999964, stddev=1.999993
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.897802 -1.454634 -0.021022 0.175635 -1.502834 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.897802 -1.454634 -0.021022 0.175635 -1.502834 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.978917 -1.041599 -0.572608 0.017207 -1.446345 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.876719 -2.496233 -0.593630 0.192842 -2.949179 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.876719 -2.496233 -0.593630 0.192842 -2.949179 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.629118, stddev=1.905027
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.985140 -1.310340 -0.311612 0.101228 -1.548103 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 244/512 range: [0.000000, 1.594143]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.639829, 0.629765]
[FEEDFORWARD] Sample values: 0.181511 -0.295274 -0.098080 -0.420327 -0.179718 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.985140 -1.310340 -0.311612 0.101228 -1.548103 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.181511 -0.295274 -0.098080 -0.420327 -0.179718 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.803629 -1.605614 -0.409692 -0.319099 -1.727822 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.803629 -1.605614 -0.409692 -0.319099 -1.727822 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017870, variance=1.237027, stddev=1.112222
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.738611 -1.459677 -0.384422 -0.302970 -1.569554 
[DECODER] Layer 1 output: 256/256 non-zero, sum=-0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.739 -1.460 -0.384 -0.303 -1.570 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.738611 -1.459677 -0.384422 -0.302970 -1.569554 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.056416 0.014017 0.093634 0.102170 0.053031 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-0.181, 0.189]
[DEBUG] Output sample values: -0.056 0.014 0.094 0.102 0.053 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 411 (score: 0.2, target_len: 4) [Top scores: 411:0.2 154:0.2 528:0.2 329:0.1 572:0.1 ]
[DEBUG] Forward - source: 5 tokens, target: 3 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 5 107 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=-2.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=-2.056851
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=-23.270590
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 640/640 non-zero, sum=8.789579
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.944240 -0.556404 -0.190013 0.789609 -0.796906 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.918714 -1.696282 -0.264943 1.987049 -1.673263 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.918714 -1.696282 -0.264943 1.987049 -1.673263 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.165234, variance=2.797215, stddev=1.672491
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.246014 -1.113020 -0.257207 1.089282 -1.099257 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 641/1280 range: [0.000000, 1.451810]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.625124, 0.748166]
[FEEDFORWARD] Sample values: 0.181962 -0.218421 -0.059040 -0.411015 -0.318923 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.246014 -1.113020 -0.257207 1.089282 -1.099257 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.181962 -0.218421 -0.059040 -0.411015 -0.318923 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.064053 -1.331441 -0.316247 0.678268 -1.418180 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.064053 -1.331441 -0.316247 0.678268 -1.418180 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017554, variance=1.037647, stddev=1.018655
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.061799 -1.324291 -0.327688 0.648615 -1.409440 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.061799 -1.324291 -0.327688 0.648615 -1.409440 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -1.044159 -0.744668 -0.425512 0.387091 -1.265814 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.105958 -2.068958 -0.753200 1.035705 -2.675254 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.105958 -2.068958 -0.753200 1.035705 -2.675254 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.201019, stddev=1.789142
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.177077 -1.156397 -0.420984 0.578884 -1.495272 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 641/1280 range: [0.000000, 1.558598]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.607596, 0.665292]
[FEEDFORWARD] Sample values: 0.201681 -0.291269 -0.064185 -0.427419 -0.241699 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.177077 -1.156397 -0.420984 0.578884 -1.495272 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.201681 -0.291269 -0.064185 -0.427419 -0.241699 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975396 -1.447666 -0.485169 0.151464 -1.736971 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.975396 -1.447666 -0.485169 0.151464 -1.736971 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018561, variance=1.142411, stddev=1.068841
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.929939 -1.371791 -0.471286 0.124344 -1.642463 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.930 -1.372 -0.471 0.124 -1.642 
[DECODER] Starting decode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 293 411 
[EMBEDDING] Stats: 384/384 non-zero values, sum=0.816, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 384/384 non-zero, sum=0.815793
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[DECODER] SCALED EMBEDS before add: 384/384 non-zero, sum=9.229644
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 384/384 non-zero, sum=28.447704
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -1.022088 -0.853660 -0.503554 0.004578 -1.440647 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.146053 -2.150836 0.233307 1.154613 -2.461963 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.146053 -2.150836 0.233307 1.154613 -2.461963 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.172468, stddev=1.781145
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.204873 -1.207558 0.130987 0.648242 -1.382236 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 393/768 range: [0.000000, 1.546766]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.583421, 0.664104]
[FEEDFORWARD] Sample values: 0.185516 -0.273642 -0.079865 -0.409821 -0.250804 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.204873 -1.207558 0.130987 0.648242 -1.382236 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.185516 -0.273642 -0.079865 -0.409821 -0.250804 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.019357 -1.481200 0.051122 0.238421 -1.633040 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.019357 -1.481200 0.051122 0.238421 -1.633040 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.019061, variance=1.134958, stddev=1.065349
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.974721 -1.408234 0.030095 0.205905 -1.550761 
[DECODER] Layer 0 output: 384/384 non-zero, sum=-0.000000
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974721 -1.408234 0.030095 0.205905 -1.550761 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.974721 -1.408234 0.030095 0.205905 -1.550761 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.949441 -2.816469 0.060190 0.411810 -3.101522 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.949441 -2.816469 0.060190 0.411810 -3.101522 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.974724 -1.408239 0.030095 0.205906 -1.550766 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974724 -1.408239 0.030095 0.205906 -1.550766 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -1.015603 -0.881864 -0.513966 0.006455 -1.441461 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.990327 -2.290103 -0.483871 0.212360 -2.992227 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.990327 -2.290103 -0.483871 0.212360 -2.992227 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.433838, stddev=1.853064
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.074073 -1.235847 -0.261119 0.114600 -1.614745 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 390/768 range: [0.000000, 1.582050]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.651138, 0.613330]
[FEEDFORWARD] Sample values: 0.162746 -0.311766 -0.081310 -0.401227 -0.185503 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.074073 -1.235847 -0.261119 0.114600 -1.614745 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.162746 -0.311766 -0.081310 -0.401227 -0.185503 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.911328 -1.547613 -0.342429 -0.286627 -1.800248 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.911328 -1.547613 -0.342429 -0.286627 -1.800248 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.016837, variance=1.233318, stddev=1.110553
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.835768 -1.408713 -0.323503 -0.273255 -1.636198 
[DECODER] Layer 1 output: 384/384 non-zero, sum=-0.000005
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 3x128
[DEBUG] Decoder sample values: -0.836 -1.409 -0.324 -0.273 -1.636 
[LINEAR] Forward 3x128 -> 3x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.835768 -1.408713 -0.323503 -0.273255 -1.636198 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.056404 0.012090 0.094474 0.102188 0.047582 
[DEBUG] Output projection - shape: 3x1000
[DEBUG] Output range: [-0.191, 0.220]
[DEBUG] Output sample values: -0.056 0.012 0.094 0.102 0.048 
[DEBUG] Forward completed!
[GEN] Step 2 - Best token: 317 (score: 0.2, target_len: 4) [Top scores: 317:0.2 994:0.2 475:0.1 528:0.1 572:0.1 ]
[DEBUG] Forward - source: 5 tokens, target: 4 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 5 107 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=-2.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Token 2 embedding values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 
[EMBEDDING] GPU verification - first 10 values: -0.086132 -0.109591 -0.006623 0.097001 -0.077460 0.001065 0.129796 0.093622 0.021494 -0.067091 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=-2.056851
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=-23.270590
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.239878 -0.074930 1.097440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[ENCODER] After pos encoding: 640/640 non-zero, sum=8.789579
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.974473 -1.139878 -0.074930 1.197440 -0.876357 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.944240 -0.556404 -0.190013 0.789609 -0.796906 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.918714 -1.696282 -0.264943 1.987049 -1.673263 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.918714 -1.696282 -0.264943 1.987049 -1.673263 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.165234, variance=2.797215, stddev=1.672491
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.246014 -1.113020 -0.257207 1.089282 -1.099257 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 641/1280 range: [0.000000, 1.451810]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.625124, 0.748166]
[FEEDFORWARD] Sample values: 0.181962 -0.218421 -0.059040 -0.411015 -0.318923 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.246014 -1.113020 -0.257207 1.089282 -1.099257 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.181962 -0.218421 -0.059040 -0.411015 -0.318923 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.064053 -1.331441 -0.316247 0.678268 -1.418180 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.064053 -1.331441 -0.316247 0.678268 -1.418180 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.017554, variance=1.037647, stddev=1.018655
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.061799 -1.324291 -0.327688 0.648615 -1.409440 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.061799 -1.324291 -0.327688 0.648615 -1.409440 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -1.044159 -0.744668 -0.425512 0.387091 -1.265814 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.105958 -2.068958 -0.753200 1.035705 -2.675254 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.105958 -2.068958 -0.753200 1.035705 -2.675254 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.201019, stddev=1.789142
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.177077 -1.156397 -0.420984 0.578884 -1.495272 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 641/1280 range: [0.000000, 1.558598]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.607596, 0.665292]
[FEEDFORWARD] Sample values: 0.201681 -0.291269 -0.064185 -0.427419 -0.241699 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.177077 -1.156397 -0.420984 0.578884 -1.495272 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.201681 -0.291269 -0.064185 -0.427419 -0.241699 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975396 -1.447666 -0.485169 0.151464 -1.736971 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.975396 -1.447666 -0.485169 0.151464 -1.736971 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018561, variance=1.142411, stddev=1.068841
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.929939 -1.371791 -0.471286 0.124344 -1.642463 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.930 -1.372 -0.471 0.124 -1.642 
[DECODER] Starting decode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 293 411 317 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-0.031, range=[-0.146, 0.146]
[EMBEDDING] First 10 output values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Token 2 embedding values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 
[EMBEDDING] GPU verification - first 10 values: -0.086206 -0.109667 0.070880 0.096920 -0.077540 0.000978 0.129718 0.093545 0.021415 -0.067167 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 512/512 non-zero, sum=-0.031203
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[DECODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-0.353020
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.240735 0.801911 1.096520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[DECODER] After pos encoding: 512/512 non-zero, sum=25.283091
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.975308 -1.140735 0.801911 1.196520 -0.877270 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.950615 -2.281470 1.603821 2.393040 -1.754541 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.196314, variance=3.648617, stddev=1.910138
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.123966 -1.297176 0.736861 1.150035 -1.021316 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -1.003299 -0.809387 -0.549530 -0.022936 -1.453179 
[MATRIX_ADD_DEBUG] Result first 5 values: -2.127265 -2.106563 0.187331 1.127099 -2.474495 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -2.127265 -2.106563 0.187331 1.127099 -2.474495 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.049037, stddev=1.746152
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.218259 -1.206403 0.107282 0.645476 -1.417113 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 510/1024 range: [0.000000, 1.555094]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.692209, 0.765435]
[FEEDFORWARD] Sample values: 0.178054 -0.266756 -0.077159 -0.401230 -0.263079 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.218259 -1.206403 0.107282 0.645476 -1.417113 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.178054 -0.266756 -0.077159 -0.401230 -0.263079 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.040205 -1.473159 0.030123 0.244246 -1.680192 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.040205 -1.473159 0.030123 0.244246 -1.680192 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.018733, variance=1.130476, stddev=1.063243
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.995950 -1.403152 0.010713 0.212099 -1.597870 
[DECODER] Layer 0 output: 512/512 non-zero, sum=0.000000
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.995950 -1.403152 0.010713 0.212099 -1.597870 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.995950 -1.403152 0.010713 0.212099 -1.597870 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.991901 -2.806303 0.021426 0.424198 -3.195741 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.991901 -2.806303 0.021426 0.424198 -3.195741 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.995954 -1.403156 0.010713 0.212100 -1.597875 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.995954 -1.403156 0.010713 0.212100 -1.597875 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.992858 -0.825510 -0.569927 -0.027559 -1.456907 
[MATRIX_ADD_DEBUG] Result first 5 values: -1.988811 -2.228666 -0.559214 0.184541 -3.054782 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -1.988811 -2.228666 -0.559214 0.184541 -3.054782 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.271068, stddev=1.808612
[LAYER_NORM] Output: 100/100 non-zero, first 5: -1.099634 -1.232252 -0.309195 0.102034 -1.689020 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 502/1024 range: [0.000000, 1.598486]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.649809, 0.718495]
[FEEDFORWARD] Sample values: 0.147956 -0.304458 -0.073642 -0.388049 -0.198810 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -1.099634 -1.232252 -0.309195 0.102034 -1.689020 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.147956 -0.304458 -0.073642 -0.388049 -0.198810 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.951678 -1.536710 -0.382837 -0.286015 -1.887830 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.951678 -1.536710 -0.382837 -0.286015 -1.887830 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.016036, variance=1.227713, stddev=1.108027
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.873367 -1.401361 -0.359985 -0.272603 -1.718249 
[DECODER] Layer 1 output: 512/512 non-zero, sum=-0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 4x128
[DEBUG] Decoder sample values: -0.873 -1.401 -0.360 -0.273 -1.718 
[LINEAR] Forward 4x128 -> 4x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.873367 -1.401361 -0.359985 -0.272603 -1.718249 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.004119 0.005442 -0.007026 -0.008318 0.007125 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.000624 0.054840 0.076898 0.076952 0.057230 
[LINEAR] Output: 100/100 non-zero, first 5: -0.058831 0.012042 0.096156 0.100242 0.050099 
[DEBUG] Output projection - shape: 4x1000
[DEBUG] Output range: [-0.193, 0.190]
[DEBUG] Output sample values: -0.059 0.012 0.096 0.100 0.050 
[DEBUG] Forward completed!
ENG: <sos> i love you <eos>
ESP: <sos> diez ba fr <eos>
---