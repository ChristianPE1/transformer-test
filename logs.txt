Se truncaron las últimas líneas 5000 del resultado de transmisión.
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1062/2048 range: [0.000000, 1.566416]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.650930, 0.873856]
[FEEDFORWARD] Sample values: 0.049876 -0.137532 -0.174493 0.139602 -0.137889 
[ENCODER_LAYER] After feedforward: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.332290 -1.195706 1.533806 0.534857 -0.558992 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.049876 -0.137532 -0.174493 0.139602 -0.137889 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.282414 -1.333238 1.359313 0.674459 -0.696881 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.282414 -1.333238 1.359313 0.674459 -0.696881 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012727, variance=1.175424, stddev=1.084174
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.248749 -1.217988 1.265516 0.633833 -0.631037 
[ENCODER_LAYER] Final output: 1024/1024 non-zero
[ENCODER] Layer 1 output: 1024/1024 non-zero, sum=-0.000010
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 8x128
[DEBUG] Encoder sample values: -0.249 -1.218 1.266 0.634 -0.631 
[DECODER] Starting decode with 8 tokens
[EMBEDDING] Forward pass - seq_len=8, d_model=128
[EMBEDDING] Input tokens: 2 107 7 135 308 
[EMBEDDING] Stats: 1024/1024 non-zero values, sum=1.868, range=[-0.146, 0.213]
[EMBEDDING] First 10 output values: -0.035992 -0.115620 0.213431 0.014269 -0.056014 0.120393 -0.124624 -0.051753 -0.028193 -0.112032 
[EMBEDDING] Token 2 embedding values: -0.035992 -0.115620 0.213431 0.014269 -0.056014 0.120393 -0.124624 -0.051753 
[EMBEDDING] GPU verification - first 10 values: -0.035992 -0.115620 0.213431 0.014269 -0.056014 0.120393 -0.124624 -0.051753 -0.028193 -0.112032 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 1024/1024 non-zero, sum=1.868019
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 960/1024 non-zero, sum=51.368427
[DECODER] SCALED EMBEDS before add: 1024/1024 non-zero, sum=21.134268
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407199 -1.308095 2.414691 0.161431 -0.633723 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407199 -1.208095 2.414691 0.261431 -0.633723 
[DECODER] After pos encoding: 1024/1024 non-zero, sum=72.502617
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407199 -1.208095 2.414691 0.261431 -0.633723 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407199 -1.208095 2.414691 0.261431 -0.633723 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814398 -2.416189 4.829383 0.522863 -1.267447 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814398 -2.416189 4.829383 0.522863 -1.267447 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.002525, variance=3.799967, stddev=1.949353
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.419074 -1.240778 2.476133 0.266928 -0.651484 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.419074 -1.240778 2.476133 0.266928 -0.651484 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.021607 -0.825276 1.027557 0.693448 -0.274119 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.440681 -2.066054 3.503690 0.960376 -0.925603 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.440681 -2.066054 3.503690 0.960376 -0.925603 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.945007, stddev=1.716105
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.256791 -1.203920 2.041653 0.559626 -0.539363 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1000/2048 range: [0.000000, 1.604191]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.620033, 0.837694]
[FEEDFORWARD] Sample values: 0.030558 -0.137118 -0.190268 0.115865 -0.132260 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.256791 -1.203920 2.041653 0.559626 -0.539363 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.030558 -0.137118 -0.190268 0.115865 -0.132260 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.226233 -1.341038 1.851384 0.675490 -0.671622 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.226233 -1.341038 1.851384 0.675490 -0.671622 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012407, variance=1.166171, stddev=1.079899
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.198005 -1.230329 1.725895 0.637002 -0.610442 
[DECODER] Layer 0 output: 1024/1024 non-zero, sum=-0.000005
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.198005 -1.230329 1.725895 0.637002 -0.610442 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.198005 -1.230329 1.725895 0.637002 -0.610442 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.396011 -2.460658 3.451790 1.274004 -1.220883 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.396011 -2.460658 3.451790 1.274004 -1.220883 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.198006 -1.230333 1.725900 0.637004 -0.610443 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.198006 -1.230333 1.725900 0.637004 -0.610443 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.041406 -0.766427 0.948255 0.715173 -0.220658 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.156600 -1.996759 2.674155 1.352177 -0.831101 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.156600 -1.996759 2.674155 1.352177 -0.831101 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.006238, stddev=1.733853
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.090319 -1.151631 1.542319 0.779868 -0.479338 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 973/2048 range: [0.000000, 1.659488]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.712861, 0.783970]
[FEEDFORWARD] Sample values: 0.122005 -0.191728 -0.208732 0.096221 -0.208610 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.090319 -1.151631 1.542319 0.779868 -0.479338 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.122005 -0.191728 -0.208732 0.096221 -0.208610 
[MATRIX_ADD_DEBUG] Result first 5 values: 0.031687 -1.343359 1.333587 0.876089 -0.687948 
[LAYER_NORM] Input: 100/100 non-zero, first 5: 0.031687 -1.343359 1.333587 0.876089 -0.687948 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012453, variance=1.282056, stddev=1.132283
[LAYER_NORM] Output: 100/100 non-zero, first 5: 0.038982 -1.175418 1.188783 0.784734 -0.596578 
[DECODER] Layer 1 output: 1024/1024 non-zero, sum=0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 8x128
[DEBUG] Decoder sample values: 0.039 -1.175 1.189 0.785 -0.597 
[LINEAR] Forward 8x128 -> 8x1000
[LINEAR] Input: 100/100 non-zero, first 5: 0.038982 -1.175418 1.188783 0.784734 -0.596578 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083538 0.101060 -0.091339 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001377 0.370722 0.230232 0.235405 -0.001126 
[LINEAR] Output: 100/100 non-zero, first 5: -0.583446 1.475629 0.764051 2.154996 -0.580884 
[DEBUG] Output projection - shape: 8x1000
[DEBUG] Output range: [-3.353, 3.000]
[DEBUG] Output sample values: -0.583 1.476 0.764 2.155 -0.581 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-3.353, 3.000] Var:0.687
[LOSS] Calculated loss: 6.996
 Loss: 6.996 (LR: 0.0050)[LOSS] Gradient sum: 1.9977
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0062, bias: 0.1244
[LINEAR] Output projection - using 3x learning rate: 0.0150
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[EMBEDDING] Updating weights for 8 tokens with lr=0.0050
[EMBEDDING] Gradient stats: 1024/1024 non-zero, sum=0.0042, range=[-0.1248, 0.0013]
[EMBEDDING] Sample weights after update: 0.13399301 -0.09638656 0.11662459 -0.10603787 0.05230801 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 8 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.00500000
[UPDATE] Gradientes aplicados con lr=0.00500000 [Updated]
    Muestra 4/4: [DEBUG] Forward - source: 8 tokens, target: 8 tokens
[ENCODER] Starting encode with 8 tokens
[EMBEDDING] Forward pass - seq_len=8, d_model=128
[EMBEDDING] Input tokens: 2 8 1 1 186 
[EMBEDDING] Stats: 1024/1024 non-zero values, sum=2.13331580, range=[-0.14545676, 0.14506462]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1024/1024 non-zero, sum=2.133316
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 960/1024 non-zero, sum=51.368427
[ENCODER] SCALED EMBEDS before add: 1024/1024 non-zero, sum=24.135702
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 1024/1024 non-zero, sum=75.504059
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1024/1024 non-zero
[ENCODER_LAYER] After self-attention: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.331979 -1.159935 1.357730 0.279213 -0.491623 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.738848 -2.365807 2.874418 0.544809 -1.124934 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.738848 -2.365807 2.874418 0.544809 -1.124934 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.005850, variance=3.103926, stddev=1.761799
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.422692 -1.346156 1.628204 0.305914 -0.641835 
[ENCODER_LAYER] After norm1: 1024/1024 non-zero
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1054/2048 range: [0.000000, 1.790212]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.736677, 0.806874]
[FEEDFORWARD] Sample values: -0.002465 -0.030590 -0.094615 0.116431 -0.060585 
[ENCODER_LAYER] After feedforward: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.422692 -1.346156 1.628204 0.305914 -0.641835 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.002465 -0.030590 -0.094615 0.116431 -0.060585 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.425157 -1.376746 1.533588 0.422345 -0.702420 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.425157 -1.376746 1.533588 0.422345 -0.702420 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014286, variance=1.065850, stddev=1.032405
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.397975 -1.319695 1.499289 0.422926 -0.666535 
[ENCODER_LAYER] Final output: 1024/1024 non-zero
[ENCODER] Layer 0 output: 1024/1024 non-zero, sum=-0.000003
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1024/1024 non-zero
[ENCODER_LAYER] After self-attention: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.397975 -1.319695 1.499289 0.422926 -0.666535 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.339427 -1.262689 1.305187 0.410897 -0.511670 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.737402 -2.582385 2.804476 0.833823 -1.178206 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.737402 -2.582385 2.804476 0.833823 -1.178206 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.282505, stddev=1.811771
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.407006 -1.425337 1.547920 0.460225 -0.650306 
[ENCODER_LAYER] After norm1: 1024/1024 non-zero
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1024/2048 range: [0.000000, 1.586896]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.687962, 0.771567]
[FEEDFORWARD] Sample values: 0.060299 -0.081035 -0.138233 0.090074 -0.146779 
[ENCODER_LAYER] After feedforward: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407006 -1.425337 1.547920 0.460225 -0.650306 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.060299 -0.081035 -0.138233 0.090074 -0.146779 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.346707 -1.506372 1.409686 0.550299 -0.797085 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.346707 -1.506372 1.409686 0.550299 -0.797085 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015269, variance=1.167145, stddev=1.080349
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.306788 -1.380204 1.318976 0.523505 -0.723670 
[ENCODER_LAYER] Final output: 1024/1024 non-zero
[ENCODER] Layer 1 output: 1024/1024 non-zero, sum=-0.000002
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 8x128
[DEBUG] Encoder sample values: -0.307 -1.380 1.319 0.524 -0.724 
[DECODER] Starting decode with 8 tokens
[EMBEDDING] Forward pass - seq_len=8, d_model=128
[EMBEDDING] Input tokens: 2 15 1 16 646 
[EMBEDDING] Stats: 1024/1024 non-zero values, sum=3.186, range=[-0.146, 0.214]
[EMBEDDING] First 10 output values: -0.035992 -0.115622 0.214055 0.014265 -0.056014 0.120392 -0.124626 -0.051754 -0.028194 -0.112032 
[EMBEDDING] Token 2 embedding values: -0.035992 -0.115622 0.214055 0.014265 -0.056014 0.120392 -0.124626 -0.051754 
[EMBEDDING] GPU verification - first 10 values: -0.035992 -0.115622 0.214055 0.014265 -0.056014 0.120392 -0.124626 -0.051754 -0.028194 -0.112032 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 1024/1024 non-zero, sum=3.186394
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 960/1024 non-zero, sum=51.368427
[DECODER] SCALED EMBEDS before add: 1024/1024 non-zero, sum=36.049961
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407202 -1.308116 2.421752 0.161389 -0.633726 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407202 -1.208116 2.421752 0.261389 -0.633726 
[DECODER] After pos encoding: 1024/1024 non-zero, sum=87.418381
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407202 -1.208116 2.421752 0.261389 -0.633726 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407202 -1.208116 2.421752 0.261389 -0.633726 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814403 -2.416232 4.843504 0.522779 -1.267452 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814403 -2.416232 4.843504 0.522779 -1.267452 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.002621, variance=3.801035, stddev=1.949627
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.419067 -1.240675 2.482980 0.266798 -0.651444 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.419067 -1.240675 2.482980 0.266798 -0.651444 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.242686 -1.284605 1.152732 0.517711 -0.530356 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.661753 -2.525280 3.635712 0.784509 -1.181800 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.661753 -2.525280 3.635712 0.784509 -1.181800 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.063513, stddev=1.750292
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.378082 -1.442776 2.077203 0.448216 -0.675202 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1039/2048 range: [0.000000, 1.451801]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.702086, 0.735185]
[FEEDFORWARD] Sample values: 0.045699 -0.071149 -0.152203 0.058971 -0.152534 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.378082 -1.442776 2.077203 0.448216 -0.675202 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045699 -0.071149 -0.152203 0.058971 -0.152534 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.332383 -1.513925 1.925000 0.507187 -0.827735 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.332383 -1.513925 1.925000 0.507187 -0.827735 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015243, variance=1.158665, stddev=1.076417
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.294625 -1.392287 1.802500 0.485342 -0.754811 
[DECODER] Layer 0 output: 1024/1024 non-zero, sum=0.000005
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.294625 -1.392287 1.802500 0.485342 -0.754811 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.294625 -1.392287 1.802500 0.485342 -0.754811 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.589250 -2.784574 3.605001 0.970684 -1.509623 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.589250 -2.784574 3.605001 0.970684 -1.509623 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.294626 -1.392291 1.802506 0.485343 -0.754814 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.294626 -1.392291 1.802506 0.485343 -0.754814 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.242216 -1.235555 1.070328 0.486056 -0.487598 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.536842 -2.627846 2.872833 0.971400 -1.242412 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.536842 -2.627846 2.872833 0.971400 -1.242412 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.009767, stddev=1.734871
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.309442 -1.514721 1.655935 0.559926 -0.716141 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1038/2048 range: [0.000000, 1.397366]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.619226, 0.784456]
[FEEDFORWARD] Sample values: 0.130722 -0.090489 -0.163133 0.010714 -0.219716 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.309442 -1.514721 1.655935 0.559926 -0.716141 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.130722 -0.090489 -0.163133 0.010714 -0.219716 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.178720 -1.605210 1.492803 0.570640 -0.935857 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.178720 -1.605210 1.492803 0.570640 -0.935857 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013083, variance=1.268131, stddev=1.126118
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.147087 -1.413819 1.337236 0.518350 -0.819429 
[DECODER] Layer 1 output: 1024/1024 non-zero, sum=0.000010
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 8x128
[DEBUG] Decoder sample values: -0.147 -1.414 1.337 0.518 -0.819 
[LINEAR] Forward 8x128 -> 8x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.147087 -1.413819 1.337236 0.518350 -0.819429 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083537 0.100973 -0.091306 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001393 0.370687 0.232037 0.237223 -0.001131 
[LINEAR] Output: 100/100 non-zero, first 5: -0.838501 1.589015 0.747110 2.038873 -0.503480 
[DEBUG] Output projection - shape: 8x1000
[DEBUG] Output range: [-3.015, 3.288]
[DEBUG] Output sample values: -0.839 1.589 0.747 2.039 -0.503 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-3.015, 3.288] Var:0.674
[LOSS] Calculated loss: 6.694
[TRAINER] Loss stagnant (improvement: 0.014), boosting LR to 0.015
 Loss: 6.694 (LR: 0.0150)[LOSS] Gradient sum: 1.9972
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0063, bias: 0.1243
[LINEAR] Output projection - using 3x learning rate: 0.0450
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[EMBEDDING] Updating weights for 8 tokens with lr=0.0150
[EMBEDDING] Gradient stats: 1024/1024 non-zero, sum=-0.1221, range=[-0.1249, 0.0011]
[EMBEDDING] Sample weights after update: 0.13399301 -0.09638656 0.11662459 -0.10603787 0.05230801 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 8 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.01500000
[UPDATE] Gradientes aplicados con lr=0.01500000 [Updated]
  Promedio de loss: 6.714

Época 20/20
  Procesando 4 muestras...
  Vocabulario objetivo: 1000 clases
    Muestra 1/4: [DEBUG] Forward - source: 7 tokens, target: 7 tokens
[ENCODER] Starting encode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 35 1 1 35 
[EMBEDDING] Stats: 896/896 non-zero values, sum=4.524, range=[-0.145, 0.145]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 896/896 non-zero, sum=4.524219
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[ENCODER] SCALED EMBEDS before add: 896/896 non-zero, sum=51.185696
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 896/896 non-zero, sum=96.112022
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.270815 -1.176053 1.402392 0.279803 -0.622608 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.009330, variance=3.188168, stddev=1.785547
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 882/1792 range: [0.000000, 1.487872]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.717560, 0.697546]
[FEEDFORWARD] Sample values: -0.011209 -0.035874 -0.097879 0.103197 -0.060380 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.011209 -0.035874 -0.097879 0.103197 -0.060380 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.395973 -1.375102 1.531733 0.403423 -0.768985 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.395973 -1.375102 1.531733 0.403423 -0.768985 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013441, variance=1.069201, stddev=1.034027
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.369944 -1.316852 1.494328 0.403147 -0.730681 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 0 output: 896/896 non-zero, sum=0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.369944 -1.316852 1.494328 0.403147 -0.730681 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.239204 -1.292641 1.284688 0.373110 -0.765233 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.609148 -2.609494 2.779015 0.776257 -1.495914 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.609148 -2.609494 2.779015 0.776257 -1.495914 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.342614, stddev=1.828284
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.333180 -1.427291 1.520013 0.424582 -0.818206 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 880/1792 range: [0.000000, 1.459548]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.644023, 0.786986]
[FEEDFORWARD] Sample values: 0.045174 -0.111483 -0.157089 0.086081 -0.140788 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.333180 -1.427291 1.520013 0.424582 -0.818206 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045174 -0.111483 -0.157089 0.086081 -0.140788 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.288006 -1.538774 1.362924 0.510663 -0.958995 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.288006 -1.538774 1.362924 0.510663 -0.958995 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013904, variance=1.172251, stddev=1.082710
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.253163 -1.408383 1.271649 0.484494 -0.872894 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 1 output: 896/896 non-zero, sum=0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 7x128
[DEBUG] Encoder sample values: -0.253 -1.408 1.272 0.484 -0.873 
[DECODER] Starting decode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 185 1 1 43 
[EMBEDDING] Stats: 896/896 non-zero values, sum=2.924, range=[-0.146, 0.216]
[EMBEDDING] First 10 output values: -0.035992 -0.115629 0.215927 0.014255 -0.056015 0.120391 -0.124632 -0.051756 -0.028196 -0.112033 
[EMBEDDING] Token 2 embedding values: -0.035992 -0.115629 0.215927 0.014255 -0.056015 0.120391 -0.124632 -0.051756 
[EMBEDDING] GPU verification - first 10 values: -0.035992 -0.115629 0.215927 0.014255 -0.056015 0.120391 -0.124632 -0.051756 -0.028196 -0.112033 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 896/896 non-zero, sum=2.923780
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[DECODER] SCALED EMBEDS before add: 896/896 non-zero, sum=33.078812
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407208 -1.308187 2.442935 0.161278 -0.633735 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407208 -1.208187 2.442935 0.261278 -0.633735 
[DECODER] After pos encoding: 896/896 non-zero, sum=78.005150
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407208 -1.208187 2.442935 0.261278 -0.633735 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407208 -1.208187 2.442935 0.261278 -0.633735 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814416 -2.416374 4.885870 0.522555 -1.267470 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814416 -2.416374 4.885870 0.522555 -1.267470 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.002910, variance=3.804253, stddev=1.950452
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.419045 -1.240371 2.503502 0.266423 -0.651326 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.419045 -1.240371 2.503502 0.266423 -0.651326 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.140427 -1.364169 1.066696 0.448521 -0.854405 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.559472 -2.604540 3.570198 0.714944 -1.505731 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.559472 -2.604540 3.570198 0.714944 -1.505731 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.145221, stddev=1.773480
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.315466 -1.468604 2.013103 0.403131 -0.849026 
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 892/1792 range: [0.000000, 1.901290]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.665935, 0.707581]
[FEEDFORWARD] Sample values: 0.031592 -0.107749 -0.171219 0.061198 -0.150202 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.315466 -1.468604 2.013103 0.403131 -0.849026 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.031592 -0.107749 -0.171219 0.061198 -0.150202 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.283873 -1.576354 1.841884 0.464329 -0.999228 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.283873 -1.576354 1.841884 0.464329 -0.999228 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014128, variance=1.165690, stddev=1.079676
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.249839 -1.446940 1.719045 0.443149 -0.912404 
[DECODER] Layer 0 output: 896/896 non-zero, sum=0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.249839 -1.446940 1.719045 0.443149 -0.912404 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.249839 -1.446940 1.719045 0.443149 -0.912404 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.499679 -2.893879 3.438090 0.886297 -1.824808 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.499679 -2.893879 3.438090 0.886297 -1.824808 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.249840 -1.446944 1.719050 0.443150 -0.912407 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.249840 -1.446944 1.719050 0.443150 -0.912407 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.098029 -1.363258 0.893657 0.410105 -0.909809 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.347869 -2.810202 2.612707 0.853255 -1.822216 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.347869 -2.810202 2.612707 0.853255 -1.822216 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.064084, stddev=1.750455
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.198731 -1.605412 1.492587 0.487447 -1.040995 
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 843/1792 range: [0.000000, 1.682893]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.565170, 0.799602]
[FEEDFORWARD] Sample values: 0.108689 -0.175318 -0.206940 0.047372 -0.206488 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.198731 -1.605412 1.492587 0.487447 -1.040995 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.108689 -0.175318 -0.206940 0.047372 -0.206488 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.090042 -1.780730 1.285647 0.534819 -1.247483 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.090042 -1.780730 1.285647 0.534819 -1.247483 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.011079, variance=1.270683, stddev=1.127250
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.070049 -1.569883 1.150344 0.484274 -1.096832 
[DECODER] Layer 1 output: 896/896 non-zero, sum=-0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 7x128
[DEBUG] Decoder sample values: -0.070 -1.570 1.150 0.484 -1.097 
[LINEAR] Forward 7x128 -> 7x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.070049 -1.569883 1.150344 0.484274 -1.096832 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083639 0.100795 -0.091394 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001421 0.376190 0.237490 0.242771 -0.001156 
[LINEAR] Output: 100/100 non-zero, first 5: -0.694311 1.512758 1.026459 2.015077 -0.319963 
[DEBUG] Output projection - shape: 7x1000
[DEBUG] Output range: [-2.777, 3.215]
[DEBUG] Output sample values: -0.694 1.513 1.026 2.015 -0.320 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-2.777, 3.215] Var:0.690
[LOSS] Calculated loss: 6.717
 Loss: 6.717 (LR: 0.0050)[LOSS] Gradient sum: 1.9971
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0180, bias: 0.4264
[LINEAR] Output projection - using 3x learning rate: 0.0150
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[EMBEDDING] Updating weights for 7 tokens with lr=0.0050
[EMBEDDING] Gradient stats: 896/896 non-zero, sum=-0.0136, range=[-0.1426, 0.0013]
[EMBEDDING] Sample weights after update: 0.13399301 -0.09638656 0.11662459 -0.10603787 0.05230801 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 7 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.00500000
[UPDATE] Gradientes aplicados con lr=0.00500000 [Updated]
    Muestra 2/4: [DEBUG] Forward - source: 7 tokens, target: 7 tokens
[ENCODER] Starting encode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 1 1 381 35 
[EMBEDDING] Stats: 896/896 non-zero values, sum=1.89563274, range=[-0.14545676, 0.14549872]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 896/896 non-zero, sum=1.895633
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[ENCODER] SCALED EMBEDS before add: 896/896 non-zero, sum=21.446630
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 896/896 non-zero, sum=66.372940
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.252072 -1.074647 1.386662 0.291327 -0.558951 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.658941 -2.280519 2.903350 0.556924 -1.192262 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.658941 -2.280519 2.903350 0.556924 -1.192262 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003652, variance=3.099769, stddev=1.760619
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.376341 -1.297368 1.646976 0.314248 -0.679258 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 883/1792 range: [0.000000, 1.462807]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.718514, 0.701726]
[FEEDFORWARD] Sample values: -0.007021 -0.041672 -0.088672 0.104546 -0.061492 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.376341 -1.297368 1.646976 0.314248 -0.679258 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.007021 -0.041672 -0.088672 0.104546 -0.061492 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.383362 -1.339040 1.558305 0.418794 -0.740750 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.383362 -1.339040 1.558305 0.418794 -0.740750 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014183, variance=1.069810, stddev=1.034321
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.356928 -1.280895 1.520309 0.418610 -0.702458 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 0 output: 896/896 non-zero, sum=0.000006
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.356928 -1.280895 1.520309 0.418610 -0.702458 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.175009 -1.131487 1.326020 0.410955 -0.634483 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.531937 -2.412383 2.846330 0.829565 -1.336941 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.531937 -2.412383 2.846330 0.829565 -1.336941 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.260900, stddev=1.805799
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.294572 -1.335909 1.576216 0.459389 -0.740360 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 868/1792 range: [0.000000, 1.408283]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.668048, 0.790977]
[FEEDFORWARD] Sample values: 0.059528 -0.117303 -0.133887 0.085820 -0.142948 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.294572 -1.335909 1.576216 0.459389 -0.740360 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.059528 -0.117303 -0.133887 0.085820 -0.142948 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.235044 -1.453212 1.442329 0.545210 -0.883308 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.235044 -1.453212 1.442329 0.545210 -0.883308 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015449, variance=1.171892, stddev=1.082544
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.202850 -1.328133 1.346622 0.517909 -0.801684 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 1 output: 896/896 non-zero, sum=-0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 7x128
[DEBUG] Encoder sample values: -0.203 -1.328 1.347 0.518 -0.802 
[DECODER] Starting decode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 1 20 6 782 
[EMBEDDING] Stats: 896/896 non-zero values, sum=3.823, range=[-0.146, 0.217]
[EMBEDDING] First 10 output values: -0.035993 -0.115631 0.216640 0.014251 -0.056015 0.120390 -0.124634 -0.051757 -0.028196 -0.112034 
[EMBEDDING] Token 2 embedding values: -0.035993 -0.115631 0.216640 0.014251 -0.056015 0.120390 -0.124634 -0.051757 
[EMBEDDING] GPU verification - first 10 values: -0.035993 -0.115631 0.216640 0.014251 -0.056015 0.120390 -0.124634 -0.051757 -0.028196 -0.112034 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 896/896 non-zero, sum=3.822772
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[DECODER] SCALED EMBEDS before add: 896/896 non-zero, sum=43.249672
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407211 -1.308212 2.451000 0.161236 -0.633739 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407211 -1.208212 2.451000 0.261236 -0.633739 
[DECODER] After pos encoding: 896/896 non-zero, sum=88.176094
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407211 -1.208212 2.451000 0.261236 -0.633739 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407211 -1.208212 2.451000 0.261236 -0.633739 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814421 -2.416425 4.902001 0.522473 -1.267478 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814421 -2.416425 4.902001 0.522473 -1.267478 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003020, variance=3.805485, stddev=1.950768
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.419036 -1.240252 2.511309 0.266281 -0.651281 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.419036 -1.240252 2.511309 0.266281 -0.651281 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.000777 -1.147975 1.140958 0.512760 -0.674444 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.419813 -2.388228 3.652267 0.779040 -1.325725 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.419813 -2.388228 3.652267 0.779040 -1.325725 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.016287, stddev=1.736749
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.241723 -1.375114 2.102933 0.448563 -0.763337 
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 904/1792 range: [0.000000, 1.326135]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.634847, 0.766112]
[FEEDFORWARD] Sample values: 0.047520 -0.118645 -0.148387 0.056224 -0.153261 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.241723 -1.375114 2.102933 0.448563 -0.763337 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.047520 -0.118645 -0.148387 0.056224 -0.153261 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.194204 -1.493759 1.954545 0.504787 -0.916598 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.194204 -1.493759 1.954545 0.504787 -0.916598 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.016062, variance=1.162761, stddev=1.078319
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.165203 -1.370371 1.827482 0.483019 -0.835129 
[DECODER] Layer 0 output: 896/896 non-zero, sum=0.000014
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.165203 -1.370371 1.827482 0.483019 -0.835129 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.165203 -1.370371 1.827482 0.483019 -0.835129 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.330406 -2.740743 3.654963 0.966039 -1.670259 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.330406 -2.740743 3.654963 0.966039 -1.670259 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999967, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.165203 -1.370375 1.827487 0.483021 -0.835132 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.165203 -1.370375 1.827487 0.483021 -0.835132 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.043564 -1.119614 1.040271 0.490638 -0.683113 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.121639 -2.489989 2.867758 0.973659 -1.518245 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.121639 -2.489989 2.867758 0.973659 -1.518245 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.021169, stddev=1.738154
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.069982 -1.432548 1.649887 0.560169 -0.873481 
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 845/1792 range: [0.000000, 1.412296]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.561679, 0.828522]
[FEEDFORWARD] Sample values: 0.125568 -0.185575 -0.154085 0.033738 -0.195172 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.069982 -1.432548 1.649887 0.560169 -0.873481 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.125568 -0.185575 -0.154085 0.033738 -0.195172 
[MATRIX_ADD_DEBUG] Result first 5 values: 0.055587 -1.618123 1.495802 0.593906 -1.068653 
[LAYER_NORM] Input: 100/100 non-zero, first 5: 0.055587 -1.618123 1.495802 0.593906 -1.068653 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015042, variance=1.269654, stddev=1.126794
[LAYER_NORM] Output: 100/100 non-zero, first 5: 0.062681 -1.422692 1.340835 0.540426 -0.935052 
[DECODER] Layer 1 output: 896/896 non-zero, sum=-0.000004
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 7x128
[DEBUG] Decoder sample values: 0.063 -1.423 1.341 0.540 -0.935 
[LINEAR] Forward 7x128 -> 7x1000
[LINEAR] Input: 100/100 non-zero, first 5: 0.062681 -1.422692 1.340835 0.540426 -0.935052 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083763 0.100867 -0.091305 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001428 0.382586 0.239563 0.244887 -0.001167 
[LINEAR] Output: 100/100 non-zero, first 5: -0.438249 1.428464 0.975172 2.071683 -0.293480 
[DEBUG] Output projection - shape: 7x1000
[DEBUG] Output range: [-2.882, 3.252]
[DEBUG] Output sample values: -0.438 1.428 0.975 2.072 -0.293 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-2.882, 3.252] Var:0.700
[LOSS] Calculated loss: 6.408
[TRAINER] Loss stagnant (improvement: 0.016), boosting LR to 0.015
 Loss: 6.408 (LR: 0.0150)[LOSS] Gradient sum: 1.9966
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0134, bias: 0.2838
[LINEAR] Output projection - using 3x learning rate: 0.0450
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[EMBEDDING] Updating weights for 7 tokens with lr=0.0150
[EMBEDDING] Gradient stats: 896/896 non-zero, sum=-0.0133, range=[-0.1426, 0.0014]
[EMBEDDING] Sample weights after update: 0.13399301 -0.09638656 0.11662459 -0.10603787 0.05230801 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 7 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.01500000
[UPDATE] Gradientes aplicados con lr=0.01500000 [Updated]
    Muestra 3/4: [DEBUG] Forward - source: 8 tokens, target: 8 tokens
[ENCODER] Starting encode with 8 tokens
[EMBEDDING] Forward pass - seq_len=8, d_model=128
[EMBEDDING] Input tokens: 2 5 70 7 104 
[EMBEDDING] Stats: 1024/1024 non-zero values, sum=-0.56097943, range=[-0.14531903, 0.14568476]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1024/1024 non-zero, sum=-0.560979
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 960/1024 non-zero, sum=51.368427
[ENCODER] SCALED EMBEDS before add: 1024/1024 non-zero, sum=-6.346751
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 1024/1024 non-zero, sum=45.021648
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1024/1024 non-zero
[ENCODER_LAYER] After self-attention: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.286161 -0.943469 1.334605 0.301154 -0.422093 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.693030 -2.149341 2.851293 0.566751 -1.055403 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.693030 -2.149341 2.851293 0.566751 -1.055403 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.002056, variance=3.024271, stddev=1.739046
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.397329 -1.234749 1.640755 0.327080 -0.605704 
[ENCODER_LAYER] After norm1: 1024/1024 non-zero
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1071/2048 range: [0.000000, 1.574595]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.712646, 0.922928]
[FEEDFORWARD] Sample values: -0.007978 -0.051568 -0.109700 0.130249 -0.058327 
[ENCODER_LAYER] After feedforward: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.397329 -1.234749 1.640755 0.327080 -0.605704 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.007978 -0.051568 -0.109700 0.130249 -0.058327 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.405307 -1.286316 1.531055 0.457329 -0.664030 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.405307 -1.286316 1.531055 0.457329 -0.664030 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012685, variance=1.070145, stddev=1.034483
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.379535 -1.231177 1.492282 0.454347 -0.629634 
[ENCODER_LAYER] Final output: 1024/1024 non-zero
[ENCODER] Layer 0 output: 1024/1024 non-zero, sum=-0.000003
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1024/1024 non-zero
[ENCODER_LAYER] After self-attention: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.379535 -1.231177 1.492282 0.454347 -0.629634 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.217679 -0.917950 1.264545 0.506988 -0.375080 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.597215 -2.149127 2.756827 0.961335 -1.004714 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.597215 -2.149127 2.756827 0.961335 -1.004714 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.230583, stddev=1.797385
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.332269 -1.195697 1.533799 0.534852 -0.558987 
[ENCODER_LAYER] After norm1: 1024/1024 non-zero
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1062/2048 range: [0.000000, 1.566409]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.650964, 0.873835]
[FEEDFORWARD] Sample values: 0.049920 -0.137524 -0.174491 0.139530 -0.137906 
[ENCODER_LAYER] After feedforward: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.332269 -1.195697 1.533799 0.534852 -0.558987 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.049920 -0.137524 -0.174491 0.139530 -0.137906 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.282348 -1.333221 1.359308 0.674382 -0.696892 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.282348 -1.333221 1.359308 0.674382 -0.696892 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012725, variance=1.175431, stddev=1.084177
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.248689 -1.217970 1.265507 0.633759 -0.631047 
[ENCODER_LAYER] Final output: 1024/1024 non-zero
[ENCODER] Layer 1 output: 1024/1024 non-zero, sum=-0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 8x128
[DEBUG] Encoder sample values: -0.249 -1.218 1.266 0.634 -0.631 
[DECODER] Starting decode with 8 tokens
[EMBEDDING] Forward pass - seq_len=8, d_model=128
[EMBEDDING] Input tokens: 2 107 7 135 308 
[EMBEDDING] Stats: 1024/1024 non-zero values, sum=1.873, range=[-0.146, 0.219]
[EMBEDDING] First 10 output values: -0.035994 -0.115637 0.218779 0.014240 -0.056016 0.120388 -0.124641 -0.051760 -0.028198 -0.112035 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115637 0.218779 0.014240 -0.056016 0.120388 -0.124641 -0.051760 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115637 0.218779 0.014240 -0.056016 0.120388 -0.124641 -0.051760 -0.028198 -0.112035 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 1024/1024 non-zero, sum=1.873384
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 960/1024 non-zero, sum=51.368427
[DECODER] SCALED EMBEDS before add: 1024/1024 non-zero, sum=21.194942
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407221 -1.308281 2.475200 0.161105 -0.633751 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407221 -1.208281 2.475200 0.261105 -0.633751 
[DECODER] After pos encoding: 1024/1024 non-zero, sum=72.563332
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407221 -1.208281 2.475200 0.261105 -0.633751 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407221 -1.208281 2.475200 0.261105 -0.633751 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814443 -2.416562 4.950400 0.522211 -1.267502 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814443 -2.416562 4.950400 0.522211 -1.267502 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003350, variance=3.809209, stddev=1.951722
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.419011 -1.239886 2.534711 0.265848 -0.651144 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.419011 -1.239886 2.534711 0.265848 -0.651144 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.021631 -0.824875 1.029046 0.693523 -0.274210 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.440642 -2.064761 3.563756 0.959370 -0.925354 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.440642 -2.064761 3.563756 0.959370 -0.925354 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=2.945027, stddev=1.716111
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.256768 -1.203163 2.076647 0.559037 -0.539216 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 999/2048 range: [0.000000, 1.604078]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.619757, 0.837668]
[FEEDFORWARD] Sample values: 0.030440 -0.137042 -0.191579 0.114467 -0.132740 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.256768 -1.203163 2.076647 0.559037 -0.539216 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.030440 -0.137042 -0.191579 0.114467 -0.132740 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.226328 -1.340204 1.885068 0.673504 -0.671955 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.226328 -1.340204 1.885068 0.673504 -0.671955 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012399, variance=1.165973, stddev=1.079807
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.198118 -1.229669 1.757228 0.635209 -0.610810 
[DECODER] Layer 0 output: 1024/1024 non-zero, sum=0.000006
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.198118 -1.229669 1.757228 0.635209 -0.610810 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.198118 -1.229669 1.757228 0.635209 -0.610810 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.396236 -2.459338 3.514456 1.270417 -1.221619 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.396236 -2.459338 3.514456 1.270417 -1.221619 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.198119 -1.229673 1.757233 0.635211 -0.610811 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.198119 -1.229673 1.757233 0.635211 -0.610811 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.041100 -0.766307 0.949502 0.715117 -0.220920 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.157019 -1.995980 2.706735 1.350327 -0.831732 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.157019 -1.995980 2.706735 1.350327 -0.831732 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.006923, stddev=1.734051
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.090550 -1.151050 1.560932 0.778713 -0.479647 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 973/2048 range: [0.000000, 1.659634]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.714140, 0.784621]
[FEEDFORWARD] Sample values: 0.121412 -0.190823 -0.209683 0.095814 -0.207496 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.090550 -1.151050 1.560932 0.778713 -0.479647 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.121412 -0.190823 -0.209683 0.095814 -0.207496 
[MATRIX_ADD_DEBUG] Result first 5 values: 0.030861 -1.341873 1.351248 0.874527 -0.687143 
[LAYER_NORM] Input: 100/100 non-zero, first 5: 0.030861 -1.341873 1.351248 0.874527 -0.687143 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012391, variance=1.282443, stddev=1.132454
[LAYER_NORM] Output: 100/100 non-zero, first 5: 0.038193 -1.173983 1.204145 0.783182 -0.595832 
[DECODER] Layer 1 output: 1024/1024 non-zero, sum=0.000009
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 8x128
[DEBUG] Decoder sample values: 0.038 -1.174 1.204 0.783 -0.596 
[LINEAR] Forward 8x128 -> 8x1000
[LINEAR] Input: 100/100 non-zero, first 5: 0.038193 -1.173983 1.204145 0.783182 -0.595832 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083901 0.100634 -0.091210 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001470 0.395358 0.245665 0.251237 -0.001202 
[LINEAR] Output: 100/100 non-zero, first 5: -0.581738 1.502378 0.779853 2.174768 -0.580043 
[DEBUG] Output projection - shape: 8x1000
[DEBUG] Output range: [-3.354, 3.019]
[DEBUG] Output sample values: -0.582 1.502 0.780 2.175 -0.580 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-3.354, 3.019] Var:0.687
[LOSS] Calculated loss: 6.991
 Loss: 6.991 (LR: 0.0050)[LOSS] Gradient sum: 1.9977
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0064, bias: 0.1244
[LINEAR] Output projection - using 3x learning rate: 0.0150
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[ATTENTION] Weights updated with lr=0.0050
[FEEDFORWARD] Weights updated with lr=0.0050
[EMBEDDING] Updating weights for 8 tokens with lr=0.0050
[EMBEDDING] Gradient stats: 1024/1024 non-zero, sum=0.0042, range=[-0.1248, 0.0013]
[EMBEDDING] Sample weights after update: 0.13399301 -0.09638656 0.11662459 -0.10603787 0.05230801 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 8 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.00500000
[UPDATE] Gradientes aplicados con lr=0.00500000 [Updated]
    Muestra 4/4: [DEBUG] Forward - source: 8 tokens, target: 8 tokens
[ENCODER] Starting encode with 8 tokens
[EMBEDDING] Forward pass - seq_len=8, d_model=128
[EMBEDDING] Input tokens: 2 8 1 1 186 
[EMBEDDING] Stats: 1024/1024 non-zero values, sum=2.13331580, range=[-0.14545676, 0.14506462]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 1024/1024 non-zero, sum=2.133316
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 960/1024 non-zero, sum=51.368427
[ENCODER] SCALED EMBEDS before add: 1024/1024 non-zero, sum=24.135702
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 1024/1024 non-zero, sum=75.504059
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 1024/1024 non-zero
[ENCODER_LAYER] After self-attention: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.331979 -1.159935 1.357730 0.279213 -0.491623 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.738848 -2.365807 2.874418 0.544809 -1.124934 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.738848 -2.365807 2.874418 0.544809 -1.124934 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.005850, variance=3.103926, stddev=1.761799
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.422692 -1.346156 1.628204 0.305914 -0.641835 
[ENCODER_LAYER] After norm1: 1024/1024 non-zero
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1054/2048 range: [0.000000, 1.790210]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.736670, 0.806883]
[FEEDFORWARD] Sample values: -0.002446 -0.030581 -0.094624 0.116430 -0.060577 
[ENCODER_LAYER] After feedforward: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.422692 -1.346156 1.628204 0.305914 -0.641835 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.002446 -0.030581 -0.094624 0.116430 -0.060577 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.425138 -1.376737 1.533580 0.422344 -0.702412 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.425138 -1.376737 1.533580 0.422344 -0.702412 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014285, variance=1.065849, stddev=1.032405
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.397957 -1.319688 1.499281 0.422924 -0.666528 
[ENCODER_LAYER] Final output: 1024/1024 non-zero
[ENCODER] Layer 0 output: 1024/1024 non-zero, sum=-0.000008
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 1024/1024 non-zero
[ENCODER_LAYER] After self-attention: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.397957 -1.319688 1.499281 0.422924 -0.666528 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.339409 -1.262683 1.305179 0.410894 -0.511663 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.737367 -2.582371 2.804460 0.833818 -1.178191 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.737367 -2.582371 2.804460 0.833818 -1.178191 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.282501, stddev=1.811770
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.406987 -1.425331 1.547912 0.460223 -0.650299 
[ENCODER_LAYER] After norm1: 1024/1024 non-zero
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 1024/2048 range: [0.000000, 1.586887]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.688002, 0.771502]
[FEEDFORWARD] Sample values: 0.060342 -0.081022 -0.138236 0.089997 -0.146792 
[ENCODER_LAYER] After feedforward: 1024/1024 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406987 -1.425331 1.547912 0.460223 -0.650299 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.060342 -0.081022 -0.138236 0.089997 -0.146792 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.346645 -1.506353 1.409675 0.550220 -0.797091 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.346645 -1.506353 1.409675 0.550220 -0.797091 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015269, variance=1.167151, stddev=1.080352
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.306730 -1.380183 1.318963 0.523430 -0.723673 
[ENCODER_LAYER] Final output: 1024/1024 non-zero
[ENCODER] Layer 1 output: 1024/1024 non-zero, sum=-0.000008
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 8x128
[DEBUG] Encoder sample values: -0.307 -1.380 1.319 0.523 -0.724 
[DECODER] Starting decode with 8 tokens
[EMBEDDING] Forward pass - seq_len=8, d_model=128
[EMBEDDING] Input tokens: 2 15 1 16 646 
[EMBEDDING] Stats: 1024/1024 non-zero values, sum=3.190, range=[-0.146, 0.219]
[EMBEDDING] First 10 output values: -0.035994 -0.115639 0.219403 0.014236 -0.056016 0.120387 -0.124643 -0.051761 -0.028199 -0.112035 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115639 0.219403 0.014236 -0.056016 0.120387 -0.124643 -0.051761 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115639 0.219403 0.014236 -0.056016 0.120387 -0.124643 -0.051761 -0.028199 -0.112035 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 1024/1024 non-zero, sum=3.189644
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 960/1024 non-zero, sum=51.368427
[DECODER] SCALED EMBEDS before add: 1024/1024 non-zero, sum=36.086700
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407224 -1.308303 2.482261 0.161062 -0.633754 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407224 -1.208303 2.482261 0.261062 -0.633754 
[DECODER] After pos encoding: 1024/1024 non-zero, sum=87.455078
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407224 -1.208303 2.482261 0.261062 -0.633754 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407224 -1.208303 2.482261 0.261062 -0.633754 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814448 -2.416606 4.964521 0.522125 -1.267508 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814448 -2.416606 4.964521 0.522125 -1.267508 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003446, variance=3.810303, stddev=1.952002
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.419003 -1.239779 2.541531 0.265716 -0.651103 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.419003 -1.239779 2.541531 0.265716 -0.651103 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.242516 -1.284711 1.153012 0.517969 -0.530429 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.661519 -2.524491 3.694543 0.783685 -1.181532 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.661519 -2.524491 3.694543 0.783685 -1.181532 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.063209, stddev=1.750206
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.377966 -1.442397 2.110920 0.447767 -0.675082 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 1039/2048 range: [0.000000, 1.451851]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.702232, 0.735665]
[FEEDFORWARD] Sample values: 0.045740 -0.071129 -0.153396 0.057757 -0.153102 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.377966 -1.442397 2.110920 0.447767 -0.675082 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045740 -0.071129 -0.153396 0.057757 -0.153102 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.332227 -1.513525 1.957524 0.505524 -0.828184 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.332227 -1.513525 1.957524 0.505524 -0.828184 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015215, variance=1.158585, stddev=1.076380
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.294517 -1.391990 1.832752 0.483787 -0.755281 
[DECODER] Layer 0 output: 1024/1024 non-zero, sum=0.000011
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.294517 -1.391990 1.832752 0.483787 -0.755281 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.294517 -1.391990 1.832752 0.483787 -0.755281 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.589034 -2.783980 3.665504 0.967573 -1.510561 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.589034 -2.783980 3.665504 0.967573 -1.510561 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999967, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.294518 -1.391994 1.832757 0.483788 -0.755283 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.294518 -1.391994 1.832757 0.483788 -0.755283 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.242169 -1.235723 1.070708 0.486312 -0.487831 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.536687 -2.627717 2.903465 0.970100 -1.243114 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.536687 -2.627717 2.903465 0.970100 -1.243114 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.010414, stddev=1.735057
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.309319 -1.514484 1.673411 0.559117 -0.716468 
[FEEDFORWARD] Forward pass: 8x128 -> 8x256 -> 8x128
[FEEDFORWARD] Input non-zero: 1024/1024
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 1036/2048 range: [0.000000, 1.398100]
[FEEDFORWARD] Output non-zero: 1024/1024 range: [-0.621037, 0.785633]
[FEEDFORWARD] Sample values: 0.130220 -0.089712 -0.164318 0.010524 -0.218482 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.309319 -1.514484 1.673411 0.559117 -0.716468 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.130220 -0.089712 -0.164318 0.010524 -0.218482 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.179099 -1.604196 1.509093 0.569641 -0.934951 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.179099 -1.604196 1.509093 0.569641 -0.934951 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013031, variance=1.268586, stddev=1.126320
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.147443 -1.412712 1.351414 0.517324 -0.818524 
[DECODER] Layer 1 output: 1024/1024 non-zero, sum=0.000004
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 8x128
[DEBUG] Decoder sample values: -0.147 -1.413 1.351 0.517 -0.819 
[LINEAR] Forward 8x128 -> 8x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.147443 -1.412712 1.351414 0.517324 -0.818524 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083901 0.100633 -0.091233 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001486 0.395322 0.247469 0.253054 -0.001207 
[LINEAR] Output: 100/100 non-zero, first 5: -0.836610 1.615037 0.763817 2.058878 -0.502762 
[DEBUG] Output projection - shape: 8x1000
[DEBUG] Output range: [-3.014, 3.286]
[DEBUG] Output sample values: -0.837 1.615 0.764 2.059 -0.503 
[DEBUG] Forward completed!
FWD✓ [LOSS] Predictions range: [-3.014, 3.286] Var:0.674
[LOSS] Calculated loss: 6.679
[TRAINER] Loss stagnant (improvement: 0.015), boosting LR to 0.015
 Loss: 6.679 (LR: 0.0150)[LOSS] Gradient sum: 1.9972
[BACKWARD] Starting backward pass...
[BACKWARD] Output projection backward completed
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Decoder layer 0 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 1 backward completed (with FeedForward)
[FEEDFORWARD] Real backward pass completed - gradients computed for W1, W2, b1, b2
[BACKWARD] Encoder layer 0 backward completed (with FeedForward)
[BACKWARD] Starting weight updates...
[LINEAR] Max gradients - weights: 0.0062, bias: 0.1243
[LINEAR] Output projection - using 3x learning rate: 0.0450
[LINEAR] Weights updated
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[ATTENTION] Weights updated with lr=0.0150
[FEEDFORWARD] Weights updated with lr=0.0150
[EMBEDDING] Updating weights for 8 tokens with lr=0.0150
[EMBEDDING] Gradient stats: 1024/1024 non-zero, sum=-0.1220, range=[-0.1249, 0.0011]
[EMBEDDING] Sample weights after update: 0.13399301 -0.09638656 0.11662459 -0.10603787 0.05230801 
[EMBEDDING] Weight update completed successfully
[UPDATE] Target embeddings updated for 8 tokens
[BACKWARD] Updated: output_projection, 2 decoder layers (with FF), 2 encoder layers (with FF)
[BACKWARD] Completed REAL backward pass with lr=0.01500000
[UPDATE] Gradientes aplicados con lr=0.01500000 [Updated]
  Promedio de loss: 6.698
  === Progreso en época 20 ===
[DEBUG] Forward - source: 7 tokens, target: 1 tokens
[ENCODER] Starting encode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 35 1 1 35 
[EMBEDDING] Stats: 896/896 non-zero values, sum=4.524, range=[-0.145, 0.145]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 896/896 non-zero, sum=4.524219
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[ENCODER] SCALED EMBEDS before add: 896/896 non-zero, sum=51.185696
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 896/896 non-zero, sum=96.112022
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.270815 -1.176053 1.402392 0.279803 -0.622608 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.009330, variance=3.188168, stddev=1.785547
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 882/1792 range: [0.000000, 1.487870]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.717552, 0.697537]
[FEEDFORWARD] Sample values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013440, variance=1.069198, stddev=1.034025
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 0 output: 896/896 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.239184 -1.292623 1.284681 0.373093 -0.765231 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.342615, stddev=1.828285
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 880/1792 range: [0.000000, 1.459550]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.644031, 0.786942]
[FEEDFORWARD] Sample values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013904, variance=1.172253, stddev=1.082711
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.253094 -1.408303 1.271685 0.484413 -0.872904 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 1 output: 896/896 non-zero, sum=-0.000005
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 7x128
[DEBUG] Encoder sample values: -0.253 -1.408 1.272 0.484 -0.873 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=-0.545, range=[-0.142, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=-0.544556
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=-6.160941
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 128/128 non-zero, sum=0.239059
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.253094 -1.408303 1.271685 0.484413 -0.872904 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.672070 -2.647769 3.833663 0.749750 -1.523882 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.672070 -2.647769 3.833663 0.749750 -1.523882 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.799722, stddev=1.949290
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.344777 -1.358325 1.966697 0.384627 -0.781763 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 115/256 range: [0.000000, 1.266355]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.465613, 0.713549]
[FEEDFORWARD] Sample values: 0.057308 -0.101498 -0.171248 0.086031 -0.169774 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.344777 -1.358325 1.966697 0.384627 -0.781763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.057308 -0.101498 -0.171248 0.086031 -0.169774 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.287468 -1.459822 1.795449 0.470658 -0.951537 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.287468 -1.459822 1.795449 0.470658 -0.951537 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015759, variance=1.171046, stddev=1.082153
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.251082 -1.334435 1.673707 0.449490 -0.864736 
[DECODER] Layer 0 output: 128/128 non-zero, sum=0.000005
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.251082 -1.334435 1.673707 0.449490 -0.864736 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.251082 -1.334435 1.673707 0.449490 -0.864736 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.502164 -2.668869 3.347414 0.898981 -1.729473 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.502164 -2.668869 3.347414 0.898981 -1.729473 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999967, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.251083 -1.334438 1.673712 0.449492 -0.864739 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.251083 -1.334438 1.673712 0.449492 -0.864739 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.253094 -1.408303 1.271685 0.484413 -0.872904 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.504176 -2.742741 2.945397 0.933905 -1.737643 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.504176 -2.742741 2.945397 0.933905 -1.737643 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.994751, stddev=1.998690
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.252253 -1.372270 1.473664 0.467258 -0.869391 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 112/256 range: [0.000000, 1.183158]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.474458, 0.836078]
[FEEDFORWARD] Sample values: 0.128382 -0.141009 -0.195487 0.072697 -0.245593 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.252253 -1.372270 1.473664 0.467258 -0.869391 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.128382 -0.141009 -0.195487 0.072697 -0.245593 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.123871 -1.513279 1.278177 0.539955 -1.114983 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.123871 -1.513279 1.278177 0.539955 -1.114983 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015514, variance=1.275913, stddev=1.129568
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.095928 -1.325963 1.145298 0.491754 -0.973354 
[DECODER] Layer 1 output: 128/128 non-zero, sum=0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.096 -1.326 1.145 0.492 -0.973 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.095928 -1.325963 1.145298 0.491754 -0.973354 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.672512 1.601497 0.650406 2.151856 -0.448556 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-2.899, 2.769]
[DEBUG] Output sample values: -0.673 1.601 0.650 2.152 -0.449 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 321 (score: 2.3, target_len: 6) [Top scores: 234:2.8 785:2.4 321:2.3 702:2.2 676:2.2 ]
[DEBUG] Forward - source: 7 tokens, target: 2 tokens
[ENCODER] Starting encode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 35 1 1 35 
[EMBEDDING] Stats: 896/896 non-zero values, sum=4.5, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 896/896 non-zero, sum=4.524219
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[ENCODER] SCALED EMBEDS before add: 896/896 non-zero, sum=51.185696
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 896/896 non-zero, sum=96.112022
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.270815 -1.176053 1.402392 0.279803 -0.622608 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.009330, variance=3.188168, stddev=1.785547
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 882/1792 range: [0.000000, 1.487870]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.717552, 0.697537]
[FEEDFORWARD] Sample values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013440, variance=1.069198, stddev=1.034025
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 0 output: 896/896 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.239184 -1.292623 1.284681 0.373093 -0.765231 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.342615, stddev=1.828285
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 880/1792 range: [0.000000, 1.459550]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.644031, 0.786942]
[FEEDFORWARD] Sample values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013904, variance=1.172253, stddev=1.082711
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.253094 -1.408303 1.271685 0.484413 -0.872904 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 1 output: 896/896 non-zero, sum=-0.000005
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 7x128
[DEBUG] Encoder sample values: -0.253 -1.408 1.272 0.484 -0.873 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 321 
[EMBEDDING] Stats: 256/256 non-zero values, sum=-1.329, range=[-0.142, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=-1.329265
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=-15.038918
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 256/256 non-zero, sum=-2.232896
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.224773 -1.417107 1.204399 0.469412 -0.890308 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.643749 -2.656573 3.766376 0.734749 -1.541286 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.643749 -2.656573 3.766376 0.734749 -1.541286 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.684079, stddev=1.919398
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.335391 -1.384066 1.962270 0.382802 -0.803005 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 232/512 range: [0.000000, 1.495580]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.481767, 0.709899]
[FEEDFORWARD] Sample values: 0.055701 -0.104683 -0.170140 0.085796 -0.166661 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.335391 -1.384066 1.962270 0.382802 -0.803005 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.055701 -0.104683 -0.170140 0.085796 -0.166661 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.279690 -1.488749 1.792130 0.468598 -0.969665 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.279690 -1.488749 1.792130 0.468598 -0.969665 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015328, variance=1.170349, stddev=1.081831
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.244366 -1.361970 1.670739 0.447321 -0.882150 
[DECODER] Layer 0 output: 256/256 non-zero, sum=-0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.244366 -1.361970 1.670739 0.447321 -0.882150 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.244366 -1.361970 1.670739 0.447321 -0.882150 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.488732 -2.723939 3.341477 0.894641 -1.764301 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.488732 -2.723939 3.341477 0.894641 -1.764301 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.244367 -1.361974 1.670744 0.447322 -0.882153 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.244367 -1.361974 1.670744 0.447322 -0.882153 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.187234 -1.428778 1.115210 0.449529 -0.913377 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.431601 -2.790751 2.785954 0.896851 -1.795530 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.431601 -2.790751 2.785954 0.896851 -1.795530 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.738986, stddev=1.933648
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.223206 -1.443257 1.440776 0.463813 -0.928571 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 231/512 range: [0.000000, 1.500695]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.525542, 0.939722]
[FEEDFORWARD] Sample values: 0.133272 -0.156194 -0.193442 0.076544 -0.238271 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.223206 -1.443257 1.440776 0.463813 -0.928571 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.133272 -0.156194 -0.193442 0.076544 -0.238271 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.089934 -1.599451 1.247334 0.540357 -1.166842 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.089934 -1.599451 1.247334 0.540357 -1.166842 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014590, variance=1.274575, stddev=1.128975
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.066737 -1.403805 1.117760 0.491549 -1.020618 
[DECODER] Layer 1 output: 256/256 non-zero, sum=-0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.067 -1.404 1.118 0.492 -1.021 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.066737 -1.403805 1.117760 0.491549 -1.020618 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.640995 1.547145 0.743655 2.155681 -0.383735 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-2.831, 2.747]
[DEBUG] Output sample values: -0.641 1.547 0.744 2.156 -0.384 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 524 (score: 2.6, target_len: 6) [Top scores: 524:2.6 698:2.3 829:2.2 386:2.2 586:2.1 ]
[DEBUG] Forward - source: 7 tokens, target: 3 tokens
[ENCODER] Starting encode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 35 1 1 35 
[EMBEDDING] Stats: 896/896 non-zero values, sum=4.5, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 896/896 non-zero, sum=4.524219
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[ENCODER] SCALED EMBEDS before add: 896/896 non-zero, sum=51.185696
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 896/896 non-zero, sum=96.112022
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.270815 -1.176053 1.402392 0.279803 -0.622608 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.009330, variance=3.188168, stddev=1.785547
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 882/1792 range: [0.000000, 1.487870]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.717552, 0.697537]
[FEEDFORWARD] Sample values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013440, variance=1.069198, stddev=1.034025
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 0 output: 896/896 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.239184 -1.292623 1.284681 0.373093 -0.765231 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.342615, stddev=1.828285
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 880/1792 range: [0.000000, 1.459550]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.644031, 0.786942]
[FEEDFORWARD] Sample values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013904, variance=1.172253, stddev=1.082711
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.253094 -1.408303 1.271685 0.484413 -0.872904 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 1 output: 896/896 non-zero, sum=-0.000005
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 7x128
[DEBUG] Encoder sample values: -0.253 -1.408 1.272 0.484 -0.873 
[DECODER] Starting decode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 321 524 
[EMBEDDING] Stats: 384/384 non-zero values, sum=-1.034, range=[-0.144, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 384/384 non-zero, sum=-1.034368
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[DECODER] SCALED EMBEDS before add: 384/384 non-zero, sum=-11.702534
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 384/384 non-zero, sum=7.515536
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.226581 -1.400057 1.177054 0.464502 -0.895021 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.645557 -2.639523 3.739032 0.729838 -1.545999 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.645557 -2.639523 3.739032 0.729838 -1.545999 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.554572, stddev=1.885360
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.342405 -1.400010 1.983193 0.387108 -0.820002 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 362/768 range: [0.000000, 1.296385]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.662328, 0.706983]
[FEEDFORWARD] Sample values: 0.049086 -0.104109 -0.171892 0.079106 -0.161270 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.342405 -1.400010 1.983193 0.387108 -0.820002 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.049086 -0.104109 -0.171892 0.079106 -0.161270 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.293320 -1.504119 1.811301 0.466214 -0.981273 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.293320 -1.504119 1.811301 0.466214 -0.981273 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015026, variance=1.170177, stddev=1.081752
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.257262 -1.376558 1.688305 0.444871 -0.893224 
[DECODER] Layer 0 output: 384/384 non-zero, sum=-0.000006
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.257262 -1.376558 1.688305 0.444871 -0.893224 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.257262 -1.376558 1.688305 0.444871 -0.893224 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.514525 -2.753115 3.376611 0.889742 -1.786448 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.514525 -2.753115 3.376611 0.889742 -1.786448 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.257263 -1.376562 1.688311 0.444872 -0.893227 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.257263 -1.376562 1.688311 0.444872 -0.893227 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.191402 -1.403567 1.079221 0.443225 -0.919263 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.448665 -2.780129 2.767532 0.888097 -1.812490 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.448665 -2.780129 2.767532 0.888097 -1.812490 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.566846, stddev=1.888612
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.237563 -1.472049 1.465379 0.470238 -0.959694 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 357/768 range: [0.000000, 1.324016]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.485965, 0.825901]
[FEEDFORWARD] Sample values: 0.127483 -0.158300 -0.197459 0.071147 -0.229564 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.237563 -1.472049 1.465379 0.470238 -0.959694 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.127483 -0.158300 -0.197459 0.071147 -0.229564 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.110080 -1.630349 1.267919 0.541385 -1.189258 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.110080 -1.630349 1.267919 0.541385 -1.189258 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013858, variance=1.275368, stddev=1.129327
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.085203 -1.431376 1.134993 0.491659 -1.040797 
[DECODER] Layer 1 output: 384/384 non-zero, sum=-0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 3x128
[DEBUG] Decoder sample values: -0.085 -1.431 1.135 0.492 -1.041 
[LINEAR] Forward 3x128 -> 3x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.085203 -1.431376 1.134993 0.491659 -1.040797 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.668180 1.561213 0.803624 2.117944 -0.380264 
[DEBUG] Output projection - shape: 3x1000
[DEBUG] Output range: [-2.828, 2.941]
[DEBUG] Output sample values: -0.668 1.561 0.804 2.118 -0.380 
[DEBUG] Forward completed!
[GEN] Step 2 - Best token: 943 (score: 2.9, target_len: 6) [Top scores: 943:2.9 237:2.9 268:2.8 390:2.5 195:2.5 ]
[DEBUG] Forward - source: 7 tokens, target: 4 tokens
[ENCODER] Starting encode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 35 1 1 35 
[EMBEDDING] Stats: 896/896 non-zero values, sum=4.5, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 896/896 non-zero, sum=4.524219
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[ENCODER] SCALED EMBEDS before add: 896/896 non-zero, sum=51.185696
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 896/896 non-zero, sum=96.112022
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.270815 -1.176053 1.402392 0.279803 -0.622608 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.009330, variance=3.188168, stddev=1.785547
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 882/1792 range: [0.000000, 1.487870]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.717552, 0.697537]
[FEEDFORWARD] Sample values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013440, variance=1.069198, stddev=1.034025
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 0 output: 896/896 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.239184 -1.292623 1.284681 0.373093 -0.765231 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.342615, stddev=1.828285
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 880/1792 range: [0.000000, 1.459550]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.644031, 0.786942]
[FEEDFORWARD] Sample values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013904, variance=1.172253, stddev=1.082711
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.253094 -1.408303 1.271685 0.484413 -0.872904 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 1 output: 896/896 non-zero, sum=-0.000005
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 7x128
[DEBUG] Encoder sample values: -0.253 -1.408 1.272 0.484 -0.873 
[DECODER] Starting decode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 321 524 943 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-1.532, range=[-0.145, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 512/512 non-zero, sum=-1.531776
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[DECODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-17.330059
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 512/512 non-zero, sum=8.306070
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.228249 -1.384319 1.151815 0.459968 -0.899371 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.647225 -2.623785 3.713793 0.725305 -1.550349 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.647225 -2.623785 3.713793 0.725305 -1.550349 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.439689, stddev=1.854643
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.348976 -1.414712 2.002430 0.391075 -0.835929 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 477/1024 range: [0.000000, 1.544869]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.667034, 0.703079]
[FEEDFORWARD] Sample values: 0.042654 -0.103594 -0.173104 0.071795 -0.156985 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.348976 -1.414712 2.002430 0.391075 -0.835929 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.042654 -0.103594 -0.173104 0.071795 -0.156985 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.306322 -1.518307 1.829326 0.462870 -0.992913 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.306322 -1.518307 1.829326 0.462870 -0.992913 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014773, variance=1.169894, stddev=1.081621
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.269548 -1.390074 1.704941 0.441599 -0.904328 
[DECODER] Layer 0 output: 512/512 non-zero, sum=0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.269548 -1.390074 1.704941 0.441599 -0.904328 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.269548 -1.390074 1.704941 0.441599 -0.904328 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.539096 -2.780149 3.409882 0.883199 -1.808656 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.539096 -2.780149 3.409882 0.883199 -1.808656 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.269549 -1.390079 1.704946 0.441601 -0.904331 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.269549 -1.390079 1.704946 0.441601 -0.904331 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.195481 -1.379136 1.044465 0.437141 -0.924938 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.465030 -2.769215 2.749411 0.878742 -1.829268 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.465030 -2.769215 2.749411 0.878742 -1.829268 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.413690, stddev=1.847620
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.251691 -1.498801 1.488082 0.475607 -0.990067 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 481/1024 range: [0.000000, 1.421751]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.522842, 0.824596]
[FEEDFORWARD] Sample values: 0.120622 -0.160935 -0.202383 0.065159 -0.221283 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.251691 -1.498801 1.488082 0.475607 -0.990067 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.120622 -0.160935 -0.202383 0.065159 -0.221283 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.131070 -1.659736 1.285699 0.540767 -1.211350 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.131070 -1.659736 1.285699 0.540767 -1.211350 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012979, variance=1.276331, stddev=1.129753
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.104528 -1.457626 1.149524 0.490147 -1.060738 
[DECODER] Layer 1 output: 512/512 non-zero, sum=-0.000004
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 4x128
[DEBUG] Decoder sample values: -0.105 -1.458 1.150 0.490 -1.061 
[LINEAR] Forward 4x128 -> 4x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.104528 -1.457626 1.149524 0.490147 -1.060738 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.696021 1.573488 0.863829 2.077825 -0.374768 
[DEBUG] Output projection - shape: 4x1000
[DEBUG] Output range: [-2.821, 3.153]
[DEBUG] Output sample values: -0.696 1.573 0.864 2.078 -0.375 
[DEBUG] Forward completed!
[DEBUG] Forward - source: 7 tokens, target: 5 tokens
[ENCODER] Starting encode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 35 1 1 35 
[EMBEDDING] Stats: 896/896 non-zero values, sum=4.524, range=[-0.145, 0.145]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 896/896 non-zero, sum=4.524219
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[ENCODER] SCALED EMBEDS before add: 896/896 non-zero, sum=51.185696
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 896/896 non-zero, sum=96.112022
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.270815 -1.176053 1.402392 0.279803 -0.622608 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.009330, variance=3.188168, stddev=1.785547
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 882/1792 range: [0.000000, 1.487870]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.717552, 0.697537]
[FEEDFORWARD] Sample values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013440, variance=1.069198, stddev=1.034025
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 0 output: 896/896 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.239184 -1.292623 1.284681 0.373093 -0.765231 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.342615, stddev=1.828285
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 880/1792 range: [0.000000, 1.459550]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.644031, 0.786942]
[FEEDFORWARD] Sample values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013904, variance=1.172253, stddev=1.082711
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.253094 -1.408303 1.271685 0.484413 -0.872904 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 1 output: 896/896 non-zero, sum=-0.000005
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 7x128
[DEBUG] Encoder sample values: -0.253 -1.408 1.272 0.484 -0.873 
[DECODER] Starting decode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 321 524 943 154 
[EMBEDDING] Stats: 640/640 non-zero values, sum=-0.664, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 640/640 non-zero, sum=-0.664269
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[DECODER] SCALED EMBEDS before add: 640/640 non-zero, sum=-7.515336
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 640/640 non-zero, sum=24.544849
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.203633 -1.392923 1.095154 0.447267 -0.914162 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.622609 -2.632389 3.657132 0.712603 -1.565140 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.622609 -2.632389 3.657132 0.712603 -1.565140 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.354203, stddev=1.831451
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.339954 -1.437325 1.996849 0.389092 -0.854590 
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 608/1280 range: [0.000000, 1.481762]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.653793, 0.698705]
[FEEDFORWARD] Sample values: 0.042034 -0.107299 -0.171912 0.071688 -0.154812 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.339954 -1.437325 1.996849 0.389092 -0.854590 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.042034 -0.107299 -0.171912 0.071688 -0.154812 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.297920 -1.544624 1.824937 0.460781 -1.009402 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.297920 -1.544624 1.824937 0.460781 -1.009402 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014394, variance=1.169016, stddev=1.081215
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.262229 -1.415287 1.701171 0.439482 -0.920268 
[DECODER] Layer 0 output: 640/640 non-zero, sum=0.000006
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.262229 -1.415287 1.701171 0.439482 -0.920268 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.262229 -1.415287 1.701171 0.439482 -0.920268 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.524458 -2.830574 3.402342 0.878965 -1.840535 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.524458 -2.830574 3.402342 0.878965 -1.840535 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999967, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.262230 -1.415291 1.701176 0.439484 -0.920270 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.262230 -1.415291 1.701176 0.439484 -0.920270 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.139814 -1.399433 0.917947 0.408717 -0.958088 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.402044 -2.814723 2.619123 0.848201 -1.878358 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.402044 -2.814723 2.619123 0.848201 -1.878358 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.254091, stddev=1.803913
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.222873 -1.560344 1.451912 0.470200 -1.041269 
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 609/1280 range: [0.000000, 1.312209]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.562173, 0.816697]
[FEEDFORWARD] Sample values: 0.120023 -0.176604 -0.201227 0.067068 -0.213971 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.222873 -1.560344 1.451912 0.470200 -1.041269 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.120023 -0.176604 -0.201227 0.067068 -0.213971 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.102850 -1.736948 1.250685 0.537268 -1.255239 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.102850 -1.736948 1.250685 0.537268 -1.255239 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.011758, variance=1.274105, stddev=1.128767
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.080701 -1.528383 1.118427 0.486395 -1.101627 
[DECODER] Layer 1 output: 640/640 non-zero, sum=0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 5x128
[DEBUG] Decoder sample values: -0.081 -1.528 1.118 0.486 -1.102 
[LINEAR] Forward 5x128 -> 5x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.080701 -1.528383 1.118427 0.486395 -1.101627 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.662929 1.517065 0.948133 2.081707 -0.313591 
[DEBUG] Output projection - shape: 5x1000
[DEBUG] Output range: [-2.749, 3.162]
[DEBUG] Output sample values: -0.663 1.517 0.948 2.082 -0.314 
[DEBUG] Forward completed!
[DEBUG] Forward - source: 7 tokens, target: 6 tokens
[ENCODER] Starting encode with 7 tokens
[EMBEDDING] Forward pass - seq_len=7, d_model=128
[EMBEDDING] Input tokens: 2 35 1 1 35 
[EMBEDDING] Stats: 896/896 non-zero values, sum=4.524, range=[-0.145, 0.145]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 896/896 non-zero, sum=4.524219
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 832/896 non-zero, sum=44.926334
[ENCODER] SCALED EMBEDS before add: 896/896 non-zero, sum=51.185696
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 896/896 non-zero, sum=96.112022
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.270815 -1.176053 1.402392 0.279803 -0.622608 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.677685 -2.381925 2.919080 0.545399 -1.255919 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.009330, variance=3.188168, stddev=1.785547
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 882/1792 range: [0.000000, 1.487870]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.717552, 0.697537]
[FEEDFORWARD] Sample values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384764 -1.339228 1.629613 0.300227 -0.708606 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.011186 -0.035851 -0.097887 0.103180 -0.060375 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.395950 -1.375080 1.531725 0.403406 -0.768981 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013440, variance=1.069198, stddev=1.034025
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 0 output: 896/896 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 896/896 non-zero
[ENCODER_LAYER] After self-attention: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.369923 -1.316834 1.494321 0.403130 -0.730680 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.239184 -1.292623 1.284681 0.373093 -0.765231 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.609107 -2.609457 2.779002 0.776223 -1.495910 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.342615, stddev=1.828285
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[ENCODER_LAYER] After norm1: 896/896 non-zero
[FEEDFORWARD] Forward pass: 7x128 -> 7x256 -> 7x128
[FEEDFORWARD] Input non-zero: 896/896
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 880/1792 range: [0.000000, 1.459550]
[FEEDFORWARD] Output non-zero: 896/896 range: [-0.644031, 0.786942]
[FEEDFORWARD] Sample values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[ENCODER_LAYER] After feedforward: 896/896 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.333158 -1.427271 1.520005 0.424563 -0.818204 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045226 -0.111419 -0.157042 0.086012 -0.140803 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.287932 -1.538689 1.362963 0.510575 -0.959007 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013904, variance=1.172253, stddev=1.082711
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.253094 -1.408303 1.271685 0.484413 -0.872904 
[ENCODER_LAYER] Final output: 896/896 non-zero
[ENCODER] Layer 1 output: 896/896 non-zero, sum=-0.000005
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 7x128
[DEBUG] Encoder sample values: -0.253 -1.408 1.272 0.484 -0.873 
[DECODER] Starting decode with 6 tokens
[EMBEDDING] Forward pass - seq_len=6, d_model=128
[EMBEDDING] Input tokens: 2 321 524 943 154 
[EMBEDDING] Stats: 768/768 non-zero values, sum=0.158, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 768/768 non-zero, sum=0.157676
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 704/768 non-zero, sum=38.490261
[DECODER] SCALED EMBEDS before add: 768/768 non-zero, sum=1.783902
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 768/768 non-zero, sum=40.274162
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.206018 -1.378463 1.074499 0.443646 -0.917540 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.624994 -2.617929 3.636477 0.708982 -1.568518 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.624994 -2.617929 3.636477 0.708982 -1.568518 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.259444, stddev=1.805396
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.346181 -1.450058 2.014227 0.392702 -0.868794 
[FEEDFORWARD] Forward pass: 6x128 -> 6x256 -> 6x128
[FEEDFORWARD] Input non-zero: 768/768
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 735/1536 range: [0.000000, 1.491768]
[FEEDFORWARD] Output non-zero: 768/768 range: [-0.659095, 0.694448]
[FEEDFORWARD] Sample values: 0.036155 -0.107203 -0.172954 0.064479 -0.151314 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.346181 -1.450058 2.014227 0.392702 -0.868794 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.036155 -0.107203 -0.172954 0.064479 -0.151314 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.310026 -1.557261 1.841273 0.457181 -1.020108 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.310026 -1.557261 1.841273 0.457181 -1.020108 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014171, variance=1.168630, stddev=1.081037
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.273677 -1.427417 1.716356 0.436018 -0.930530 
[DECODER] Layer 0 output: 768/768 non-zero, sum=0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.273677 -1.427417 1.716356 0.436018 -0.930530 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.273677 -1.427417 1.716356 0.436018 -0.930530 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.547354 -2.854834 3.432712 0.872037 -1.861060 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.547354 -2.854834 3.432712 0.872037 -1.861060 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999963, stddev=1.999993
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.273678 -1.427422 1.716362 0.436020 -0.930533 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.273678 -1.427422 1.716362 0.436020 -0.930533 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.146278 -1.376405 0.892976 0.404658 -0.961537 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.419955 -2.803827 2.609338 0.840677 -1.892070 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.419955 -2.803827 2.609338 0.840677 -1.892070 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.141271, stddev=1.772366
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.236946 -1.581968 1.472234 0.474325 -1.067539 
[FEEDFORWARD] Forward pass: 6x128 -> 6x256 -> 6x128
[FEEDFORWARD] Input non-zero: 768/768
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 726/1536 range: [0.000000, 1.358939]
[FEEDFORWARD] Output non-zero: 768/768 range: [-0.536533, 0.811759]
[FEEDFORWARD] Sample values: 0.111642 -0.176763 -0.206484 0.056781 -0.204961 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.236946 -1.581968 1.472234 0.474325 -1.067539 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.111642 -0.176763 -0.206484 0.056781 -0.204961 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.125304 -1.758731 1.265750 0.531106 -1.272501 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.125304 -1.758731 1.265750 0.531106 -1.272501 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.011132, variance=1.274283, stddev=1.128846
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.101141 -1.548130 1.131139 0.480347 -1.117397 
[DECODER] Layer 1 output: 768/768 non-zero, sum=-0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 6x128
[DEBUG] Decoder sample values: -0.101 -1.548 1.131 0.480 -1.117 
[LINEAR] Forward 6x128 -> 6x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.101141 -1.548130 1.131139 0.480347 -1.117397 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.690133 1.526087 1.001464 2.041017 -0.308533 
[DEBUG] Output projection - shape: 6x1000
[DEBUG] Output range: [-2.737, 3.308]
[DEBUG] Output sample values: -0.690 1.526 1.001 2.041 -0.309 
[DEBUG] Forward completed!
  ENG: <sos> your <unk> <unk> your <unk> <eos>
  ESP: <sos> mientras hija jefe ingl har <eos>
  ================================

¡Entrenamiento completado!

=== Pruebas de Traducción ===
[DEBUG] Forward - source: 3 tokens, target: 1 tokens
[ENCODER] Starting encode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 1 3 
[EMBEDDING] Stats: 384/384 non-zero values, sum=1.585, range=[-0.145, 0.145]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 384/384 non-zero, sum=1.584633
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[ENCODER] SCALED EMBEDS before add: 384/384 non-zero, sum=17.928062
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 384/384 non-zero, sum=37.146149
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 384/384 non-zero
[ENCODER_LAYER] After self-attention: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.338452 -1.200277 1.487380 0.286078 -0.572657 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.745321 -2.406148 3.004068 0.551675 -1.205968 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.745321 -2.406148 3.004068 0.551675 -1.205968 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000581, variance=3.472204, stddev=1.863388
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.399670 -1.290965 1.612466 0.296372 -0.646879 
[ENCODER_LAYER] After norm1: 384/384 non-zero
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 390/768 range: [0.000000, 1.375042]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.726275, 0.653329]
[FEEDFORWARD] Sample values: -0.002441 -0.039112 -0.095105 0.117191 -0.067723 
[ENCODER_LAYER] After feedforward: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.399670 -1.290965 1.612466 0.296372 -0.646879 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.002441 -0.039112 -0.095105 0.117191 -0.067723 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.402111 -1.330076 1.517361 0.413562 -0.714603 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.402111 -1.330076 1.517361 0.413562 -0.714603 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014712, variance=1.068156, stddev=1.033521
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.374834 -1.272702 1.482381 0.414383 -0.677191 
[ENCODER_LAYER] Final output: 384/384 non-zero
[ENCODER] Layer 0 output: 384/384 non-zero, sum=-0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 384/384 non-zero
[ENCODER_LAYER] After self-attention: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.374834 -1.272702 1.482381 0.414383 -0.677191 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.312708 -1.261466 1.443665 0.419646 -0.629345 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.687542 -2.534168 2.926046 0.834029 -1.306536 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.687542 -2.534168 2.926046 0.834029 -1.306536 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.742684, stddev=1.934604
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.355392 -1.309915 1.512478 0.431111 -0.675350 
[ENCODER_LAYER] After norm1: 384/384 non-zero
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 371/768 range: [0.000000, 1.384555]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.688355, 0.725734]
[FEEDFORWARD] Sample values: 0.061499 -0.102350 -0.150659 0.104766 -0.165294 
[ENCODER_LAYER] After feedforward: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.355392 -1.309915 1.512478 0.431111 -0.675350 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.061499 -0.102350 -0.150659 0.104766 -0.165294 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.293893 -1.412266 1.361819 0.535876 -0.840644 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.293893 -1.412266 1.361819 0.535876 -0.840644 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.016684, variance=1.169646, stddev=1.081506
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.256318 -1.290406 1.274613 0.510917 -0.761864 
[ENCODER_LAYER] Final output: 384/384 non-zero
[ENCODER] Layer 1 output: 384/384 non-zero, sum=0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 3x128
[DEBUG] Encoder sample values: -0.256 -1.290 1.275 0.511 -0.762 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=-0.545, range=[-0.142, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=-0.544556
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=-6.160941
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 128/128 non-zero, sum=0.239059
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.256318 -1.290406 1.274613 0.510917 -0.761864 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.675294 -2.529872 3.836591 0.776254 -1.412842 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.675294 -2.529872 3.836591 0.776254 -1.412842 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.811648, stddev=1.952347
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.345888 -1.295811 1.965118 0.397600 -0.723664 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 115/256 range: [0.000000, 1.281305]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.464788, 0.714413]
[FEEDFORWARD] Sample values: 0.065685 -0.095825 -0.167797 0.092251 -0.184674 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.345888 -1.295811 1.965118 0.397600 -0.723664 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.065685 -0.095825 -0.167797 0.092251 -0.184674 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.280204 -1.391636 1.797320 0.489851 -0.908337 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.280204 -1.391636 1.797320 0.489851 -0.908337 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.017234, variance=1.169736, stddev=1.081548
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.243142 -1.270772 1.677738 0.468851 -0.823914 
[DECODER] Layer 0 output: 128/128 non-zero, sum=0.000003
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.243142 -1.270772 1.677738 0.468851 -0.823914 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.243142 -1.270772 1.677738 0.468851 -0.823914 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.486284 -2.541545 3.355476 0.937703 -1.647829 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.486284 -2.541545 3.355476 0.937703 -1.647829 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.243143 -1.270776 1.677743 0.468853 -0.823917 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.243143 -1.270776 1.677743 0.468853 -0.823917 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.256318 -1.290406 1.274613 0.510917 -0.761864 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.499461 -2.561182 2.952357 0.979770 -1.585781 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.499461 -2.561182 2.952357 0.979770 -1.585781 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.997686, stddev=1.999424
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.249802 -1.280960 1.476604 0.490026 -0.793119 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 114/256 range: [0.000000, 1.159389]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.466848, 0.840208]
[FEEDFORWARD] Sample values: 0.135812 -0.125957 -0.184280 0.074331 -0.260738 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.249802 -1.280960 1.476604 0.490026 -0.793119 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.135812 -0.125957 -0.184280 0.074331 -0.260738 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.113990 -1.406917 1.292324 0.564357 -1.053857 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.113990 -1.406917 1.292324 0.564357 -1.053857 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.017631, variance=1.276447, stddev=1.129804
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.085288 -1.229670 1.159453 0.515123 -0.917173 
[DECODER] Layer 1 output: 128/128 non-zero, sum=-0.000000
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.085 -1.230 1.159 0.515 -0.917 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.085288 -1.229670 1.159453 0.515123 -0.917173 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.642358 1.644402 0.528735 2.185958 -0.502614 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-2.966, 2.819]
[DEBUG] Output sample values: -0.642 1.644 0.529 2.186 -0.503 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 234 (score: 2.8, target_len: 2) [Top scores: 234:2.8 321:2.4 785:2.4 676:2.2 3:2.2 ]
[DEBUG] Forward - source: 3 tokens, target: 2 tokens
[ENCODER] Starting encode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 1 3 
[EMBEDDING] Stats: 384/384 non-zero values, sum=1.6, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 384/384 non-zero, sum=1.584633
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[ENCODER] SCALED EMBEDS before add: 384/384 non-zero, sum=17.928062
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 384/384 non-zero, sum=37.146149
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 384/384 non-zero
[ENCODER_LAYER] After self-attention: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.338452 -1.200277 1.487380 0.286078 -0.572657 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.745321 -2.406148 3.004068 0.551675 -1.205968 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.745321 -2.406148 3.004068 0.551675 -1.205968 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000581, variance=3.472204, stddev=1.863388
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.399670 -1.290965 1.612466 0.296372 -0.646879 
[ENCODER_LAYER] After norm1: 384/384 non-zero
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 390/768 range: [0.000000, 1.375042]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.726275, 0.653329]
[FEEDFORWARD] Sample values: -0.002441 -0.039112 -0.095105 0.117191 -0.067723 
[ENCODER_LAYER] After feedforward: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.399670 -1.290965 1.612466 0.296372 -0.646879 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.002441 -0.039112 -0.095105 0.117191 -0.067723 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.402111 -1.330076 1.517361 0.413562 -0.714603 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.402111 -1.330076 1.517361 0.413562 -0.714603 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014712, variance=1.068156, stddev=1.033521
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.374834 -1.272702 1.482381 0.414383 -0.677191 
[ENCODER_LAYER] Final output: 384/384 non-zero
[ENCODER] Layer 0 output: 384/384 non-zero, sum=-0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 384/384 non-zero
[ENCODER_LAYER] After self-attention: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.374834 -1.272702 1.482381 0.414383 -0.677191 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.312708 -1.261466 1.443665 0.419646 -0.629345 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.687542 -2.534168 2.926046 0.834029 -1.306536 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.687542 -2.534168 2.926046 0.834029 -1.306536 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.742684, stddev=1.934604
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.355392 -1.309915 1.512478 0.431111 -0.675350 
[ENCODER_LAYER] After norm1: 384/384 non-zero
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 371/768 range: [0.000000, 1.384555]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.688355, 0.725734]
[FEEDFORWARD] Sample values: 0.061499 -0.102350 -0.150659 0.104766 -0.165294 
[ENCODER_LAYER] After feedforward: 384/384 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.355392 -1.309915 1.512478 0.431111 -0.675350 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.061499 -0.102350 -0.150659 0.104766 -0.165294 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.293893 -1.412266 1.361819 0.535876 -0.840644 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.293893 -1.412266 1.361819 0.535876 -0.840644 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.016684, variance=1.169646, stddev=1.081506
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.256318 -1.290406 1.274613 0.510917 -0.761864 
[ENCODER_LAYER] Final output: 384/384 non-zero
[ENCODER] Layer 1 output: 384/384 non-zero, sum=0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 3x128
[DEBUG] Encoder sample values: -0.256 -1.290 1.275 0.511 -0.762 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 234 
[EMBEDDING] Stats: 256/256 non-zero values, sum=-1.773, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=-1.773005
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=-20.059258
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 256/256 non-zero, sum=-7.253235
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.255054 -1.274055 1.247528 0.506219 -0.764865 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.674030 -2.513521 3.809506 0.771556 -1.415843 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.674030 -2.513521 3.809506 0.771556 -1.415843 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.649520, stddev=1.910374
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.352826 -1.315722 1.994115 0.403877 -0.741134 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 232/512 range: [0.000000, 1.274992]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.467203, 0.713609]
[FEEDFORWARD] Sample values: 0.057379 -0.094746 -0.170642 0.085186 -0.177764 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.352826 -1.315722 1.994115 0.403877 -0.741134 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.057379 -0.094746 -0.170642 0.085186 -0.177764 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.295448 -1.410468 1.823473 0.489063 -0.918898 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.295448 -1.410468 1.823473 0.489063 -0.918898 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.016897, variance=1.169349, stddev=1.081369
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.257590 -1.288709 1.701889 0.467889 -0.834129 
[DECODER] Layer 0 output: 256/256 non-zero, sum=-0.000003
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.257590 -1.288709 1.701889 0.467889 -0.834129 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.257590 -1.288709 1.701889 0.467889 -0.834129 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.515181 -2.577419 3.403779 0.935777 -1.668257 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.515181 -2.577419 3.403779 0.935777 -1.668257 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.257591 -1.288713 1.701894 0.467890 -0.834131 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.257591 -1.288713 1.701894 0.467890 -0.834131 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.254689 -1.269330 1.239702 0.504862 -0.765732 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.512280 -2.558043 2.941596 0.972752 -1.599863 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.512280 -2.558043 2.941596 0.972752 -1.599863 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.786615, stddev=1.945925
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.263258 -1.314564 1.511670 0.499892 -0.822161 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 231/512 range: [0.000000, 1.293329]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.520942, 0.843291]
[FEEDFORWARD] Sample values: 0.126193 -0.128921 -0.190837 0.065564 -0.254293 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.263258 -1.314564 1.511670 0.499892 -0.822161 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.126193 -0.128921 -0.190837 0.065564 -0.254293 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.137065 -1.443485 1.320833 0.565455 -1.076454 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.137065 -1.443485 1.320833 0.565455 -1.076454 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.016992, variance=1.277721, stddev=1.130368
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.106225 -1.261973 1.183530 0.515272 -0.937272 
[DECODER] Layer 1 output: 256/256 non-zero, sum=0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.106 -1.262 1.184 0.515 -0.937 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.106225 -1.261973 1.183530 0.515272 -0.937272 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.676478 1.664820 0.593033 2.149673 -0.507628 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-2.979, 2.786]
[DEBUG] Output sample values: -0.676 1.665 0.593 2.150 -0.508 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 3 (score: 6.6, target_len: 2) [Top scores: 3:6.6 268:2.4 676:2.4 798:2.2 651:2.2 ]
ENG: <sos> hello <eos>
ESP: <sos> tener <eos>
---
[DEBUG] Forward - source: 5 tokens, target: 1 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 53 25 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=1.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=1.148474
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=12.993499
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 640/640 non-zero, sum=45.053699
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.355630 -1.035425 1.303980 0.025593 -0.567799 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.762499 -2.241297 2.820668 0.291189 -1.201109 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.762499 -2.241297 2.820668 0.291189 -1.201109 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000209, variance=3.106444, stddev=1.762513
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.432739 -1.271767 1.600248 0.165094 -0.681594 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 633/1280 range: [0.000000, 1.388452]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.705881, 0.700133]
[FEEDFORWARD] Sample values: 0.020190 -0.033349 -0.096322 0.141338 -0.084389 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.432739 -1.271767 1.600248 0.165094 -0.681594 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.020190 -0.033349 -0.096322 0.141338 -0.084389 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.412549 -1.305116 1.503926 0.306432 -0.765984 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.412549 -1.305116 1.503926 0.306432 -0.765984 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013007, variance=1.061146, stddev=1.030124
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.387858 -1.254323 1.472572 0.310097 -0.730957 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.387858 -1.254323 1.472572 0.310097 -0.730957 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.309348 -1.034984 1.218093 0.006553 -0.677724 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.697206 -2.289307 2.690665 0.316650 -1.408682 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.697206 -2.289307 2.690665 0.316650 -1.408682 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.285763, stddev=1.812670
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384629 -1.262947 1.484366 0.174687 -0.777131 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 625/1280 range: [0.000000, 1.337204]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.663611, 0.730416]
[FEEDFORWARD] Sample values: 0.102214 -0.105888 -0.156037 0.168810 -0.200595 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384629 -1.262947 1.484366 0.174687 -0.777131 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.102214 -0.105888 -0.156037 0.168810 -0.200595 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.282416 -1.368835 1.328328 0.343497 -0.977726 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.282416 -1.368835 1.328328 0.343497 -0.977726 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012590, variance=1.154017, stddev=1.074256
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.251174 -1.262497 1.248229 0.331473 -0.898423 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.251 -1.262 1.248 0.331 -0.898 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=-0.545, range=[-0.142, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=-0.544556
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=-6.160941
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 128/128 non-zero, sum=0.239059
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.251174 -1.262497 1.248229 0.331473 -0.898423 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.670150 -2.501963 3.810207 0.596810 -1.549401 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.670150 -2.501963 3.810207 0.596810 -1.549401 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.805120, stddev=1.950674
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.343548 -1.282615 1.953277 0.305951 -0.794290 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 115/256 range: [0.000000, 1.286182]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.477626, 0.725733]
[FEEDFORWARD] Sample values: 0.077988 -0.106369 -0.176628 0.124002 -0.200014 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.343548 -1.282615 1.953277 0.305951 -0.794290 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.077988 -0.106369 -0.176628 0.124002 -0.200014 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.265560 -1.388984 1.776649 0.429953 -0.994304 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.265560 -1.388984 1.776649 0.429953 -0.994304 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015972, variance=1.163910, stddev=1.078851
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.231346 -1.272661 1.661601 0.413333 -0.906828 
[DECODER] Layer 0 output: 128/128 non-zero, sum=-0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.231346 -1.272661 1.661601 0.413333 -0.906828 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.231346 -1.272661 1.661601 0.413333 -0.906828 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.462692 -2.545321 3.323203 0.826666 -1.813655 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.462692 -2.545321 3.323203 0.826666 -1.813655 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.231347 -1.272665 1.661607 0.413334 -0.906830 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.231347 -1.272665 1.661607 0.413334 -0.906830 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.251174 -1.262497 1.248229 0.331473 -0.898423 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.482521 -2.535162 2.909836 0.744808 -1.805253 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.482521 -2.535162 2.909836 0.744808 -1.805253 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.994069, stddev=1.998519
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.241439 -1.268520 1.455996 0.372680 -0.903295 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 110/256 range: [0.000000, 1.169211]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.474228, 0.859975]
[FEEDFORWARD] Sample values: 0.148711 -0.145637 -0.206108 0.119777 -0.288669 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.241439 -1.268520 1.455996 0.372680 -0.903295 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.148711 -0.145637 -0.206108 0.119777 -0.288669 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.092728 -1.414157 1.249888 0.492456 -1.191964 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.092728 -1.414157 1.249888 0.492456 -1.191964 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.016031, variance=1.268703, stddev=1.126372
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.068092 -1.241265 1.123891 0.451438 -1.044001 
[DECODER] Layer 1 output: 128/128 non-zero, sum=-0.000000
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.068 -1.241 1.124 0.451 -1.044 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.068092 -1.241265 1.123891 0.451438 -1.044001 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.544768 1.625122 0.595808 2.227315 -0.561158 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-3.032, 2.851]
[DEBUG] Output sample values: -0.545 1.625 0.596 2.227 -0.561 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 234 (score: 2.9, target_len: 4) [Top scores: 234:2.9 321:2.6 785:2.4 386:2.3 3:2.2 ]
[DEBUG] Forward - source: 5 tokens, target: 2 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 53 25 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=1.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=1.148474
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=12.993499
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 640/640 non-zero, sum=45.053699
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.355630 -1.035425 1.303980 0.025593 -0.567799 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.762499 -2.241297 2.820668 0.291189 -1.201109 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.762499 -2.241297 2.820668 0.291189 -1.201109 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000209, variance=3.106444, stddev=1.762513
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.432739 -1.271767 1.600248 0.165094 -0.681594 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 633/1280 range: [0.000000, 1.388452]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.705881, 0.700133]
[FEEDFORWARD] Sample values: 0.020190 -0.033349 -0.096322 0.141338 -0.084389 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.432739 -1.271767 1.600248 0.165094 -0.681594 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.020190 -0.033349 -0.096322 0.141338 -0.084389 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.412549 -1.305116 1.503926 0.306432 -0.765984 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.412549 -1.305116 1.503926 0.306432 -0.765984 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013007, variance=1.061146, stddev=1.030124
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.387858 -1.254323 1.472572 0.310097 -0.730957 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.387858 -1.254323 1.472572 0.310097 -0.730957 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.309348 -1.034984 1.218093 0.006553 -0.677724 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.697206 -2.289307 2.690665 0.316650 -1.408682 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.697206 -2.289307 2.690665 0.316650 -1.408682 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.285763, stddev=1.812670
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384629 -1.262947 1.484366 0.174687 -0.777131 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 625/1280 range: [0.000000, 1.337204]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.663611, 0.730416]
[FEEDFORWARD] Sample values: 0.102214 -0.105888 -0.156037 0.168810 -0.200595 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384629 -1.262947 1.484366 0.174687 -0.777131 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.102214 -0.105888 -0.156037 0.168810 -0.200595 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.282416 -1.368835 1.328328 0.343497 -0.977726 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.282416 -1.368835 1.328328 0.343497 -0.977726 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012590, variance=1.154017, stddev=1.074256
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.251174 -1.262497 1.248229 0.331473 -0.898423 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.251 -1.262 1.248 0.331 -0.898 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 234 
[EMBEDDING] Stats: 256/256 non-zero values, sum=-1.773, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=-1.773005
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=-20.059258
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 256/256 non-zero, sum=-7.253235
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.258499 -1.254692 1.189180 0.170973 -0.808909 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.677475 -2.494158 3.751158 0.436310 -1.459887 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.677475 -2.494158 3.751158 0.436310 -1.459887 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.380108, stddev=1.838510
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.368491 -1.356619 2.040325 0.237317 -0.794060 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 230/512 range: [0.000000, 1.446067]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.533093, 0.739731]
[FEEDFORWARD] Sample values: 0.069479 -0.108221 -0.182124 0.140631 -0.224082 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.368491 -1.356619 2.040325 0.237317 -0.794060 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.069479 -0.108221 -0.182124 0.140631 -0.224082 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.299012 -1.464841 1.858201 0.377948 -1.018142 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.299012 -1.464841 1.858201 0.377948 -1.018142 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014793, variance=1.149848, stddev=1.072314
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.265052 -1.352260 1.746684 0.366256 -0.935685 
[DECODER] Layer 0 output: 256/256 non-zero, sum=-0.000004
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.265052 -1.352260 1.746684 0.366256 -0.935685 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.265052 -1.352260 1.746684 0.366256 -0.935685 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.530104 -2.704520 3.493368 0.732512 -1.871370 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.530104 -2.704520 3.493368 0.732512 -1.871370 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.265053 -1.352264 1.746689 0.366257 -0.935688 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.265053 -1.352264 1.746689 0.366257 -0.935688 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.257673 -1.255572 1.195841 0.189079 -0.819007 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.522726 -2.607836 2.942531 0.555336 -1.754695 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.522726 -2.607836 2.942531 0.555336 -1.754695 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.619532, stddev=1.902509
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.274756 -1.370735 1.546658 0.291897 -0.922305 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 219/512 range: [0.000000, 1.249467]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.481783, 0.889414]
[FEEDFORWARD] Sample values: 0.138684 -0.160770 -0.219521 0.156048 -0.310085 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.274756 -1.370735 1.546658 0.291897 -0.922305 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.138684 -0.160770 -0.219521 0.156048 -0.310085 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.136072 -1.531505 1.327137 0.447945 -1.232390 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.136072 -1.531505 1.327137 0.447945 -1.232390 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014744, variance=1.252390, stddev=1.119107
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.108414 -1.355331 1.199064 0.413445 -1.088051 
[DECODER] Layer 1 output: 256/256 non-zero, sum=-0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.108 -1.355 1.199 0.413 -1.088 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.108414 -1.355331 1.199064 0.413445 -1.088051 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.382576 1.597727 0.692999 2.181247 -0.612529 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-3.303, 2.943]
[DEBUG] Output sample values: -0.383 1.598 0.693 2.181 -0.613 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 321 (score: 2.9, target_len: 4) [Top scores: 321:2.9 283:2.5 676:2.2 896:2.2 3:2.1 ]
[DEBUG] Forward - source: 5 tokens, target: 3 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 53 25 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=1.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=1.148474
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=12.993499
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 640/640 non-zero, sum=45.053699
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.355630 -1.035425 1.303980 0.025593 -0.567799 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.762499 -2.241297 2.820668 0.291189 -1.201109 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.762499 -2.241297 2.820668 0.291189 -1.201109 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000209, variance=3.106444, stddev=1.762513
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.432739 -1.271767 1.600248 0.165094 -0.681594 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 633/1280 range: [0.000000, 1.388452]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.705881, 0.700133]
[FEEDFORWARD] Sample values: 0.020190 -0.033349 -0.096322 0.141338 -0.084389 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.432739 -1.271767 1.600248 0.165094 -0.681594 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.020190 -0.033349 -0.096322 0.141338 -0.084389 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.412549 -1.305116 1.503926 0.306432 -0.765984 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.412549 -1.305116 1.503926 0.306432 -0.765984 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013007, variance=1.061146, stddev=1.030124
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.387858 -1.254323 1.472572 0.310097 -0.730957 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.387858 -1.254323 1.472572 0.310097 -0.730957 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.309348 -1.034984 1.218093 0.006553 -0.677724 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.697206 -2.289307 2.690665 0.316650 -1.408682 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.697206 -2.289307 2.690665 0.316650 -1.408682 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.285763, stddev=1.812670
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384629 -1.262947 1.484366 0.174687 -0.777131 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 625/1280 range: [0.000000, 1.337204]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.663611, 0.730416]
[FEEDFORWARD] Sample values: 0.102214 -0.105888 -0.156037 0.168810 -0.200595 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384629 -1.262947 1.484366 0.174687 -0.777131 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.102214 -0.105888 -0.156037 0.168810 -0.200595 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.282416 -1.368835 1.328328 0.343497 -0.977726 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.282416 -1.368835 1.328328 0.343497 -0.977726 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012590, variance=1.154017, stddev=1.074256
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.251174 -1.262497 1.248229 0.331473 -0.898423 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.251 -1.262 1.248 0.331 -0.898 
[DECODER] Starting decode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 234 321 
[EMBEDDING] Stats: 384/384 non-zero values, sum=-2.558, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 384/384 non-zero, sum=-2.557715
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[DECODER] SCALED EMBEDS before add: 384/384 non-zero, sum=-28.937246
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 384/384 non-zero, sum=-9.719172
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.142099 -1.020904 1.032796 0.046318 -0.846758 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.561075 -2.260370 3.594774 0.311655 -1.497736 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.561075 -2.260370 3.594774 0.311655 -1.497736 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.136316, stddev=1.770967
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.316818 -1.276348 2.029836 0.175980 -0.845716 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 358/768 range: [0.000000, 1.377943]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.575664, 0.743181]
[FEEDFORWARD] Sample values: 0.093129 -0.111036 -0.170230 0.149557 -0.228466 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.316818 -1.276348 2.029836 0.175980 -0.845716 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.093129 -0.111036 -0.170230 0.149557 -0.228466 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.223689 -1.387383 1.859606 0.325537 -1.074182 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.223689 -1.387383 1.859606 0.325537 -1.074182 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012511, variance=1.142417, stddev=1.068844
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.197576 -1.286317 1.751535 0.316275 -0.993289 
[DECODER] Layer 0 output: 384/384 non-zero, sum=0.000004
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.197576 -1.286317 1.751535 0.316275 -0.993289 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.197576 -1.286317 1.751535 0.316275 -0.993289 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.395152 -2.572634 3.503071 0.632550 -1.986578 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.395152 -2.572634 3.503071 0.632550 -1.986578 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.197577 -1.286321 1.751541 0.316276 -0.993292 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.197577 -1.286321 1.751541 0.316276 -0.993292 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.126036 -0.990107 1.015695 0.040064 -0.857647 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.323612 -2.276427 2.767236 0.356340 -1.850939 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.323612 -2.276427 2.767236 0.356340 -1.850939 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.343914, stddev=1.828640
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.176969 -1.244874 1.513276 0.194866 -1.012194 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 348/768 range: [0.000000, 1.351334]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.468267, 0.895493]
[FEEDFORWARD] Sample values: 0.183760 -0.173638 -0.214333 0.175113 -0.323383 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.176969 -1.244874 1.513276 0.194866 -1.012194 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.183760 -0.173638 -0.214333 0.175113 -0.323383 
[MATRIX_ADD_DEBUG] Result first 5 values: 0.006791 -1.418513 1.298943 0.369979 -1.335577 
[LAYER_NORM] Input: 100/100 non-zero, first 5: 0.006791 -1.418513 1.298943 0.369979 -1.335577 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012249, variance=1.244831, stddev=1.115725
[LAYER_NORM] Output: 100/100 non-zero, first 5: 0.017065 -1.260404 1.175193 0.342583 -1.186071 
[DECODER] Layer 1 output: 384/384 non-zero, sum=0.000003
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 3x128
[DEBUG] Decoder sample values: 0.017 -1.260 1.175 0.343 -1.186 
[LINEAR] Forward 3x128 -> 3x1000
[LINEAR] Input: 100/100 non-zero, first 5: 0.017065 -1.260404 1.175193 0.342583 -1.186071 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.319126 1.533425 0.775355 2.206198 -0.630666 
[DEBUG] Output projection - shape: 3x1000
[DEBUG] Output range: [-3.241, 2.857]
[DEBUG] Output sample values: -0.319 1.533 0.775 2.206 -0.631 
[DEBUG] Forward completed!
[GEN] Step 2 - Best token: 480 (score: 2.6, target_len: 4) [Top scores: 480:2.6 524:2.6 733:2.3 576:2.0 220:2.0 ]
[DEBUG] Forward - source: 5 tokens, target: 4 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 53 25 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=1.1, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=1.148474
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=12.993499
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 640/640 non-zero, sum=45.053699
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.355630 -1.035425 1.303980 0.025593 -0.567799 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.762499 -2.241297 2.820668 0.291189 -1.201109 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.762499 -2.241297 2.820668 0.291189 -1.201109 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000209, variance=3.106444, stddev=1.762513
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.432739 -1.271767 1.600248 0.165094 -0.681594 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 633/1280 range: [0.000000, 1.388452]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.705881, 0.700133]
[FEEDFORWARD] Sample values: 0.020190 -0.033349 -0.096322 0.141338 -0.084389 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.432739 -1.271767 1.600248 0.165094 -0.681594 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.020190 -0.033349 -0.096322 0.141338 -0.084389 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.412549 -1.305116 1.503926 0.306432 -0.765984 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.412549 -1.305116 1.503926 0.306432 -0.765984 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.013007, variance=1.061146, stddev=1.030124
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.387858 -1.254323 1.472572 0.310097 -0.730957 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=-0.000002
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.387858 -1.254323 1.472572 0.310097 -0.730957 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.309348 -1.034984 1.218093 0.006553 -0.677724 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.697206 -2.289307 2.690665 0.316650 -1.408682 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.697206 -2.289307 2.690665 0.316650 -1.408682 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.285763, stddev=1.812670
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.384629 -1.262947 1.484366 0.174687 -0.777131 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 625/1280 range: [0.000000, 1.337204]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.663611, 0.730416]
[FEEDFORWARD] Sample values: 0.102214 -0.105888 -0.156037 0.168810 -0.200595 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.384629 -1.262947 1.484366 0.174687 -0.777131 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.102214 -0.105888 -0.156037 0.168810 -0.200595 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.282416 -1.368835 1.328328 0.343497 -0.977726 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.282416 -1.368835 1.328328 0.343497 -0.977726 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012590, variance=1.154017, stddev=1.074256
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.251174 -1.262497 1.248229 0.331473 -0.898423 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000004
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.251 -1.262 1.248 0.331 -0.898 
[DECODER] Starting decode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 234 321 480 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-1.966, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 512/512 non-zero, sum=-1.966377
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[DECODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-22.247025
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 512/512 non-zero, sum=3.389108
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.179798 -1.014342 0.978642 0.013884 -0.843066 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.598775 -2.253808 3.540620 0.279221 -1.494044 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.598775 -2.253808 3.540620 0.279221 -1.494044 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.066482, stddev=1.751140
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.341934 -1.287052 2.021894 0.159451 -0.853184 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 487/1024 range: [0.000000, 1.416586]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.709716, 0.739450]
[FEEDFORWARD] Sample values: 0.087245 -0.113832 -0.175548 0.155065 -0.228192 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.341934 -1.287052 2.021894 0.159451 -0.853184 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.087245 -0.113832 -0.175548 0.155065 -0.228192 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.254689 -1.400884 1.846345 0.314516 -1.081375 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.254689 -1.400884 1.846345 0.314516 -1.081375 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012585, variance=1.142730, stddev=1.068990
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.226479 -1.298701 1.738960 0.305991 -0.999813 
[DECODER] Layer 0 output: 512/512 non-zero, sum=0.000006
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.226479 -1.298701 1.738960 0.305991 -0.999813 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.226479 -1.298701 1.738960 0.305991 -0.999813 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.452958 -2.597402 3.477919 0.611982 -1.999626 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.452958 -2.597402 3.477919 0.611982 -1.999626 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.226480 -1.298705 1.738965 0.305992 -0.999816 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.226480 -1.298705 1.738965 0.305992 -0.999816 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.169674 -0.984919 0.955733 0.003379 -0.852355 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.396154 -2.283624 2.694699 0.309371 -1.852171 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.396154 -2.283624 2.694699 0.309371 -1.852171 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.264889, stddev=1.806903
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.219245 -1.263833 1.491335 0.171216 -1.025053 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 472/1024 range: [0.000000, 1.393839]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.527089, 0.864342]
[FEEDFORWARD] Sample values: 0.174841 -0.179656 -0.217308 0.183370 -0.325252 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.219245 -1.263833 1.491335 0.171216 -1.025053 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.174841 -0.179656 -0.217308 0.183370 -0.325252 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.044404 -1.443489 1.274027 0.354586 -1.350304 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.044404 -1.443489 1.274027 0.354586 -1.350304 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.012499, variance=1.246260, stddev=1.116364
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.028579 -1.281831 1.152424 0.328822 -1.198359 
[DECODER] Layer 1 output: 512/512 non-zero, sum=0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 4x128
[DEBUG] Decoder sample values: -0.029 -1.282 1.152 0.329 -1.198 
[LINEAR] Forward 4x128 -> 4x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.028579 -1.281831 1.152424 0.328822 -1.198359 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.322348 1.553407 0.847860 2.197402 -0.666689 
[DEBUG] Output projection - shape: 4x1000
[DEBUG] Output range: [-3.149, 2.910]
[DEBUG] Output sample values: -0.322 1.553 0.848 2.197 -0.667 
[DEBUG] Forward completed!
ENG: <sos> how are you <eos>
ESP: <sos> tener mientras ventana <eos>
---
[DEBUG] Forward - source: 4 tokens, target: 1 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 80 237 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=1.912, range=[-0.144, 0.145]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=1.912050
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=21.632357
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 512/512 non-zero, sum=47.268486
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.326046 -1.071666 1.484798 0.273141 -0.570724 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.732915 -2.277537 3.001486 0.538737 -1.204035 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.732915 -2.277537 3.001486 0.538737 -1.204035 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000821, variance=3.381766, stddev=1.838961
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.398995 -1.238938 1.631718 0.292511 -0.655183 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 517/1024 range: [0.000000, 1.367827]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.719050, 0.658787]
[FEEDFORWARD] Sample values: -0.000125 -0.052914 -0.090728 0.117637 -0.066160 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.398995 -1.238938 1.631718 0.292511 -0.655183 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.000125 -0.052914 -0.090728 0.117637 -0.066160 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.399120 -1.291851 1.540990 0.410148 -0.721343 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.399120 -1.291851 1.540990 0.410148 -0.721343 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015854, variance=1.069046, stddev=1.033952
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.370680 -1.234097 1.505723 0.412014 -0.682323 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=-0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.370680 -1.234097 1.505723 0.412014 -0.682323 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.276648 -1.060738 1.475860 0.391504 -0.624531 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.647328 -2.294835 2.981583 0.803518 -1.306854 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.647328 -2.294835 2.981583 0.803518 -1.306854 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.632388, stddev=1.905885
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.339647 -1.204078 1.564409 0.421598 -0.685694 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 481/1024 range: [0.000000, 1.388527]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.679423, 0.732816]
[FEEDFORWARD] Sample values: 0.064245 -0.132644 -0.137080 0.105227 -0.161244 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.339647 -1.204078 1.564409 0.421598 -0.685694 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.064245 -0.132644 -0.137080 0.105227 -0.161244 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.275401 -1.336723 1.427329 0.526825 -0.846938 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.275401 -1.336723 1.427329 0.526825 -0.846938 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.018793, variance=1.170336, stddev=1.081825
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.237200 -1.218247 1.336742 0.504350 -0.765507 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=0.000010
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.237 -1.218 1.337 0.504 -0.766 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=-0.545, range=[-0.142, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=-0.544556
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=-6.160941
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 128/128 non-zero, sum=0.239059
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.237200 -1.218247 1.336742 0.504350 -0.765507 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.656176 -2.457713 3.898720 0.769686 -1.416485 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.656176 -2.457713 3.898720 0.769686 -1.416485 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.810926, stddev=1.952162
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.336128 -1.258970 1.997129 0.394274 -0.725598 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 115/256 range: [0.000000, 1.273620]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.477546, 0.717541]
[FEEDFORWARD] Sample values: 0.065866 -0.112809 -0.161616 0.092405 -0.182705 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.336128 -1.258970 1.997129 0.394274 -0.725598 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.065866 -0.112809 -0.161616 0.092405 -0.182705 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.270262 -1.371779 1.835514 0.486679 -0.908303 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.270262 -1.371779 1.835514 0.486679 -0.908303 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.018263, variance=1.169625, stddev=1.081497
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.233010 -1.251521 1.714084 0.466892 -0.822970 
[DECODER] Layer 0 output: 128/128 non-zero, sum=-0.000000
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.233010 -1.251521 1.714084 0.466892 -0.822970 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.233010 -1.251521 1.714084 0.466892 -0.822970 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.466019 -2.503042 3.428169 0.933784 -1.645941 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.466019 -2.503042 3.428169 0.933784 -1.645941 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.233010 -1.251524 1.714090 0.466893 -0.822973 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.233010 -1.251524 1.714090 0.466893 -0.822973 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.237200 -1.218247 1.336742 0.504350 -0.765507 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.470210 -2.469771 3.050832 0.971243 -1.588480 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.470210 -2.469771 3.050832 0.971243 -1.588480 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.997316, stddev=1.999331
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.235184 -1.235299 1.525926 0.485784 -0.794506 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 115/256 range: [0.000000, 1.163558]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.482304, 0.836923]
[FEEDFORWARD] Sample values: 0.131616 -0.152450 -0.177695 0.074895 -0.257096 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.235184 -1.235299 1.525926 0.485784 -0.794506 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.131616 -0.152450 -0.177695 0.074895 -0.257096 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.103568 -1.387749 1.348231 0.560679 -1.051602 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.103568 -1.387749 1.348231 0.560679 -1.051602 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.018897, variance=1.277090, stddev=1.130088
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.074924 -1.211278 1.209753 0.512859 -0.913826 
[DECODER] Layer 1 output: 128/128 non-zero, sum=-0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.075 -1.211 1.210 0.513 -0.914 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.074924 -1.211278 1.209753 0.512859 -0.913826 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.573597 1.632535 0.435219 2.263393 -0.483710 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-2.965, 2.858]
[DEBUG] Output sample values: -0.574 1.633 0.435 2.263 -0.484 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 234 (score: 2.9, target_len: 3) [Top scores: 234:2.9 321:2.4 785:2.4 3:2.3 676:2.2 ]
[DEBUG] Forward - source: 4 tokens, target: 2 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 80 237 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=1.9, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=1.912050
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=21.632357
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 512/512 non-zero, sum=47.268486
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.326046 -1.071666 1.484798 0.273141 -0.570724 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.732915 -2.277537 3.001486 0.538737 -1.204035 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.732915 -2.277537 3.001486 0.538737 -1.204035 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000821, variance=3.381766, stddev=1.838961
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.398995 -1.238938 1.631718 0.292511 -0.655183 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 517/1024 range: [0.000000, 1.367827]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.719050, 0.658787]
[FEEDFORWARD] Sample values: -0.000125 -0.052914 -0.090728 0.117637 -0.066160 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.398995 -1.238938 1.631718 0.292511 -0.655183 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.000125 -0.052914 -0.090728 0.117637 -0.066160 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.399120 -1.291851 1.540990 0.410148 -0.721343 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.399120 -1.291851 1.540990 0.410148 -0.721343 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015854, variance=1.069046, stddev=1.033952
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.370680 -1.234097 1.505723 0.412014 -0.682323 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=-0.000001
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.370680 -1.234097 1.505723 0.412014 -0.682323 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.276648 -1.060738 1.475860 0.391504 -0.624531 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.647328 -2.294835 2.981583 0.803518 -1.306854 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.647328 -2.294835 2.981583 0.803518 -1.306854 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.632388, stddev=1.905885
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.339647 -1.204078 1.564409 0.421598 -0.685694 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 481/1024 range: [0.000000, 1.388527]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.679423, 0.732816]
[FEEDFORWARD] Sample values: 0.064245 -0.132644 -0.137080 0.105227 -0.161244 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.339647 -1.204078 1.564409 0.421598 -0.685694 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.064245 -0.132644 -0.137080 0.105227 -0.161244 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.275401 -1.336723 1.427329 0.526825 -0.846938 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.275401 -1.336723 1.427329 0.526825 -0.846938 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.018793, variance=1.170336, stddev=1.081825
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.237200 -1.218247 1.336742 0.504350 -0.765507 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=0.000010
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.237 -1.218 1.337 0.504 -0.766 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 234 
[EMBEDDING] Stats: 256/256 non-zero values, sum=-1.773, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=-1.773005
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=-20.059258
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 256/256 non-zero, sum=-7.253235
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.185941 -1.030654 1.341574 0.482907 -0.727940 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.604917 -2.270120 3.903552 0.748244 -1.378918 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.604917 -2.270120 3.903552 0.748244 -1.378918 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.548236, stddev=1.883679
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.321136 -1.205152 2.072302 0.397225 -0.732034 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 227/512 range: [0.000000, 1.256331]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.577894, 0.722656]
[FEEDFORWARD] Sample values: 0.058367 -0.134723 -0.154116 0.081440 -0.172220 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.321136 -1.205152 2.072302 0.397225 -0.732034 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.058367 -0.134723 -0.154116 0.081440 -0.172220 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.262769 -1.339875 1.918186 0.478664 -0.904255 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.262769 -1.339875 1.918186 0.478664 -0.904255 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.019593, variance=1.168126, stddev=1.080803
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.224996 -1.221575 1.792906 0.461007 -0.818522 
[DECODER] Layer 0 output: 256/256 non-zero, sum=-0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.224996 -1.221575 1.792906 0.461007 -0.818522 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.224996 -1.221575 1.792906 0.461007 -0.818522 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.449992 -2.443149 3.585812 0.922014 -1.637044 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.449992 -2.443149 3.585812 0.922014 -1.637044 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.224996 -1.221578 1.792912 0.461008 -0.818524 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.224996 -1.221578 1.792912 0.461008 -0.818524 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.173296 -0.984376 1.342766 0.477618 -0.718672 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.398292 -2.205954 3.135678 0.938626 -1.537196 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.398292 -2.205954 3.135678 0.938626 -1.537196 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.673777, stddev=1.916712
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.207800 -1.150905 1.635967 0.489706 -0.801996 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 224/512 range: [0.000000, 1.339768]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.674454, 0.840233]
[FEEDFORWARD] Sample values: 0.122596 -0.199560 -0.163579 0.060094 -0.236413 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.207800 -1.150905 1.635967 0.489706 -0.801996 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.122596 -0.199560 -0.163579 0.060094 -0.236413 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.085204 -1.350465 1.472388 0.549800 -1.038409 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.085204 -1.350465 1.472388 0.549800 -1.038409 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.020581, variance=1.278275, stddev=1.130613
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.057157 -1.176251 1.320495 0.504488 -0.900245 
[DECODER] Layer 1 output: 256/256 non-zero, sum=-0.000004
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.057 -1.176 1.320 0.504 -0.900 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.057157 -1.176251 1.320495 0.504488 -0.900245 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.493730 1.624482 0.340580 2.359521 -0.461935 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-2.991, 2.878]
[DEBUG] Output sample values: -0.494 1.624 0.341 2.360 -0.462 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 3 (score: 2.7, target_len: 3) [Top scores: 3:2.7 283:2.2 605:2.1 894:2.1 372:2.1 ]
ENG: <sos> good morning <eos>
ESP: <sos> tener <eos>
---
[DEBUG] Forward - source: 4 tokens, target: 1 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 446 7 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=3.2, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=3.220634
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=36.437321
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 512/512 non-zero, sum=62.073441
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.356452 -1.176512 1.420444 0.241242 -0.538549 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.763321 -2.382384 2.937132 0.506839 -1.171859 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.763321 -2.382384 2.937132 0.506839 -1.171859 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003407, variance=3.420516, stddev=1.849466
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.414567 -1.289989 1.586255 0.272204 -0.635462 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 498/1024 range: [0.000000, 1.376084]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.720752, 0.689276]
[FEEDFORWARD] Sample values: -0.000765 -0.043021 -0.099692 0.122977 -0.070793 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.414567 -1.289989 1.586255 0.272204 -0.635462 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.000765 -0.043021 -0.099692 0.122977 -0.070793 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.415333 -1.333010 1.486563 0.395181 -0.706255 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.415333 -1.333010 1.486563 0.395181 -0.706255 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015058, variance=1.068003, stddev=1.033447
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.387320 -1.275298 1.453022 0.396962 -0.668827 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=-0.000003
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.387320 -1.275298 1.453022 0.396962 -0.668827 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.336893 -1.243806 1.323782 0.353189 -0.573408 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.724213 -2.519104 2.776803 0.750150 -1.242235 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.724213 -2.519104 2.776803 0.750150 -1.242235 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.691065, stddev=1.921217
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.376955 -1.311202 1.445336 0.390456 -0.646587 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 490/1024 range: [0.000000, 1.415359]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.685572, 0.710397]
[FEEDFORWARD] Sample values: 0.059388 -0.112891 -0.157015 0.115478 -0.175303 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.376955 -1.311202 1.445336 0.390456 -0.646587 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.059388 -0.112891 -0.157015 0.115478 -0.175303 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.317567 -1.424093 1.288321 0.505934 -0.821890 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.317567 -1.424093 1.288321 0.505934 -0.821890 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.017596, variance=1.169660, stddev=1.081513
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.277363 -1.300491 1.207491 0.484072 -0.743675 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=-0.000002
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.277 -1.300 1.207 0.484 -0.744 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=-0.545, range=[-0.142, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=-0.544556
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=-6.160941
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 128/128 non-zero, sum=0.239059
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.277363 -1.300491 1.207491 0.484072 -0.743675 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.696339 -2.539958 3.769468 0.749409 -1.394654 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.696339 -2.539958 3.769468 0.749409 -1.394654 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.807484, stddev=1.951280
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.356863 -1.301688 1.931792 0.384060 -0.714738 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 115/256 range: [0.000000, 1.285420]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.471605, 0.708574]
[FEEDFORWARD] Sample values: 0.063185 -0.101707 -0.170299 0.098067 -0.189883 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.356863 -1.301688 1.931792 0.384060 -0.714738 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.063185 -0.101707 -0.170299 0.098067 -0.189883 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.293678 -1.403395 1.761493 0.482127 -0.904621 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.293678 -1.403395 1.761493 0.482127 -0.904621 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.017777, variance=1.169616, stddev=1.081493
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.255111 -1.281209 1.645199 0.462236 -0.820019 
[DECODER] Layer 0 output: 128/128 non-zero, sum=-0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.255111 -1.281209 1.645199 0.462236 -0.820019 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.255111 -1.281209 1.645199 0.462236 -0.820019 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.510222 -2.562418 3.290398 0.924472 -1.640037 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.510222 -2.562418 3.290398 0.924472 -1.640037 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.255112 -1.281213 1.645204 0.462237 -0.820021 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.255112 -1.281213 1.645204 0.462237 -0.820021 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.277363 -1.300491 1.207491 0.484072 -0.743675 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.532475 -2.581704 2.852695 0.946309 -1.563696 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.532475 -2.581704 2.852695 0.946309 -1.563696 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.997405, stddev=1.999354
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.266324 -1.291269 1.426809 0.473308 -0.782101 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 114/256 range: [0.000000, 1.165329]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.477694, 0.831268]
[FEEDFORWARD] Sample values: 0.132126 -0.133119 -0.186369 0.083122 -0.263171 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.266324 -1.291269 1.426809 0.473308 -0.782101 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.132126 -0.133119 -0.186369 0.083122 -0.263171 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.134197 -1.424388 1.240440 0.556430 -1.045272 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.134197 -1.424388 1.240440 0.556430 -1.045272 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.018200, variance=1.276013, stddev=1.129612
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.102688 -1.244843 1.114223 0.508696 -0.909226 
[DECODER] Layer 1 output: 128/128 non-zero, sum=-0.000003
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.103 -1.245 1.114 0.509 -0.909 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.102688 -1.244843 1.114223 0.508696 -0.909226 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.605228 1.664459 0.541429 2.194960 -0.528816 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-2.973, 2.812]
[DEBUG] Output sample values: -0.605 1.664 0.541 2.195 -0.529 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 234 (score: 2.8, target_len: 3) [Top scores: 234:2.8 321:2.5 785:2.4 676:2.2 3:2.2 ]
[DEBUG] Forward - source: 4 tokens, target: 2 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 446 7 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=3.2, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=3.220634
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=36.437321
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 512/512 non-zero, sum=62.073441
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.356452 -1.176512 1.420444 0.241242 -0.538549 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.763321 -2.382384 2.937132 0.506839 -1.171859 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.763321 -2.382384 2.937132 0.506839 -1.171859 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003407, variance=3.420516, stddev=1.849466
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.414567 -1.289989 1.586255 0.272204 -0.635462 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 498/1024 range: [0.000000, 1.376084]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.720752, 0.689276]
[FEEDFORWARD] Sample values: -0.000765 -0.043021 -0.099692 0.122977 -0.070793 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.414567 -1.289989 1.586255 0.272204 -0.635462 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.000765 -0.043021 -0.099692 0.122977 -0.070793 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.415333 -1.333010 1.486563 0.395181 -0.706255 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.415333 -1.333010 1.486563 0.395181 -0.706255 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015058, variance=1.068003, stddev=1.033447
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.387320 -1.275298 1.453022 0.396962 -0.668827 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=-0.000003
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.387320 -1.275298 1.453022 0.396962 -0.668827 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.336893 -1.243806 1.323782 0.353189 -0.573408 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.724213 -2.519104 2.776803 0.750150 -1.242235 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.724213 -2.519104 2.776803 0.750150 -1.242235 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.691065, stddev=1.921217
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.376955 -1.311202 1.445336 0.390456 -0.646587 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 490/1024 range: [0.000000, 1.415359]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.685572, 0.710397]
[FEEDFORWARD] Sample values: 0.059388 -0.112891 -0.157015 0.115478 -0.175303 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.376955 -1.311202 1.445336 0.390456 -0.646587 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.059388 -0.112891 -0.157015 0.115478 -0.175303 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.317567 -1.424093 1.288321 0.505934 -0.821890 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.317567 -1.424093 1.288321 0.505934 -0.821890 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.017596, variance=1.169660, stddev=1.081513
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.277363 -1.300491 1.207491 0.484072 -0.743675 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=-0.000002
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.277 -1.300 1.207 0.484 -0.744 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 234 
[EMBEDDING] Stats: 256/256 non-zero values, sum=-1.773, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=-1.773005
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=-20.059258
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 256/256 non-zero, sum=-7.253235
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.235775 -1.280836 1.157439 0.490084 -0.685004 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.654752 -2.520302 3.719416 0.755421 -1.335982 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.654752 -2.520302 3.719416 0.755421 -1.335982 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.716292, stddev=1.927771
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.339642 -1.307366 1.929387 0.391862 -0.693019 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 233/512 range: [0.000000, 1.531380]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.540882, 0.702846]
[FEEDFORWARD] Sample values: 0.059464 -0.102874 -0.167538 0.095356 -0.187243 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.339642 -1.307366 1.929387 0.391862 -0.693019 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.059464 -0.102874 -0.167538 0.095356 -0.187243 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.280178 -1.410240 1.761849 0.487219 -0.880262 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.280178 -1.410240 1.761849 0.487219 -0.880262 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.017975, variance=1.168194, stddev=1.080835
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.242593 -1.288138 1.646712 0.467410 -0.797797 
[DECODER] Layer 0 output: 256/256 non-zero, sum=-0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.242593 -1.288138 1.646712 0.467410 -0.797797 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.242593 -1.288138 1.646712 0.467410 -0.797797 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.485186 -2.576277 3.293424 0.934821 -1.595593 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.485186 -2.576277 3.293424 0.934821 -1.595593 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.242594 -1.288142 1.646717 0.467412 -0.797799 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.242594 -1.288142 1.646717 0.467412 -0.797799 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.219214 -1.273009 1.137506 0.492478 -0.661639 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.461807 -2.561151 2.784223 0.959890 -1.459438 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.461807 -2.561151 2.784223 0.959890 -1.459438 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.869502, stddev=1.967107
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.234765 -1.301988 1.415389 0.487970 -0.741921 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 226/512 range: [0.000000, 1.251449]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.471203, 0.821178]
[FEEDFORWARD] Sample values: 0.126728 -0.136370 -0.182733 0.078654 -0.258783 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.234765 -1.301988 1.415389 0.487970 -0.741921 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.126728 -0.136370 -0.182733 0.078654 -0.258783 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.108037 -1.438358 1.232656 0.566624 -1.000704 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.108037 -1.438358 1.232656 0.566624 -1.000704 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.018587, variance=1.274613, stddev=1.128992
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.079230 -1.257556 1.108283 0.518348 -0.869906 
[DECODER] Layer 1 output: 256/256 non-zero, sum=0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.079 -1.258 1.108 0.518 -0.870 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.079230 -1.257556 1.108283 0.518348 -0.869906 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.577222 1.683949 0.543153 2.191000 -0.538579 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-2.984, 2.948]
[DEBUG] Output sample values: -0.577 1.684 0.543 2.191 -0.539 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 676 (score: 2.9, target_len: 3) [Top scores: 676:2.9 13:2.6 321:2.3 1:2.1 283:2.1 ]
[DEBUG] Forward - source: 4 tokens, target: 3 tokens
[ENCODER] Starting encode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 446 7 3 
[EMBEDDING] Stats: 512/512 non-zero values, sum=3.2, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 512/512 non-zero, sum=3.220634
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[ENCODER] SCALED EMBEDS before add: 512/512 non-zero, sum=36.437321
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 512/512 non-zero, sum=62.073441
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.356452 -1.176512 1.420444 0.241242 -0.538549 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.763321 -2.382384 2.937132 0.506839 -1.171859 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.763321 -2.382384 2.937132 0.506839 -1.171859 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003407, variance=3.420516, stddev=1.849466
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.414567 -1.289989 1.586255 0.272204 -0.635462 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 498/1024 range: [0.000000, 1.376084]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.720752, 0.689276]
[FEEDFORWARD] Sample values: -0.000765 -0.043021 -0.099692 0.122977 -0.070793 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.414567 -1.289989 1.586255 0.272204 -0.635462 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.000765 -0.043021 -0.099692 0.122977 -0.070793 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.415333 -1.333010 1.486563 0.395181 -0.706255 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.415333 -1.333010 1.486563 0.395181 -0.706255 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015058, variance=1.068003, stddev=1.033447
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.387320 -1.275298 1.453022 0.396962 -0.668827 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 0 output: 512/512 non-zero, sum=-0.000003
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 512/512 non-zero
[ENCODER_LAYER] After self-attention: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.387320 -1.275298 1.453022 0.396962 -0.668827 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.336893 -1.243806 1.323782 0.353189 -0.573408 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.724213 -2.519104 2.776803 0.750150 -1.242235 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.724213 -2.519104 2.776803 0.750150 -1.242235 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.691065, stddev=1.921217
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.376955 -1.311202 1.445336 0.390456 -0.646587 
[ENCODER_LAYER] After norm1: 512/512 non-zero
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 490/1024 range: [0.000000, 1.415359]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.685572, 0.710397]
[FEEDFORWARD] Sample values: 0.059388 -0.112891 -0.157015 0.115478 -0.175303 
[ENCODER_LAYER] After feedforward: 512/512 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.376955 -1.311202 1.445336 0.390456 -0.646587 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.059388 -0.112891 -0.157015 0.115478 -0.175303 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.317567 -1.424093 1.288321 0.505934 -0.821890 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.317567 -1.424093 1.288321 0.505934 -0.821890 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.017596, variance=1.169660, stddev=1.081513
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.277363 -1.300491 1.207491 0.484072 -0.743675 
[ENCODER_LAYER] Final output: 512/512 non-zero
[ENCODER] Layer 1 output: 512/512 non-zero, sum=-0.000002
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 4x128
[DEBUG] Encoder sample values: -0.277 -1.300 1.207 0.484 -0.744 
[DECODER] Starting decode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 234 676 
[EMBEDDING] Stats: 384/384 non-zero values, sum=-1.738, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 384/384 non-zero, sum=-1.737865
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[DECODER] SCALED EMBEDS before add: 384/384 non-zero, sum=-19.661692
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 384/384 non-zero, sum=-0.443621
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.277598 -1.261959 1.079405 0.435093 -0.680774 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.696574 -2.501425 3.641383 0.700429 -1.331752 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.696574 -2.501425 3.641383 0.700429 -1.331752 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.590284, stddev=1.894807
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.367623 -1.320148 1.921770 0.369657 -0.702843 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 359/768 range: [0.000000, 1.435267]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.646412, 0.697392]
[FEEDFORWARD] Sample values: 0.052455 -0.107260 -0.173749 0.100235 -0.187630 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.367623 -1.320148 1.921770 0.369657 -0.702843 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.052455 -0.107260 -0.173749 0.100235 -0.187630 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.315168 -1.427407 1.748021 0.469892 -0.890473 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.315168 -1.427407 1.748021 0.469892 -0.890473 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.018073, variance=1.167881, stddev=1.080690
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.274913 -1.304106 1.634228 0.451531 -0.807262 
[DECODER] Layer 0 output: 384/384 non-zero, sum=0.000008
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.274913 -1.304106 1.634228 0.451531 -0.807262 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.274913 -1.304106 1.634228 0.451531 -0.807262 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.549825 -2.608212 3.268456 0.903061 -1.614524 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.549825 -2.608212 3.268456 0.903061 -1.614524 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999966, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.274914 -1.304110 1.634233 0.451532 -0.807264 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.274914 -1.304110 1.634233 0.451532 -0.807264 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.272758 -1.249043 1.038273 0.422331 -0.656554 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.547672 -2.553153 2.672506 0.873862 -1.463818 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.547672 -2.553153 2.672506 0.873862 -1.463818 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.710940, stddev=1.926383
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.284301 -1.325361 1.387318 0.453629 -0.759879 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 347/768 range: [0.000000, 1.397259]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.612474, 0.813006]
[FEEDFORWARD] Sample values: 0.117131 -0.145151 -0.193145 0.086370 -0.260808 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.284301 -1.325361 1.387318 0.453629 -0.759879 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.117131 -0.145151 -0.193145 0.086370 -0.260808 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.167170 -1.470513 1.194173 0.539999 -1.020687 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.167170 -1.470513 1.194173 0.539999 -1.020687 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.018824, variance=1.275682, stddev=1.129465
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.131341 -1.285288 1.073957 0.494767 -0.887024 
[DECODER] Layer 1 output: 384/384 non-zero, sum=0.000000
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 3x128
[DEBUG] Decoder sample values: -0.131 -1.285 1.074 0.495 -0.887 
[LINEAR] Forward 3x128 -> 3x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.131341 -1.285288 1.073957 0.494767 -0.887024 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.575923 1.712308 0.636288 2.179461 -0.585742 
[DEBUG] Output projection - shape: 3x1000
[DEBUG] Output range: [-2.988, 2.845]
[DEBUG] Output sample values: -0.576 1.712 0.636 2.179 -0.586 
[DEBUG] Forward completed!
[GEN] Step 2 - Best token: 3 (score: 5.9, target_len: 3) [Top scores: 3:5.9 829:2.8 471:2.5 122:2.4 785:2.4 ]
ENG: <sos> thank you <eos>
ESP: <sos> tener vestido <eos>
---
[DEBUG] Forward - source: 5 tokens, target: 1 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 5 107 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=1.6, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=1.579846
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=17.873913
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 640/640 non-zero, sum=49.934109
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.303158 -1.097594 1.404773 0.209193 -0.558386 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.710027 -2.303465 2.921461 0.474790 -1.191697 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.710027 -2.303465 2.921461 0.474790 -1.191697 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003486, variance=3.287980, stddev=1.813281
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.393492 -1.272252 1.609224 0.259918 -0.659127 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 636/1280 range: [0.000000, 1.432919]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.705294, 0.898598]
[FEEDFORWARD] Sample values: -0.004262 -0.038367 -0.105435 0.129943 -0.069428 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.393492 -1.272252 1.609224 0.259918 -0.659127 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.004262 -0.038367 -0.105435 0.129943 -0.069428 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.397754 -1.310619 1.503789 0.389860 -0.728555 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.397754 -1.310619 1.503789 0.389860 -0.728555 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014094, variance=1.069378, stddev=1.034112
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.371005 -1.253756 1.467812 0.390629 -0.690893 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=0.000005
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.371005 -1.253756 1.467812 0.390629 -0.690893 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.251530 -1.115143 1.307512 0.312132 -0.643820 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.622535 -2.368900 2.775324 0.702761 -1.334713 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.622535 -2.368900 2.775324 0.702761 -1.334713 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.504649, stddev=1.872073
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.332538 -1.265388 1.482487 0.375392 -0.712960 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 629/1280 range: [0.000000, 1.348021]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.655402, 0.807459]
[FEEDFORWARD] Sample values: 0.054189 -0.106415 -0.180499 0.140697 -0.168093 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.332538 -1.265388 1.482487 0.375392 -0.712960 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.054189 -0.106415 -0.180499 0.140697 -0.168093 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.278349 -1.371804 1.301987 0.516089 -0.881053 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.278349 -1.371804 1.301987 0.516089 -0.881053 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015568, variance=1.171931, stddev=1.082562
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.242740 -1.252801 1.217071 0.491110 -0.799478 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.243 -1.253 1.217 0.491 -0.799 
[DECODER] Starting decode with 1 tokens
[EMBEDDING] Forward pass - seq_len=1, d_model=128
[EMBEDDING] Input tokens: 2 
[EMBEDDING] Stats: 128/128 non-zero values, sum=-0.545, range=[-0.142, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 128/128 non-zero, sum=-0.544556
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 64/128 non-zero, sum=6.399996
[DECODER] SCALED EMBEDS before add: 128/128 non-zero, sum=-6.160941
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 128/128 non-zero, sum=0.239059
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.242740 -1.252801 1.217071 0.491110 -0.799478 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.661716 -2.492267 3.779049 0.756446 -1.450456 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.661716 -2.492267 3.779049 0.756446 -1.450456 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.806478, stddev=1.951022
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.339164 -1.277416 1.936958 0.387718 -0.743434 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 115/256 range: [0.000000, 1.297453]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.469477, 0.714355]
[FEEDFORWARD] Sample values: 0.060706 -0.097312 -0.182237 0.109366 -0.185453 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.339164 -1.277416 1.936958 0.387718 -0.743434 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.060706 -0.097312 -0.182237 0.109366 -0.185453 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.278458 -1.374728 1.754721 0.497084 -0.928887 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.278458 -1.374728 1.754721 0.497084 -0.928887 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.016868, variance=1.170599, stddev=1.081947
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.241777 -1.255016 1.637408 0.475025 -0.842942 
[DECODER] Layer 0 output: 128/128 non-zero, sum=0.000004
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.241777 -1.255016 1.637408 0.475025 -0.842942 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.241777 -1.255016 1.637408 0.475025 -0.842942 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.483554 -2.510032 3.274816 0.950050 -1.685885 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.483554 -2.510032 3.274816 0.950050 -1.685885 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.241778 -1.255020 1.637413 0.475026 -0.842945 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.241778 -1.255020 1.637413 0.475026 -0.842945 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.242740 -1.252801 1.217071 0.491110 -0.799478 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.484517 -2.507821 2.854484 0.966136 -1.642423 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.484517 -2.507821 2.854484 0.966136 -1.642423 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.996965, stddev=1.999244
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.242350 -1.254385 1.427782 0.483251 -0.821522 
[FEEDFORWARD] Forward pass: 1x128 -> 1x256 -> 1x128
[FEEDFORWARD] Input non-zero: 128/128
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 112/256 range: [0.000000, 1.184039]
[FEEDFORWARD] Output non-zero: 128/128 range: [-0.460108, 0.837192]
[FEEDFORWARD] Sample values: 0.129326 -0.124836 -0.201930 0.094355 -0.258437 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.242350 -1.254385 1.427782 0.483251 -0.821522 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.129326 -0.124836 -0.201930 0.094355 -0.258437 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.113024 -1.379221 1.225852 0.577606 -1.079960 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.113024 -1.379221 1.225852 0.577606 -1.079960 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.017066, variance=1.277109, stddev=1.130097
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.084912 -1.205344 1.099833 0.526213 -0.940534 
[DECODER] Layer 1 output: 128/128 non-zero, sum=0.000002
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 1x128
[DEBUG] Decoder sample values: -0.085 -1.205 1.100 0.526 -0.941 
[LINEAR] Forward 1x128 -> 1x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.084912 -1.205344 1.099833 0.526213 -0.940534 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.589241 1.674480 0.571256 2.194283 -0.515303 
[DEBUG] Output projection - shape: 1x1000
[DEBUG] Output range: [-2.983, 2.857]
[DEBUG] Output sample values: -0.589 1.674 0.571 2.194 -0.515 
[DEBUG] Forward completed!
[GEN] Step 0 - Best token: 785 (score: 2.4, target_len: 4) [Top scores: 234:2.9 321:2.5 785:2.4 676:2.2 3:2.2 ]
[DEBUG] Forward - source: 5 tokens, target: 2 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 5 107 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=1.6, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=1.579846
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=17.873913
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 640/640 non-zero, sum=49.934109
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.303158 -1.097594 1.404773 0.209193 -0.558386 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.710027 -2.303465 2.921461 0.474790 -1.191697 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.710027 -2.303465 2.921461 0.474790 -1.191697 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003486, variance=3.287980, stddev=1.813281
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.393492 -1.272252 1.609224 0.259918 -0.659127 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 636/1280 range: [0.000000, 1.432919]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.705294, 0.898598]
[FEEDFORWARD] Sample values: -0.004262 -0.038367 -0.105435 0.129943 -0.069428 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.393492 -1.272252 1.609224 0.259918 -0.659127 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.004262 -0.038367 -0.105435 0.129943 -0.069428 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.397754 -1.310619 1.503789 0.389860 -0.728555 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.397754 -1.310619 1.503789 0.389860 -0.728555 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014094, variance=1.069378, stddev=1.034112
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.371005 -1.253756 1.467812 0.390629 -0.690893 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=0.000005
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.371005 -1.253756 1.467812 0.390629 -0.690893 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.251530 -1.115143 1.307512 0.312132 -0.643820 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.622535 -2.368900 2.775324 0.702761 -1.334713 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.622535 -2.368900 2.775324 0.702761 -1.334713 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.504649, stddev=1.872073
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.332538 -1.265388 1.482487 0.375392 -0.712960 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 629/1280 range: [0.000000, 1.348021]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.655402, 0.807459]
[FEEDFORWARD] Sample values: 0.054189 -0.106415 -0.180499 0.140697 -0.168093 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.332538 -1.265388 1.482487 0.375392 -0.712960 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.054189 -0.106415 -0.180499 0.140697 -0.168093 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.278349 -1.371804 1.301987 0.516089 -0.881053 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.278349 -1.371804 1.301987 0.516089 -0.881053 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015568, variance=1.171931, stddev=1.082562
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.242740 -1.252801 1.217071 0.491110 -0.799478 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.243 -1.253 1.217 0.491 -0.799 
[DECODER] Starting decode with 2 tokens
[EMBEDDING] Forward pass - seq_len=2, d_model=128
[EMBEDDING] Input tokens: 2 785 
[EMBEDDING] Stats: 256/256 non-zero values, sum=-0.465, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 256/256 non-zero, sum=-0.465376
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 192/256 non-zero, sum=12.806040
[DECODER] SCALED EMBEDS before add: 256/256 non-zero, sum=-5.265124
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 256/256 non-zero, sum=7.540904
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.146152 -1.136481 1.241011 0.494638 -0.687898 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.565129 -2.375947 3.802989 0.759975 -1.338877 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.565129 -2.375947 3.802989 0.759975 -1.338877 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.604031, stddev=1.898431
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.297682 -1.251532 2.003227 0.400317 -0.705254 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 250/512 range: [0.000000, 1.290192]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.592880, 0.701064]
[FEEDFORWARD] Sample values: 0.054207 -0.098815 -0.183468 0.101558 -0.177316 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.297682 -1.251532 2.003227 0.400317 -0.705254 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.054207 -0.098815 -0.183468 0.101558 -0.177316 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.243475 -1.350347 1.819759 0.501875 -0.882571 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.243475 -1.350347 1.819759 0.501875 -0.882571 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.016483, variance=1.169422, stddev=1.081403
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.209905 -1.233458 1.698018 0.479338 -0.800893 
[DECODER] Layer 0 output: 256/256 non-zero, sum=0.000002
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.209905 -1.233458 1.698018 0.479338 -0.800893 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.209905 -1.233458 1.698018 0.479338 -0.800893 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.419811 -2.466916 3.396037 0.958677 -1.601786 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.419811 -2.466916 3.396037 0.958677 -1.601786 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999968, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.209906 -1.233461 1.698023 0.479340 -0.800895 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.209906 -1.233461 1.698023 0.479340 -0.800895 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.147290 -1.137852 1.240729 0.494596 -0.689213 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.357196 -2.371313 2.938752 0.973936 -1.490108 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.357196 -2.371313 2.938752 0.973936 -1.490108 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.792088, stddev=1.947331
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.183429 -1.217725 1.509118 0.500139 -0.765206 
[FEEDFORWARD] Forward pass: 2x128 -> 2x256 -> 2x128
[FEEDFORWARD] Input non-zero: 256/256
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 242/512 range: [0.000000, 1.264291]
[FEEDFORWARD] Output non-zero: 256/256 range: [-0.594168, 0.820872]
[FEEDFORWARD] Sample values: 0.122814 -0.129584 -0.204778 0.080867 -0.255339 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.183429 -1.217725 1.509118 0.500139 -0.765206 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.122814 -0.129584 -0.204778 0.080867 -0.255339 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.060615 -1.347309 1.304340 0.581006 -1.020545 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.060615 -1.347309 1.304340 0.581006 -1.020545 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.016603, variance=1.278901, stddev=1.130890
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.038918 -1.176689 1.168056 0.528442 -0.887745 
[DECODER] Layer 1 output: 256/256 non-zero, sum=-0.000004
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 2x128
[DEBUG] Decoder sample values: -0.039 -1.177 1.168 0.528 -0.888 
[LINEAR] Forward 2x128 -> 2x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.038918 -1.176689 1.168056 0.528442 -0.887745 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.563409 1.645531 0.582454 2.211012 -0.469297 
[DEBUG] Output projection - shape: 2x1000
[DEBUG] Output range: [-3.017, 3.554]
[DEBUG] Output sample values: -0.563 1.646 0.582 2.211 -0.469 
[DEBUG] Forward completed!
[GEN] Step 1 - Best token: 288 (score: 2.2, target_len: 4) [Top scores: 41:3.6 504:2.4 288:2.2 396:2.2 505:2.0 ]
[DEBUG] Forward - source: 5 tokens, target: 3 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 5 107 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=1.6, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=1.579846
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=17.873913
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 640/640 non-zero, sum=49.934109
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.303158 -1.097594 1.404773 0.209193 -0.558386 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.710027 -2.303465 2.921461 0.474790 -1.191697 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.710027 -2.303465 2.921461 0.474790 -1.191697 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003486, variance=3.287980, stddev=1.813281
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.393492 -1.272252 1.609224 0.259918 -0.659127 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 636/1280 range: [0.000000, 1.432919]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.705294, 0.898598]
[FEEDFORWARD] Sample values: -0.004262 -0.038367 -0.105435 0.129943 -0.069428 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.393492 -1.272252 1.609224 0.259918 -0.659127 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.004262 -0.038367 -0.105435 0.129943 -0.069428 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.397754 -1.310619 1.503789 0.389860 -0.728555 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.397754 -1.310619 1.503789 0.389860 -0.728555 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014094, variance=1.069378, stddev=1.034112
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.371005 -1.253756 1.467812 0.390629 -0.690893 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=0.000005
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.371005 -1.253756 1.467812 0.390629 -0.690893 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.251530 -1.115143 1.307512 0.312132 -0.643820 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.622535 -2.368900 2.775324 0.702761 -1.334713 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.622535 -2.368900 2.775324 0.702761 -1.334713 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.504649, stddev=1.872073
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.332538 -1.265388 1.482487 0.375392 -0.712960 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 629/1280 range: [0.000000, 1.348021]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.655402, 0.807459]
[FEEDFORWARD] Sample values: 0.054189 -0.106415 -0.180499 0.140697 -0.168093 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.332538 -1.265388 1.482487 0.375392 -0.712960 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.054189 -0.106415 -0.180499 0.140697 -0.168093 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.278349 -1.371804 1.301987 0.516089 -0.881053 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.278349 -1.371804 1.301987 0.516089 -0.881053 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015568, variance=1.171931, stddev=1.082562
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.242740 -1.252801 1.217071 0.491110 -0.799478 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.243 -1.253 1.217 0.491 -0.799 
[DECODER] Starting decode with 3 tokens
[EMBEDDING] Forward pass - seq_len=3, d_model=128
[EMBEDDING] Input tokens: 2 785 288 
[EMBEDDING] Stats: 384/384 non-zero values, sum=-0.488, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 384/384 non-zero, sum=-0.487638
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 320/384 non-zero, sum=19.218086
[DECODER] SCALED EMBEDS before add: 384/384 non-zero, sum=-5.516990
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 384/384 non-zero, sum=13.701080
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.107089 -1.066362 1.122412 0.471091 -0.766662 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.526066 -2.305828 3.684390 0.736428 -1.417640 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.526066 -2.305828 3.684390 0.736428 -1.417640 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.431533, stddev=1.852443
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.283985 -1.244750 1.988936 0.397544 -0.765282 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 398/768 range: [0.000000, 1.348828]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.813954, 0.713329]
[FEEDFORWARD] Sample values: 0.050766 -0.089873 -0.197130 0.123049 -0.175887 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.283985 -1.244750 1.988936 0.397544 -0.765282 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.050766 -0.089873 -0.197130 0.123049 -0.175887 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.233219 -1.334623 1.791806 0.520594 -0.941169 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.233219 -1.334623 1.791806 0.520594 -0.941169 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015159, variance=1.168465, stddev=1.080960
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.201729 -1.220640 1.671629 0.495626 -0.856655 
[DECODER] Layer 0 output: 384/384 non-zero, sum=0.000001
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.201729 -1.220640 1.671629 0.495626 -0.856655 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.201729 -1.220640 1.671629 0.495626 -0.856655 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.403457 -2.441281 3.343258 0.991252 -1.713311 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.403457 -2.441281 3.343258 0.991252 -1.713311 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999967, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.201729 -1.220644 1.671634 0.495627 -0.856658 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.201729 -1.220644 1.671634 0.495627 -0.856658 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.095155 -1.043418 1.077724 0.462251 -0.798890 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.296884 -2.264062 2.749358 0.957879 -1.655548 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.296884 -2.264062 2.749358 0.957879 -1.655548 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.568113, stddev=1.888948
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.157169 -1.198584 1.455497 0.507096 -0.876439 
[FEEDFORWARD] Forward pass: 3x128 -> 3x256 -> 3x128
[FEEDFORWARD] Input non-zero: 384/384
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 371/768 range: [0.000000, 1.293111]
[FEEDFORWARD] Output non-zero: 384/384 range: [-0.668189, 0.838393]
[FEEDFORWARD] Sample values: 0.116950 -0.114660 -0.229297 0.121175 -0.245159 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.157169 -1.198584 1.455497 0.507096 -0.876439 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.116950 -0.114660 -0.229297 0.121175 -0.245159 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.040219 -1.313243 1.226200 0.628271 -1.121598 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.040219 -1.313243 1.226200 0.628271 -1.121598 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014892, variance=1.275982, stddev=1.129598
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.022421 -1.149392 1.098702 0.569373 -0.979735 
[DECODER] Layer 1 output: 384/384 non-zero, sum=-0.000003
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 3x128
[DEBUG] Decoder sample values: -0.022 -1.149 1.099 0.569 -0.980 
[LINEAR] Forward 3x128 -> 3x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.022421 -1.149392 1.098702 0.569373 -0.979735 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.521798 1.705381 0.659107 2.174995 -0.504671 
[DEBUG] Output projection - shape: 3x1000
[DEBUG] Output range: [-3.024, 2.916]
[DEBUG] Output sample values: -0.522 1.705 0.659 2.175 -0.505 
[DEBUG] Forward completed!
[GEN] Step 2 - Best token: 378 (score: 2.4, target_len: 4) [Top scores: 378:2.4 321:2.4 676:2.4 234:2.2 548:2.2 ]
[DEBUG] Forward - source: 5 tokens, target: 4 tokens
[ENCODER] Starting encode with 5 tokens
[EMBEDDING] Forward pass - seq_len=5, d_model=128
[EMBEDDING] Input tokens: 2 5 107 7 3 
[EMBEDDING] Stats: 640/640 non-zero values, sum=1.6, range=[-0.1, 0.1]
[EMBEDDING] First 10 output values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Token 2 embedding values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 
[EMBEDDING] GPU verification - first 10 values: -0.035963 -0.115424 0.134058 0.014637 -0.055977 0.120466 -0.124412 -0.051646 -0.028119 -0.111990 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[ENCODER] Embeddings stats: 640/640 non-zero, sum=1.579846
[ENCODER] Scaling embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[ENCODER] POS ENC before add: 576/640 non-zero, sum=32.060211
[ENCODER] SCALED EMBEDS before add: 640/640 non-zero, sum=17.873913
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.305872 1.516688 0.165596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[ENCODER] After pos encoding: 640/640 non-zero, sum=49.934109
[ENCODER] Processing layer 0
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.406869 -1.205872 1.516688 0.265596 -0.633311 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.303158 -1.097594 1.404773 0.209193 -0.558386 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.710027 -2.303465 2.921461 0.474790 -1.191697 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.710027 -2.303465 2.921461 0.474790 -1.191697 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003486, variance=3.287980, stddev=1.813281
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.393492 -1.272252 1.609224 0.259918 -0.659127 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 636/1280 range: [0.000000, 1.432919]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.705294, 0.898598]
[FEEDFORWARD] Sample values: -0.004262 -0.038367 -0.105435 0.129943 -0.069428 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.393492 -1.272252 1.609224 0.259918 -0.659127 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.004262 -0.038367 -0.105435 0.129943 -0.069428 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.397754 -1.310619 1.503789 0.389860 -0.728555 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.397754 -1.310619 1.503789 0.389860 -0.728555 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.014094, variance=1.069378, stddev=1.034112
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.371005 -1.253756 1.467812 0.390629 -0.690893 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 0 output: 640/640 non-zero, sum=0.000005
[ENCODER] Processing layer 1
[ENCODER_LAYER] Starting layer with input stats: 640/640 non-zero
[ENCODER_LAYER] After self-attention: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.371005 -1.253756 1.467812 0.390629 -0.690893 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.251530 -1.115143 1.307512 0.312132 -0.643820 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.622535 -2.368900 2.775324 0.702761 -1.334713 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.622535 -2.368900 2.775324 0.702761 -1.334713 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.000000, variance=3.504649, stddev=1.872073
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.332538 -1.265388 1.482487 0.375392 -0.712960 
[ENCODER_LAYER] After norm1: 640/640 non-zero
[FEEDFORWARD] Forward pass: 5x128 -> 5x256 -> 5x128
[FEEDFORWARD] Input non-zero: 640/640
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32767/32768
[FEEDFORWARD] Hidden non-zero: 629/1280 range: [0.000000, 1.348021]
[FEEDFORWARD] Output non-zero: 640/640 range: [-0.655402, 0.807459]
[FEEDFORWARD] Sample values: 0.054189 -0.106415 -0.180499 0.140697 -0.168093 
[ENCODER_LAYER] After feedforward: 640/640 non-zero
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.332538 -1.265388 1.482487 0.375392 -0.712960 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.054189 -0.106415 -0.180499 0.140697 -0.168093 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.278349 -1.371804 1.301987 0.516089 -0.881053 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.278349 -1.371804 1.301987 0.516089 -0.881053 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015568, variance=1.171931, stddev=1.082562
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.242740 -1.252801 1.217071 0.491110 -0.799478 
[ENCODER_LAYER] Final output: 640/640 non-zero
[ENCODER] Layer 1 output: 640/640 non-zero, sum=-0.000001
[ENCODER] Encoding complete
[DEBUG] Encode OK - shape: 5x128
[DEBUG] Encoder sample values: -0.243 -1.253 1.217 0.491 -0.799 
[DECODER] Starting decode with 4 tokens
[EMBEDDING] Forward pass - seq_len=4, d_model=128
[EMBEDDING] Input tokens: 2 785 288 378 
[EMBEDDING] Stats: 512/512 non-zero values, sum=-0.016, range=[-0.146, 0.221]
[EMBEDDING] First 10 output values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Token 2 embedding values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 
[EMBEDDING] GPU verification - first 10 values: -0.035994 -0.115645 0.221275 0.014226 -0.056017 0.120386 -0.124648 -0.051764 -0.028201 -0.112036 
[EMBEDDING] Forward pass completed - Output ready for encoder/decoder
[DECODER] Target embeddings stats: 512/512 non-zero, sum=-0.016252
[DECODER] Scaling target embeddings by 11.313708
[POS_ENC] Stats: 10/20 non-zero, sum=1.000000, range=[0.100000, 0.100000]
[POS_ENC] First 10 values: 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 0.000000 0.100000 
[DECODER] POS ENC before add: 448/512 non-zero, sum=25.636196
[DECODER] SCALED EMBEDS before add: 512/512 non-zero, sum=-0.183863
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.308376 2.503443 0.160949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.000000 0.100000 0.000000 0.100000 0.000000 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[DECODER] After pos encoding: 512/512 non-zero, sum=25.452255
[DECODER] Processing layer 0
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.407230 -1.208376 2.503443 0.260949 -0.633763 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.814461 -2.416752 5.006886 0.521897 -1.267526 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=0.003735, variance=3.813601, stddev=1.952847
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.418976 -1.239466 2.561978 0.265337 -0.650978 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.149569 -1.053509 1.052588 0.419863 -0.765822 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.568545 -2.292974 3.614566 0.685199 -1.416800 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.568545 -2.292974 3.614566 0.685199 -1.416800 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.332350, stddev=1.825475
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.311450 -1.256097 1.980069 0.375354 -0.776127 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 524/1024 range: [0.000000, 1.293735]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.894120, 0.708348]
[FEEDFORWARD] Sample values: 0.045326 -0.093353 -0.202752 0.128043 -0.176091 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.311450 -1.256097 1.980069 0.375354 -0.776127 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.045326 -0.093353 -0.202752 0.128043 -0.176091 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.266125 -1.349450 1.777317 0.503397 -0.952218 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.266125 -1.349450 1.777317 0.503397 -0.952218 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015229, variance=1.168242, stddev=1.080857
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.232127 -1.234411 1.658448 0.479828 -0.866895 
[DECODER] Layer 0 output: 512/512 non-zero, sum=-0.000003
[DECODER] Processing layer 1
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.232127 -1.234411 1.658448 0.479828 -0.866895 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.232127 -1.234411 1.658448 0.479828 -0.866895 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.464254 -2.468822 3.316897 0.959657 -1.733790 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.464254 -2.468822 3.316897 0.959657 -1.733790 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.999965, stddev=1.999994
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.232128 -1.234415 1.658454 0.479830 -0.866898 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.232128 -1.234415 1.658454 0.479830 -0.866898 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: -0.148885 -1.027341 0.989382 0.397583 -0.798225 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.381012 -2.261756 2.647835 0.877413 -1.665123 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.381012 -2.261756 2.647835 0.877413 -1.665123 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.000000, variance=3.447105, stddev=1.856641
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.205216 -1.218198 1.426143 0.472581 -0.896847 
[FEEDFORWARD] Forward pass: 4x128 -> 4x256 -> 4x128
[FEEDFORWARD] Input non-zero: 512/512
[FEEDFORWARD] W1 non-zero: 32768/32768
[FEEDFORWARD] W2 non-zero: 32768/32768
[FEEDFORWARD] Hidden non-zero: 494/1024 range: [0.000000, 1.270302]
[FEEDFORWARD] Output non-zero: 512/512 range: [-0.789983, 0.832860]
[FEEDFORWARD] Sample values: 0.108401 -0.120797 -0.237963 0.131824 -0.245346 
[MATRIX_ADD_DEBUG] Matrix A first 5 values: -0.205216 -1.218198 1.426143 0.472581 -0.896847 
[MATRIX_ADD_DEBUG] Matrix B first 5 values: 0.108401 -0.120797 -0.237963 0.131824 -0.245346 
[MATRIX_ADD_DEBUG] Result first 5 values: -0.096815 -1.338995 1.188180 0.604405 -1.142193 
[LAYER_NORM] Input: 100/100 non-zero, first 5: -0.096815 -1.338995 1.188180 0.604405 -1.142193 
[LAYER_NORM] Gamma first 5: 1.000000 1.000000 1.000000 1.000000 1.000000 
[LAYER_NORM] Beta first 5: 0.000000 0.000000 0.000000 0.000000 0.000000 
[LAYER_NORM] Row 0: mean=-0.015054, variance=1.276508, stddev=1.129831
[LAYER_NORM] Output: 100/100 non-zero, first 5: -0.072366 -1.171804 1.064969 0.548276 -0.997617 
[DECODER] Layer 1 output: 512/512 non-zero, sum=0.000001
[DECODER] Decoding complete
[DEBUG] Decode OK - shape: 4x128
[DEBUG] Decoder sample values: -0.072 -1.172 1.065 0.548 -0.998 
[LINEAR] Forward 4x128 -> 4x1000
[LINEAR] Input: 100/100 non-zero, first 5: -0.072366 -1.171804 1.064969 0.548276 -0.997617 
[LINEAR] Weights: 100/100 non-zero, first 5: 0.116045 -0.083860 0.100374 -0.091247 0.045300 
[LINEAR] Bias: 10/10 non-zero, first 5: -0.001514 0.400822 0.252919 0.258601 -0.001232 
[LINEAR] Output: 100/100 non-zero, first 5: -0.521024 1.731763 0.749601 2.163032 -0.548701 
[DEBUG] Output projection - shape: 4x1000
[DEBUG] Output range: [-3.112, 2.893]
[DEBUG] Output sample values: -0.521 1.732 0.750 2.163 -0.549 
[DEBUG] Forward completed!
ENG: <sos> i love you <eos>
ESP: <sos> frente miedo lengua <eos>
---